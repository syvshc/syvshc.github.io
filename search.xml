<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Win10+Ubuntu18.04LTS双系统安装记录</title>
    <url>/2020-12-12-Windows-and-Ubuntu/</url>
    <content><![CDATA[<p>本文记录过程的时候会同时记录踩过的坑, 这些坑有一些是由于我自己的操作不当, 还有一些是由于网上的教程版本过旧或书写错误造成的, 我都会记录下来, 但是文中的一些文本的描述会与系统标准输出的文本有一定差异, 只要不影响命令的运行的文字笔者不会过分追求一字不差. 那么我们开始吧<sup><a href="#fn_1" id="reffn_1">1</a></sup>.</p>
<blockquote id="fn_1">
<sup>1</sup>. 由于事先没有准备, 导致很多情况下都没有截图, 这里会尽量找图来保证记录的易读性.<a href="#reffn_1" title="Jump back to footnote [1] in the text."> &#8617;</a>
</blockquote>
<span id="more"></span>
<p><strong><em>本文部分内容过时, 请仔细甄别</em></strong></p>
<h2 id="双系统安装准备"><a href="#双系统安装准备" class="headerlink" title="双系统安装准备"></a>双系统安装准备</h2><ul>
<li>在<a href="https://cn.ubuntu.com/">Ubuntu官网</a>下载<code>Ubuntu18.04LTS</code>. 虽然<code>Ubuntu19.10</code>已经问世, 但是考虑到<code>LTS</code>版本的长期支持, 还是选择了这个版本<sup><a href="#fn_version" id="reffn_version">version</a></sup>;</li>
<li>关闭<code>Windows10</code>中电源设置中的<code>快速启动</code>;</li>
<li>下载<del>UltraISO</del> <a href="https://rufus.ie/zh/">rufus</a> 作为启动盘制作工具;</li>
<li><code>SanDisk USB3.0 32G</code> U盘一个作为启动盘<sup><a href="#fn_usb" id="reffn_usb">usb</a></sup>;</li>
<li>在<code>BIOS</code>中关闭<code>Secure Boot</code>.</li>
<li>在硬盘中<sup><a href="#fn_2" id="reffn_2">2</a></sup>压缩出至少<code>25G</code>的空间作为<code>Ubuntu</code>的系统盘, 我因为考虑到可能长期使用, 压缩了<code>100G</code>, 但是现在已经有不够用的趋势了……</li>
</ul>
<blockquote id="fn_usb">
<sup>usb</sup>. 要注意自己的机器是否支持从 <code>USB 3.0</code> 的 U 盘启动, 可以插入 U 盘后, 在启动选项界面查看是否有该 U 盘, 如果没有, 请选用 <code>USB 2.0</code> 的 U 盘.<a href="#reffn_usb" title="Jump back to footnote [usb] in the text."> &#8617;</a>
</blockquote>
<blockquote id="fn_version">
<sup>version</sup>. 现在已有更新的长期支持版本 <a href="https://ubuntu.com/download/desktop"><code>Ubuntu 20.04.3LTS</code></a> <a href="#reffn_version" title="Jump back to footnote [version] in the text."> &#8617;</a>
</blockquote>
<blockquote id="fn_2">
<sup>2</sup>. 尽量不要是<code>Windows</code>的系统盘, 并没有试过如果是系统盘会发生什么<a href="#reffn_2" title="Jump back to footnote [2] in the text."> &#8617;</a>
</blockquote>
<p>在我尝试压缩我的机械硬盘的时候<code>Windows</code>提示我</p>
<p><img src="https://pic4.zhimg.com/80/v2-df63444c0adf72d52ae7240ae7bc97f1.png" alt="压缩提示"></p>
<p>而我的机械硬盘上还有<code>300G</code>的空余空间, 我没多想, 只是认为是磁盘里碎片太多, 导致无法找出<code>100G</code>连续的空间进行压缩, 于是我运行了磁盘优化, 但是优化完还是报错, 这时我感觉问题不像我想的那样, 问了<a href="google.com.hk"><code>google</code></a>才知道我的磁盘已经在我不知道是什么的时候变成了<strong>动态磁盘</strong><sup><a href="#fn_3" id="reffn_3">3</a></sup>!<br><sup><a href="#fn_3" id="reffn_3">3</a></sup>:在<code>Windows</code>自带的磁盘管理中动态磁盘为黄色, 基本磁盘为深蓝色.</p>
<p>而这块动态磁盘还被分成了4个区, 尽管我的机械硬盘在<code>Win</code>中显示为一块磁盘. 这下知道问题所在就该着手解决了, 查了<a href="google.com.hk">google</a>知道可以用<code>分区助手</code>或<code>DiskGenius</code>来实现动态磁盘逆转回基本磁盘, 在用移动硬盘备份好机械硬盘里所有的文件后开始运行软件, 应该是我的磁盘型号的问题, 这两个软件都<strong>无法处理</strong>, 只能将其格式化, 转换为基本磁盘后再压缩出<code>100G</code>.</p>
<h2 id="开始操作"><a href="#开始操作" class="headerlink" title="开始操作"></a>开始操作</h2><h3 id="安装Ubuntu18-04"><a href="#安装Ubuntu18-04" class="headerlink" title="安装Ubuntu18.04"></a>安装<code>Ubuntu18.04</code></h3><ul>
<li>用<code>UltraISO</code>将<code>ubuntu1804</code>刻录进U盘;</li>
<li>重启电脑, 进入<code>BIOS</code>, 选择<code>USB</code>启动;</li>
<li>进入<code>Ubuntu</code>的<code>grub</code>界面后会选择<code>试用(try ubuntu without installing)</code>还是<code>安装(install ubuntu)</code>, 都可以, 如果选择<code>Try ubuntu</code>会在桌面的左上角出现一个<code>install</code>, 双击即可. 选择<code>安装Ubuntu</code>. </li>
<li><p>选择语言为<code>汉语</code></p>
</li>
<li><p>选择<code>为图像或无线硬件, 以及MP3和其它媒体安装第三方软件</code></p>
<p>我取消了勾选, 而由于我的<code>安装Ubuntu时下载更新</code>默认勾选且无法选择就只能勾选</p>
</li>
</ul>
<p><img src="https://pic4.zhimg.com/80/v2-bf16d4403832c000d0d7f3dabebb6332.png" alt="准备安装"></p>
<p>但是在后续的使用中发现缺少了很多依赖, 并不知道是不是安装时这个选项造成的, 但是还是勾选上吧, 只是安装时间会长一些. </p>
<ul>
<li>选择安装类型</li>
</ul>
<p><img src="https://pic4.zhimg.com/80/v2-a98750890a22b38fd625febad744072b.png" alt="安装类型"></p>
<p>我看到的几乎所有的教程中都提到了要选择<code>其他选项</code>, 而正常来说应该在<code>其他选项</code>的下一个界面中出现<code>100G</code>的空闲空间才对, 但是我只有几个<code>1M</code>的空闲空间, 为此我还返回<code>Windows</code>重新格式化了机械硬盘, 重新压缩卷, 但是都没有用. 后来问了我的同学, 他表示直接选择第一个选项<code>安装Ubuntu, 与其他系统共存</code>就可以, 开机时可以自动使用<code>Ubuntu</code>的<code>grub2</code>引导系统, 选完了之后开始安装, 重启电脑. </p>
<p><strong>又出问题了.</strong> 我的系统重启后可以进入<code>Ubuntu</code>的<code>grub2</code>, 选择进入<code>Ubuntu</code>, 在开机图标界面停留了很长时间, 我就强制关机了, 开机再进入<code>Ubuntu</code>的时候同样是停在了开机图标界面, 当我打算再次强制关机甚至重装系统的时候, 电脑自己关机了, <strong>我不确定这和我第一次的强制关机是否有关系</strong>. 在我查了一些文档后发现可能和我的<code>nvidia</code>显卡有关, 即<code>Ubuntu</code>中没有<code>nvidia</code>显卡的驱动, 而独显又主动启动, 导致了开机时的<code>bug</code>, 这里我尝试了两种方法, 均可以进入系统</p>
<ul>
<li>在<code>grub2</code>界面将光标停在<code>Ubuntu</code>, 按<code>e</code>, 找到<code>quiet</code>, 在后面加上<code>nouveau.modeset=0</code>, 按<code>F10</code>保存, 进入系统. </li>
<li>在<code>grub2</code>界面选择第二个选项<code>Advance</code>, 然后选择<code>Resume boot</code>, 进入系统.</li>
</ul>
<p>进入系统后要开始下载<code>nvidia</code>的驱动， 打开终端， 输入</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ubuntu-drivers devices</span><br></pre></td></tr></table></figure>
<p>可以看到类似下面的输出</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">== /sys/devices/pci0000:00/0000:00:01.0/0000:01:00.0 ==</span><br><span class="line">modalias : pci:v000010DEd00001C8Dsv00001028sd000007E1bc03sc02i00</span><br><span class="line">vendor   : NVIDIA Corporation</span><br><span class="line">model    : GP107M [GeForce GTX 1050 Mobile]</span><br><span class="line">driver   : nvidia-driver-430 - distro non-free</span><br><span class="line">driver   : nvidia-driver-435 - distro non-free recommended</span><br><span class="line">driver   : nvidia-driver-390 - distro non-free</span><br><span class="line">driver   : xserver-xorg-video-nouveau - distro free <span class="built_in">builtin</span></span><br></pre></td></tr></table></figure>
<p>可以看到我的显卡型号是<code>GP107M [GeForce GTX 1050 Mobile]</code>, 推荐的驱动是<code>nvidia-driver-435 - distro non-free recommended</code>, 我使用的是默认安装</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo ubuntu-drivers autoinstall</span><br></pre></td></tr></table></figure>
<p>也可以使用<code>apt</code>安装, 比如<code>sudo apt install nvidia-340</code>可以安装<code>340</code>版本的驱动. 安装驱动后就可以重启电脑, 这时不会卡开机界面了<sup><a href="#fn_4" id="reffn_4">4</a></sup></p>
<h3 id="安装Ubuntu下的基本软件"><a href="#安装Ubuntu下的基本软件" class="headerlink" title="安装Ubuntu下的基本软件"></a>安装Ubuntu下的基本软件</h3><h4 id="安装文本编辑器vim"><a href="#安装文本编辑器vim" class="headerlink" title="安装文本编辑器vim"></a>安装文本编辑器<code>vim</code></h4><p>在终端输入</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get install vim </span><br></pre></td></tr></table></figure>
<p>即可安装, 可以在终端中输入</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vimtutor</span><br></pre></td></tr></table></figure>
<p>可以查看<code>vim</code>自带的简易教程, 但是如果终端是<code>UTF8</code>编码, 中文是<code>LANG</code>环境, 那么这个命令是看不到中文版的教程的, 可以在终端运行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">iconv -f gb2312 -t utf8 /usr/share/vim/vim80/tutor/tutor.zh.euc -o ~/vimtutor.txt</span><br></pre></td></tr></table></figure>
<p>其中的<code>vim80</code>为自己的<code>vim</code>版本, 如果不确定的话可以<code>cd \usr/share/vim &amp;&amp; ls</code> 看一下, 会将<code>vimtutor.txt</code>的中文版输出到<code>~</code>目录下. </p>
<h4 id="安装TexLive"><a href="#安装TexLive" class="headerlink" title="安装TexLive"></a>安装<code>TexLive</code></h4><p>关于安装教程可以在啸行的<a href="https://github.com/OsbertWang/install-latex">install-LaTeX项目</a>处下载， 有很详细的教程， 这里我就说几个要注意的点.</p>
<ul>
<li><strong>先卸载<code>Ubuntu</code>预装的<code>TeXLive</code></strong>，本来我以为<code>Ubuntu</code>是不自带<code>TeXLive</code>的<sup><a href="#fn_texlive" id="reffn_texlive">texlive</a></sup>, 就直接装了<code>TL2019</code>, 但是当我想要用</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tlmgr update --self --all</span><br></pre></td></tr></table></figure>
<blockquote id="fn_texlive">
<sup>texlive</sup>. 新版的 <code>Ubuntu</code> 可能不自带 TeX Live, 安装之前可以 <code>tex -v</code> 检查一下. <a href="#reffn_texlive" title="Jump back to footnote [texlive] in the text."> &#8617;</a>
</blockquote>
<p>升级宏包时, 提示我<code>TeXLive</code>的版本不匹配</p>
<p><img src="https://pic4.zhimg.com/80/v2-94ddf1ee3e06abb707dfe0e226a44dad.png" alt="升级宏包错误"></p>
<p>而且当我使用<code>tex -v</code>查看版本的时候, 发现输出的是<code>TeXLive2017</code>, 然后可以按照<code>install-latex</code>中提到的方法卸载, 虽然安装后再卸载也没出什么问题, 但是安装前还是卸一下好一点.</p>
<ul>
<li>中文索引引擎<code>zhmakeindex</code></li>
</ul>
<p>在<code>Windows</code>添加这个引擎并不难, 从<a href="https://ctan.org/pkg/zhmakeindex">CTAN</a>上下载, 或从leo-liu的<a href="https://github.com/leo-liu/zhmakeindex">zhmakeindex项目</a><code>clone</code>到本地, 但是后者需要自己用<code>go</code>编译, 具体教程可以参考<a href="https://www.ituring.com.cn/article/207412">图灵社区</a>, 有必要一提, 我在照教程实践的时候, 在<strong>安装zhmakeindex</strong>一步中并没有完成, 报了一个我看不懂的错</p>
<p><img src="https://pic4.zhimg.com/80/v2-6241ad17c3d2436d93bb804d7021ed93.png" alt="go报错"></p>
<p>由于我不会<code>GOLANG</code>, 也就没有去查相关原因, 知道的大佬可以在评论区补充.</p>
<p>在<code>Windows</code>下直接将编译好的<code>zhmakeindex.exe</code>复制到<code>C:\texlive\2019\bin\win32</code>即可, 在命令行中进入写有索引的文件夹中, 执行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">zhmakeindex filename</span><br></pre></td></tr></table></figure>
<p>即可生成索引文件 <code>filename.ind</code>.</p>
<p>而在<code>Ubuntu</code>下编译失败后我也尝试用这种方法将<code>zhmakeindex</code>直接复制进<code>/usr/local/texlive/2019/bin/x86_64-linux</code>, 然后执行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">zhmakeindex filename</span><br></pre></td></tr></table></figure>
<p>但是<code>Ubuntu</code>并不认识这个命令, 在群里交流了一下, </p>
<p>在下载的目录里执行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ls -hal</span><br></pre></td></tr></table></figure>
<p>会返回下面的结果</p>
<!-- ![查看 zhmakeindex 权限](https://pic4.zhimg.com/80/v2-6241ad17c3d2436d93bb804d7021ed93.png) -->
<blockquote>
<p>这里贴错图了, 原图也丢了, 意思就是 <code>zhmakeindex</code> 没有执行权限</p>
</blockquote>
<p>可以发现<code>zhmakeindex</code>没有执行权限<code>x</code>. 于是执行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">chmod +x zhmakeindex</span><br></pre></td></tr></table></figure>
<p>为<code>zhmakeindex</code>添加执行权限, 在该文件夹下的终端运行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">zhmakeindex</span><br></pre></td></tr></table></figure>
<p>如果得到以下的输出</p>
<p><img src="https://pic4.zhimg.com/80/v2-edd3a958503aff3401e4e42103cc6b4a.png" alt="zhmakeindex 输出"></p>
<p>即表示可以执行, 这时可以选择<code>sudo cp ./zhmakeindex /bin/</code>方便调用, 或者在<code>~/.bashrc</code>或<code>~/.zshrc</code>中添加别名后更新</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">alias</span> zhmakeindex=<span class="string">&quot;/usr/local/texlive/2019/bin/x86_64-linux/zhmakeindex&quot;</span></span><br></pre></td></tr></table></figure>
<p>其中<code>/usr/local/texlive/2019/bin/x86_64-linux/</code>为存有改过权限的<code>zhmakeindex</code>文件的目录</p>
<p>然后</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> ~/.zshrc</span><br></pre></td></tr></table></figure>
<p>即可. </p>
<h4 id="安装MATLAB"><a href="#安装MATLAB" class="headerlink" title="安装MATLAB"></a>安装<code>MATLAB</code></h4><p>装<code>MATLAB</code>没有什么好说的, 我的学校提供了教育版的<code>MATLAB</code>, 所以不涉及到破解, 一切按流程走就行, 注意最后填写可使用的用户时的用户名填对. </p>
<h4 id="安装VSCode及配置"><a href="#安装VSCode及配置" class="headerlink" title="安装VSCode及配置"></a>安装<code>VSCode</code>及配置</h4><p>该部分可以从博客 <a href="/2021-09-02-ArchLinux/" title="Arch Linux 与 Windows 10 的双系统安装与折腾">Arch Linux 与 Windows 10 的双系统安装与折腾</a> 中看到更详细的<strong>插件</strong>的说明</p>
<p> 可以从<a href="https://code.visualstudio.com/">官网</a>上下载<code>*.deb</code>文件安装, 或者从<code>Ubuntu软件</code>中安装, 我选择的是后者.</p>
<p>暂时我对<code>VSCode</code>的使用就是作为<code>LaTeX</code>的编辑器, 下载的插件有</p>
<ul>
<li><code>LaTeX Workshop</code></li>
<li><code>Markdown All in One</code></li>
<li><code>Chinese (Simplified) Language Pack for Visual Studio Code</code></li>
</ul>
<p><code>settings.json</code>的内容在<a href="https://paste.ubuntu.com/p/PhQJSbByZd/">这里</a></p>
<p>另外根据我的<code>packages</code>使用习惯增加了用户代码片段<code>latex.json</code>, 在<a href="https://paste.ubuntu.com/p/WS6CBxxY2G/">这里</a></p>
<h4 id="安装通讯工具wine-qq"><a href="#安装通讯工具wine-qq" class="headerlink" title="安装通讯工具wine+qq"></a>安装通讯工具<code>wine+qq</code></h4><p>由于腾讯最近发布的<code>QQ for Linux2.0</code>体验极差, 还是只能选择<code>wine+QQ!</code>的方式解决, 具体教程可以看<a href="https://www.lulinux.com/archives/1319">撸Linux</a>上的教程, 在我的电脑上没有问题, 可以完美的使用. </p>
<h4 id="输入法fcitx-rime以小鹤音形配置"><a href="#输入法fcitx-rime以小鹤音形配置" class="headerlink" title="输入法fcitx-rime以小鹤音形配置"></a>输入法<code>fcitx-rime</code>以小鹤音形配置</h4><p>该部分可以从博客 <a href="/2021-09-02-ArchLinux/" title="Arch Linux 与 Windows 10 的双系统安装与折腾">Arch Linux 与 Windows 10 的双系统安装与折腾</a> 中看到更简单的配置方法, 以下内容已经弃用. </p>
<p>这个东西在我用<code>linux</code>虚拟机的时候就把我折磨地痛不欲生, 网上现存的教程太少了, 只能参考其他教程顺藤摸瓜. </p>
<p>在安装小鹤音形之前, 我曾使用自带的<code>ibus</code>输入法中的双拼简单替代, 使用体验并不是太好, 出现的问题有<strong>输入法响应不及时</strong>, 以及在部分软件中<strong>无法被呼出</strong>, 比如<code>TeXStudio</code>, 放弃. 也使用过<code>Sougou</code>中的双拼, 出现的问题有<strong>候选区乱码</strong> , 并且尝试了解决办法后依然没有解决, 还有一点不符合我使用习惯: <strong>无法设置在中文输入方式下输入半角符号</strong> , 最终还是选择<code>rime</code>挂接码表, 但是还有一个问题就是最新几版的码表已经被隐藏了, 在<a href="http://flypy.ys168.com/">小鹤音形网盘</a>中的码表资源较旧, 但也不是不能用, 就凑合一下吧.</p>
<ol>
<li>首先下载<code>fcitx-rime</code></li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get install fcitx-rime</span><br></pre></td></tr></table></figure>
<ol>
<li>在<a href="http://flypy.ys168.com/">小鹤音形网盘</a>中下载<code>小鹤音形Rime平台for Linux.zip</code>,  解压后会发现有一个<code>bin</code>文件夹, 还有几个<code>*.yaml</code>文件. </li>
<li>按照我找到的几乎所有教程都说要把所有文件复制到<code>~/.config/fcitx/rime</code>下, 但是这么做的话在部署的时候报错, 看一下<code>log</code>文件, 里面有为数不多的我能看懂的</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">E1021 19:55:48.464576 31050 deployment_tasks.cc:242] source file &#x27;flypyplus.dict.yaml&#x27; does not exist.</span><br><span class="line">E1021 19:55:48.492090 31050 deployment_tasks.cc:242] source file &#x27;flypy.dict.yaml&#x27; does not exist.</span><br></pre></td></tr></table></figure>
<p>表示<code>rime</code>找不到上面两个文件, 而<code>rime</code>要用这两个文件来生成对应的<code>bin</code>文件来调用, 但是在鹤大提供的包里直接把编译结果<code>bin</code>文件给出来了, 那就是为什么<code>rime</code>找不到这两个文件的问题了. </p>
<ol>
<li>将<code>bin/</code>文件夹下的所有<code>*.bin</code>文件都拿出来, 放到<code>~/.config/fcitx/rime</code>下, 再进行部署就行了. </li>
<li>也可以在这个文件夹下的<code>flypy_user.txt</code>, <code>flypy_top.txt</code>, <code>flypy_sys.txt</code>来添加自己的编码, 这里就不赘述了. </li>
</ol>
<h4 id="小飞机"><a href="#小飞机" class="headerlink" title="小飞机"></a>小飞机</h4><p>由于某些原因, 这里只贴一个<a href="https://github.com/qingshuisiyuan/electron-ssr-backup">项目链接</a></p>
<h3 id="配置zsh"><a href="#配置zsh" class="headerlink" title="配置zsh"></a>配置<code>zsh</code></h3><p>因为最近刚学了<code>git</code>， 并且有项目在<a href="https://github.com/syvshc">Github</a>上, 而<code>Ubuntu</code>自带的<code>bash</code>并不显示<code>git</code>的分支等信息, 用起来并不是很顺手, 于是用<code>zsh</code>来美化一下. 安装及配置的教程可以看<a href="https://segmentfault.com/a/1190000015283092">这里</a>. </p>
<h2 id="尾声"><a href="#尾声" class="headerlink" title="尾声"></a>尾声</h2><p>至此我的<code>Ubuntu</code>的配置已经可以满足日常使用, 分配出来的<code>100G</code>空间还剩下<code>25G</code>, 看起来还是不太够用, 不过对于不在<code>Linux</code>下玩游戏来说使用也够了, 就这样吧. 如果有表述错误还请评论区指正</p>
]]></content>
      <categories>
        <category>配置记录</category>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>系统安装</tag>
        <tag>配置记录</tag>
        <tag>帮助文档</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/2020-12-12-hello-world/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
]]></content>
      <categories>
        <category>杂项</category>
      </categories>
      <tags>
        <tag>hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>latexmk 的学习</title>
    <url>/2021-03-04-learn-latexmk/</url>
    <content><![CDATA[<p>其实是把翻译给咕掉了, 先把实用的东西写了, 方便查阅, 剩下的嘛, 考完研再说吧, 也没准哪天心血来潮就写了</p>
<p>先把这个东西写了, 随用随查, 然后也说一下遇到的坑什么的(如果有的话)</p>
<span id="more"></span>
<h2 id="命令行中的-latexmk"><a href="#命令行中的-latexmk" class="headerlink" title="命令行中的 latexmk"></a>命令行中的 <code>latexmk</code></h2><p><code>latexmk</code> 的通用格式为<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">latexmk [options] [file]</span><br></pre></td></tr></table></figure></p>
<p>其中 <code>file</code> 可以直接写文件名, 如果直接写 <code>foo</code> 的话, <code>latexmk</code> 会按照 <code>foo.tex</code> 来处理. 有一些符号在文件名中是不能用的: <code>$</code>, <code>%</code>, <code>\</code>,`(这个东西不能放在代码块里……), <code>&amp;</code>这个符号不能作为文件名的开头, 还有一些控制字符也不可以, 不过我估计没人会闲的用控制字符来做 <code>.tex</code> 的文件名…</p>
<h3 id="几个常用的-option"><a href="#几个常用的-option" class="headerlink" title="几个常用的 option"></a>几个常用的 <code>option</code></h3><h4 id="auxdir-FOO-或者-aux-directory-FOO"><a href="#auxdir-FOO-或者-aux-directory-FOO" class="headerlink" title="-auxdir=FOO 或者 -aux-directory=FOO"></a><code>-auxdir=FOO</code> 或者 <code>-aux-directory=FOO</code></h4><p>设置存放辅助文件的文件夹, 但是这个命令只能在 <code>MiKTeX</code> 版本的 <code>latex</code>中使用, 我这里是 <code>TeX Live</code>, 没有办法做测试. </p>
<h4 id="bibtex"><a href="#bibtex" class="headerlink" title="-bibtex"></a><code>-bibtex</code></h4><p>当源文件需要用 <code>.bbl</code> 文件作为参考文献的时候, 运行 <code>bibtex</code> 或者 <code>biber</code> 来更新 <code>.bbl</code> 文件. 这个选项可以将 <code>latexmkrc</code> 中的 <code>$bibtex_use</code> 的值设置为 <code>2</code> 来实现.</p>
<h4 id="bibtex-1"><a href="#bibtex-1" class="headerlink" title="-bibtex-"></a><code>-bibtex-</code></h4><p>从不运行 <code>bibtex</code> 或者 <code>biber</code>. 同时将 <code>.bbl</code> 文件看做珍贵的 ( 原文为 precious ), 也就是在执行清理命令的时候不会删除 <code>.bbl</code> 文件. 如果我们接受到的文件中只有 <code>.bbl</code> 而没有 <code>.bib</code> 的时候会启用这个选项. 这个选项可以将<code>latexmkrc</code> 中的 <code>$bibtex_use</code> 的值设置为 <code>0</code> 来实现.</p>
<h4 id="bibtex-cond"><a href="#bibtex-cond" class="headerlink" title="bibtex-cond"></a><code>bibtex-cond</code></h4><p>如果源文件中存在 <code>.bib</code> 文件, 则运行 <code>bibtex</code> 或 <code>biber</code> 来重写 <code>.bbl</code> 文件, 如果没有 <code>.bib</code> 文件, 则不运行 <code>bibtex</code> 或 <code>biber</code>, 这个选项也会将 <code>.bbl</code> 文件看做珍贵的. 这个选项可以将<code>latexmkrc</code> 中的 <code>$bibtex_use</code> 的值设置为 <code>1</code> 来实现.</p>
<h4 id="command"><a href="#command" class="headerlink" title="-command"></a><code>-command</code></h4><p> 列出 <code>latexmk</code> 在处理文件时可以使用的命令, 然后退出. </p>
<h4 id="c"><a href="#c" class="headerlink" title="-c"></a><code>-c</code></h4><p>清理所有由 <code>latex</code> , <code>bibtex</code>, 以及 <code>biber</code> 生成的可再生的文件, 除了 <code>.dvi</code>, <code>postscript</code>, 和 <code>.pdf</code> 文件. 会删除的文件有 <code>.log</code>, <code>.aux</code>, <code>latexmk</code> 创建的数据文件, 还有 <code>@generated_exts</code> 中指定扩展名的文件, 同时还有 <code>$clean_ext</code> 指定的文件. </p>
<h4 id="C"><a href="#C" class="headerlink" title="-C"></a><code>-C</code></h4><p>清理 <code>-c</code> 选项中的所有文件, 以及 <code>.pdf</code>, <code>.dvi</code>, <code>postscript</code> 文件, 以及 <code>$clean_full_ext</code> 指定的文件. </p>
<h4 id="cd"><a href="#cd" class="headerlink" title="-cd"></a><code>-cd</code></h4><p>在进行处理之前切换到有源程序的文件夹, 并将所有的文件生成在这个文件夹里. 举例: 如果你的文件夹结构为 <code>parent/subfolder/main.tex</code>, 你在 <code>parent</code> 文件夹下, 命令行执行 </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">latexmk -cd -xelatex subfolder/main</span><br></pre></td></tr></table></figure>
<p>后, 会进入 <code>subfolder</code> 文件夹进行编译, 并将辅助文件和输出文件生成在 <code>subfolder</code> 文件夹下. 这里注意路径的分隔符要使用 <code>/</code> , 哪怕是 <code>Windows</code>.</p>
<h4 id="f"><a href="#f" class="headerlink" title="-f"></a><code>-f</code></h4><p>强制执行 <code>latexmk</code> 哪怕遇到了 <code>error</code>. 一般情况下, 当 <code>latexmk</code> 遇到了 <code>latex</code> 或者其他程序在<strong>接下来的运行中</strong>无法处理的问题的时候, 将不会给出处理结果.</p>
<p><strong>接下来的运行</strong>指的是 如果没有 <code>error</code> 出现, 运行其他程序或者重新运行<code>latex</code> 的时候会编译完成 ( 这段其实我没看懂, 原文是 “Further processing” means the running of other Programs or the rerunning of latex (etc) that would be done if no errors had occurred. ) 额外地, 如果你想让 <code>latex</code> 程序遇到 <code>error</code> 之后不出现给用户处理 <code>error</code> 的暂停 , 你需要使用一些可以传递给程序的选项, 比如 <code>-interaction=nonstopmode</code>. 举例: 当文档里有一个严重的错误, 比如没有定义的命令, 使用 <code>-f</code> 的话</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">latexmk -f -xelatex main</span><br></pre></td></tr></table></figure>
<p>在遇到错误的时候依旧会暂停来等待用户处理, 而使用 <code>-interaction=nonstopmode</code> 的话</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">latexmk -interction=nonstopmode -xelatex main</span><br></pre></td></tr></table></figure>
<p> <code>latexmk</code> 会一气呵成运行到最后, 哪怕没有文件输出. </p>
<h4 id="g"><a href="#g" class="headerlink" title="-g"></a><code>-g</code></h4><p>强制完整地运行一遍 <code>latexmk</code>, 哪怕在 <code>latexmk</code> 觉得源文件自从上次编译之后没有改动</p>
<h4 id="h-help"><a href="#h-help" class="headerlink" title="-h, -help"></a><code>-h</code>, <code>-help</code></h4><p>打印 <code>latexmk</code> 的帮助信息.</p>
<h4 id="jobname-STRING"><a href="#jobname-STRING" class="headerlink" title="-jobname=STRING"></a><code>-jobname=STRING</code></h4><p>把输出文件中的文件名设置为 <code>STRING</code>, 而不是源文件名, 这个 <code>STRING</code> 中不能带空格. 如果要使用占位符 <code>%A</code> 的话也可以, 比如</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">latexmk -xelatex -jobname=%A-xelatex main</span><br></pre></td></tr></table></figure>
<p>这样输出文件名就变成了 <code>main-xelatex.***</code>.</p>
<h4 id="outdir-FOO-或者-output-directory-FOO"><a href="#outdir-FOO-或者-output-directory-FOO" class="headerlink" title="-outdir=FOO 或者 -output-directory=FOO"></a><code>-outdir=FOO</code> 或者 <code>-output-directory=FOO</code></h4><p>设置存放所有输出文件的文件夹.</p>
<h4 id="pdf"><a href="#pdf" class="headerlink" title="-pdf"></a><code>-pdf</code></h4><p>当使用 <code>pdflatex</code> 的时候输出 <code>.pdf</code> 文件.</p>
<h4 id="pdflatex"><a href="#pdflatex" class="headerlink" title="-pdflatex"></a><code>-pdflatex</code></h4><p>使用 <code>pdflatex</code> 编译, 并且关闭 <code>.dvi</code> 和 <code>.ps</code> 文件的生成. </p>
<h4 id="pv"><a href="#pv" class="headerlink" title="-pv"></a><code>-pv</code></h4><p>运行预览程序, 因为编译中文文档用的 <code>xelatex</code> 不会生成 <code>.dvi</code> 和 <code>.ps</code> 文件, 所以也不存在预览哪个文件的问题, 直接就是运行 <code>.pdf</code> 文件的预览. </p>
<h4 id="r-lt-rcfile-gt"><a href="#r-lt-rcfile-gt" class="headerlink" title="-r &lt;rcfile&gt;"></a><code>-r &lt;rcfile&gt;</code></h4><p>按 <code>&lt;rcfile&gt;</code> 中的内容执行 <code>latexmk</code>. 但是要注意调用顺序, <code>latexmk</code> 总是会先调用标准初始的 <code>latexmkrc</code> 文件, 如果不存在初始的 <code>latexmkrc</code> 文件的情况下再去调用 <code>&lt;rcfile&gt;</code>. 但是如果 <code>&lt;rcfile&gt;</code> 中指定了一个初始的 <code>latexmkrc</code> 文件, 那么这个文件会在所有的标准初始的 <code>latexmkrc</code> 文件之前运行. </p>
<h4 id="v-version"><a href="#v-version" class="headerlink" title="-v, -version"></a><code>-v</code>, <code>-version</code></h4><p>打印 <code>latexmk</code> 的版本号.</p>
<h4 id="xelatex"><a href="#xelatex" class="headerlink" title="-xelatex"></a><code>-xelatex</code></h4><p>使用 <code>xelatex</code> 编译程序, 同时关闭 <code>.dvi</code> 和 <code>.ps</code> 的生成. </p>
<p>以上是我在<strong>阅读文档</strong>的过程中觉得我会用的到的选项, 如果有更多的话会再补充</p>
<h2 id="RC-文件中的-latexmk"><a href="#RC-文件中的-latexmk" class="headerlink" title="RC 文件中的 latexmk"></a><code>RC</code> 文件中的 <code>latexmk</code></h2><h3 id="如何在-RC-文件中设置变量"><a href="#如何在-RC-文件中设置变量" class="headerlink" title="如何在 RC 文件中设置变量"></a>如何在 <code>RC</code> 文件中设置变量</h3><p>变量的格式应如下</p>
<p>设置一个值为<strong>字符串</strong>的变量:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$bibtex=&#x27;bibtex %O %B&#x27;;</span><br></pre></td></tr></table></figure>
<p>设置一个值为<strong>数字</strong>的变量:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$preview_mode=1;</span><br></pre></td></tr></table></figure>
<p>设置一个值为<strong>数组</strong>的变量:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">@default_files=(&#x27;paper&#x27;, &#x27;paper1&#x27;);</span><br></pre></td></tr></table></figure>
<p>也可以用下面的语句来给数组变量添加值:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">push @default_files, &#x27;paper2&#x27;;</span><br></pre></td></tr></table></figure>
<p>可以注意到简单的<strong>标量</strong>变量的名字的开头都是 <code>$</code>, 而数组变量的名字的开头是 <code>@</code>, 每个语句都以分号 <code>;</code> 结尾. 字符串应该用<strong>单引号</strong>括起来, 不建议使用双引号. </p>
<h3 id="命令规定的格式"><a href="#命令规定的格式" class="headerlink" title="命令规定的格式"></a>命令规定的格式</h3><p>一些变量会设置 <code>latexmk</code> 用于工作的命令, 比如通过 <code>.tex</code> 文件生成 <code>.dvi</code> 文件, 或者去浏览一个 <code>.ps</code> 文件. </p>
<h4 id="占位符"><a href="#占位符" class="headerlink" title="占位符"></a>占位符</h4><p>如果你想让 <code>latexmk</code> 在通常是 <code>latex</code> 的位置使用 <code>elatex</code> 命令, 而且想让它使用 <code>--shell-escape</code> 选项, 要像下面这么写</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">latex=&#x27;elatex --shell-escape %O %S&#x27;;</span><br></pre></td></tr></table></figure>
<p>那两个前面带 <code>%</code> 的就是<strong>占位符</strong>, 在运行命令之前他们会被替换为适当的值. 因此 <code>%S</code> 会被替换为 <code>elatex</code> 应用的源文件名, <code>%O</code> 会被替换为任何 <code>latexmk</code> 将作用在这个命令上的选项, 比如如果你在调用 <code>latexmk</code> 的时候使用了 <code>-silent</code> 选项, <code>%O</code> 会被替换为 <code>-interaction=batchmode</code>. 下面列出可用的占位符</p>
<ul>
<li><code>%A</code>: 主 <code>.tex</code> 文件的文件名. 不同于 <code>%R</code>, <code>%A</code> 不会被设置别名(jobname) 而受影响;</li>
<li><code>%B</code>: 最近命令中的基础名 (base name). 比如一个 <code>document.ps</code> 文件从一个 <code>document.dvi</code> 转化得到, 那么这个文件名就是 <code>document</code> </li>
<li><code>%D</code>: 终点 (destination) 文件名. 比如一个 <code>.ps</code> 文件由一个 <code>.dvi</code> 文件转化得到, 那么终点文件名就是这个 <code>.ps</code> 文件名.</li>
<li><code>%O</code>: 例子中提到的选项.</li>
<li><code>%P</code>: 如果变量 <code>$pre_tex_code</code> 不空, 那么 <code>%P</code> 会被替换为 <code>$pre_tex_code</code> 中 <code>\input&#123;SOURCE&#125;</code> 后面的内容, 其中 <code>SOURCE</code> 是资源文件 (source file) 的名字. 这让 TeX 代码可以在资源文件被读入之前就传给 <code>*latex</code> 引擎. 如果 <code>$pre_tex_code</code> 为空, 那么 <code>%P</code> 和 <code>%S</code>等价. </li>
<li><code>%R</code>: 根文件名, 这是主 <code>.tex</code> 文件的基础名, 但是这个值可以被 <code>-jobname</code> 选项或者 <code>$jobname</code> 变量改变.</li>
<li><code>%S</code>: 源文件名. 比如当转化一个 <code>.dvi</code> 文件到 <code>.ps</code> 的时候, <code>.dvi</code> 的文件名就是源文件名.</li>
<li><code>%T</code>: The name of the primary <code>.tex</code> file. </li>
<li><code>%U</code>: 如果变量 <code>$pre_tex_code</code> 不空, 那么这个值就被传递给 <code>%U</code>, 如果为空, 那么它被替换为一个空字符 (null string).</li>
<li><code>%Y</code>: 辅助文件所在的文件夹名. 如果文件夹名不是以合法符号结束, 那么就会被添加一个文件夹分隔符 <code>/</code>. 注意: 如果设置了 <code>$out_dir</code> 却没设置 <code>$aux_dir</code>,  那么<code>latexmk</code> 就把 <code>$aux_dir</code> 设置为 <code>$out_dir</code>.</li>
<li><code>%Z</code>: 输出文件夹名. 如果 <code>$out_dir</code> 不空, 且没以合法符号结束, 那么就会被添加一个文件夹分隔符 <code>/</code>. </li>
</ul>
<p>(说实在的我暂时没分清这么多 name 到底是什么 name, 比如 basename, roof filename, primary tex file…)</p>
<p>如果有什么原因你要使用一个 <code>%</code> 字符, 还不是上面标出的情况, 那么用 <code>%%</code>. </p>
<p><strong>注意</strong>: 在文件名传递的过程中会被适当地添加引号, 所以不要自行添加引号, 即使文件名中有空格. ( 如果你的 TeX 文件名中有空格, 那么一些过老版本的 TeX 程序可能不会很好地处理它们. ) 如果 <code>latexmk</code> 的引号不能正确地工作, 你也可以将它关闭, 在变量 <code>$quote_filenames</code> 的设置中. </p>
<h2 id="20200406-更新"><a href="#20200406-更新" class="headerlink" title="20200406 更新"></a>20200406 更新</h2><p>昨天在使用 <code>latexmk -xelatex -pvc main</code> 的时候发现 <code>SumatraPDF</code> 不能主动更新 <code>PDF</code> 文件, 而使用 <code>latexmk -pdflatex -pvc main</code> 就可以更新, 甚至将 <code>rc</code> 文件中的 <code>$pdflatex</code> 设置为 </p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="built_in">$</span>pdflatex=&quot;xelatex -file-line-error -halt-on-error  -interaction=nonstopmode -synctex=1 <span class="comment">%O %S&quot;;</span></span><br></pre></td></tr></table></figure>
<p>都可以更新 <code>pdf</code> 文件. 原因是 <code>latexmk</code> 选项中的 <code>-xelatex</code> 的默认选项是 <code>xelatex %O %S</code> 下面直接引用 <code>texdoc latexmk</code> 中的原文</p>
<blockquote>
<p><strong>Note about <code>xelatex</code></strong>: <code>latexmk</code> uses <code>xelatex</code> to make an <code>.xdv</code> rather than <code>.pdf</code> file, with the <code>.pdf</code> file being created in a separate step. This is enforced by the use of the <code>-no-pdf</code> option. If <code>%O</code> is part of the command for invoking <code>xelatex</code>, then latexmk will insert the <code>-no-pdf</code> option automatically, otherwise you must provide the option yourself.</p>
</blockquote>
<p>而 <code>-no-pdf</code> 是 <code>xelatex</code> 特有的选项.</p>
<p>综上所述, 产生这个问题的原因是: <strong>在使用 <code>latexmk</code> 的 <code>-xelatex</code> 选项时, <code>latexmk</code> 会执行 <code>xelatex %O %S</code>, 而这个 <code>%O</code> 中带了 (<code>latexmk</code> 选项) 中的 <code>-no-pdf</code> 选项, 于是在没有配置 <code>rc</code> 文件的时候, <code>latexmk -xelatex main</code> = <code>xelatex -no-pdf -record main</code></strong>. </p>
<p>问题出现了就可以给出解决办法: </p>
<ol>
<li>将 <code>rc</code> 中的 <code>$xelatex</code> 选项的配置为不带 <code>%O</code> 的命令, 如 <code>$xelatex=&quot;xelatex %S&quot;</code> 即可, 但是这么做的后果是不能将临时添加在 <code>latexmk</code> 中的 <code>xelatex</code> 的选项传递给 <code>xelatex</code>, 比如像上面一样配置 <code>$xelatex</code>, 那么在使用 <code>latexmk -synctex=1 main</code> 的时候, 不会执行 <code>-synctex=1</code> 这个选项. </li>
<li>修改 <code>rc</code> 文件中的 <code>$pdflatex</code> 选项为 <code>$pdflatex=&quot;xelatex %O %S&quot;</code> 这样可以接受临时添加的选项, 后果是不能使用 <code>pdflatex</code> 编译.</li>
</ol>
]]></content>
      <categories>
        <category>帮助文档</category>
        <category>LaTeX</category>
      </categories>
      <tags>
        <tag>帮助文档</tag>
        <tag>LaTeX</tag>
        <tag>latexmk</tag>
      </tags>
  </entry>
  <entry>
    <title>tlmgr 的介绍</title>
    <url>/2021-03-04-tlmgr-intro/</url>
    <content><![CDATA[<!-- [点击跳转](#jump) <span id="jump">跳转到的地方</span> -->
<p>这篇文章是用来熟悉 TeX Live 自带的包管理器 <code>tlmgr(TeX Live Manager)</code> 的使用, 官方文档位于 <a href="http://tug.org/texlive/doc/tlmgr.html">TUG</a>, 这个文档会不定期更新我看的懂的并且觉得有用的部分. 这是一个翻译文档, <a href="https://github.com/syvshc/tlmgr-intro-zh-cn">关于 <code>tlmgr</code> 使用方法的简介</a> 已经完成, 欢迎提 <a href="https://github.com/syvshc/tlmgr-intro-zh-cn/issues">issue</a> 或者 <a href="https://github.com/syvshc/tlmgr-intro-zh-cn/pulls">PR</a> 来帮我改进这份文档. </p>
<span id="more"></span>
<p><strong>注意</strong>:</p>
<ol>
<li>文档中被中括号<code>[]</code>框起来的为可选参数, 如 <code>--gui [action]</code>, </li>
<li>被尖括号<code>&lt;&gt;</code>框起来的为必要参数, 如 <code>tlmgr info &lt;what&gt;</code>, </li>
<li>被 <code>|</code> 分割开的选项为 n 选 1, 如 <code>backup [option] &lt;pkg|-all&gt;</code>, </li>
<li>文档中的 “软件包” 有时不仅指被用在 <code>\usepackage&#123;&#125;</code> 中的软件包. </li>
<li>命令中带有 <code>...</code> 的选项或参数意味着它们可以被填入不只一个内容, 如 <code>install [option...] &lt;pkg...&gt;</code> 说明你可以使用 <code>tlmgr install --force --reinstall ctex, amsmath</code>. </li>
</ol>
<h2 id="概要"><a href="#概要" class="headerlink" title="概要"></a>概要</h2><p><code>tlmgr</code> 管理着 TeX Live 中的软件包以及配置. 最新的文档以及测试版本的信息位于 <a href="https://tug.org/texlive/tlmgr.html">https://tug.org/texlive/tlmgr.html</a> . </p>
<p>TeX Live 由一些最高级别的 schemes 组成, 每一种 scheme 都是由不同的 collections 与 packages 组成, 其中 collection 是 packages 的集合, 而 packages 是包含了一些文件的包. Schemes 里一般既有 collections 也有 packages, 但是每一个 package 都属于且只属于一个 collection. </p>
<p>使用 <code>tlmgr info collections</code> 可以列出 collections 的信息. </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">❯❯ tlmgr info collections</span><br><span class="line">i collection-basic: Essential programs and files</span><br><span class="line">i collection-bibtexextra: BibTeX additional styles</span><br><span class="line">i collection-binextra: TeX auxiliary programs</span><br><span class="line">i collection-context: ConTeXt and packages</span><br><span class="line">i collection-fontsextra: Additional fonts</span><br><span class="line">i collection-fontsrecommended: Recommended fonts</span><br><span class="line">i collection-fontutils: Graphics and font utilities</span><br><span class="line">i collection-formatsextra: Additional formats</span><br><span class="line">i collection-games: Games typesetting</span><br><span class="line">i collection-humanities: Humanities packages</span><br><span class="line">i collection-langarabic: Arabic</span><br><span class="line">i collection-langchinese: Chinese</span><br><span class="line">i collection-langcjk: Chinese/Japanese/Korean (base)</span><br><span class="line">i collection-langcyrillic: Cyrillic</span><br><span class="line">i collection-langczechslovak: Czech/Slovak</span><br><span class="line">i collection-langenglish: US and UK English</span><br><span class="line">i collection-langeuropean: Other European languages</span><br><span class="line">i collection-langfrench: French</span><br><span class="line">i collection-langgerman: German</span><br><span class="line">i collection-langgreek: Greek</span><br><span class="line">i collection-langitalian: Italian</span><br><span class="line">i collection-langjapanese: Japanese</span><br><span class="line">i collection-langkorean: Korean</span><br><span class="line">i collection-langother: Other languages</span><br><span class="line">i collection-langpolish: Polish</span><br><span class="line">i collection-langportuguese: Portuguese</span><br><span class="line">i collection-langspanish: Spanish</span><br><span class="line">i collection-latex: LaTeX fundamental packages</span><br><span class="line">i collection-latexextra: LaTeX additional packages</span><br><span class="line">i collection-latexrecommended: LaTeX recommended packages</span><br><span class="line">i collection-luatex: LuaTeX packages</span><br><span class="line">i collection-mathscience: Mathematics, natural sciences, computer science packages</span><br><span class="line">i collection-metapost: MetaPost and Metafont packages</span><br><span class="line">i collection-music: Music packages</span><br><span class="line">i collection-pictures: Graphics, pictures, diagrams</span><br><span class="line">i collection-plaingeneric: Plain (La)TeX packages</span><br><span class="line">i collection-pstricks: PSTricks</span><br><span class="line">i collection-publishers: Publisher styles, theses, etc.</span><br><span class="line">i collection-texworks: TeXworks editor; TL includes only the Windows binary</span><br><span class="line">i collection-wintools: Windows-only support programs</span><br><span class="line">i collection-xetex: XeTeX and packages</span><br></pre></td></tr></table></figure>
<p>用 <code>tlmgr info schemes</code> 可以列出 schemes 的信息</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">❯❯ tlmgr info schemes</span><br><span class="line">i scheme-basic: basic scheme (plain and latex)</span><br><span class="line">i scheme-context: ConTeXt scheme</span><br><span class="line">i scheme-full: full scheme (everything)</span><br><span class="line">i scheme-gust: GUST TeX Live scheme</span><br><span class="line">i scheme-infraonly: infrastructure-only scheme (no TeX at all)</span><br><span class="line">i scheme-medium: medium scheme (small + more packages and languages)</span><br><span class="line">i scheme-minimal: minimal scheme (plain only)</span><br><span class="line">i scheme-small: small scheme (basic + xetex, metapost, a few languages)</span><br><span class="line">i scheme-tetex: teTeX scheme (more than medium, but nowhere near full)</span><br></pre></td></tr></table></figure>
<p>可以在 <a href="https://tug.org/texlive/doc">TeX Live 文档</a> 查看 TeX Live 的全部可用文档. </p>
<h2 id="基本格式"><a href="#基本格式" class="headerlink" title="基本格式"></a>基本格式</h2><p><code>tlmgr</code> 使用的基本格式为:<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tlmgr [option...] &lt;action&gt; [option...] [operand...]</span><br></pre></td></tr></table></figure></p>
<h2 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h2><p>成功安装 TeX Live 后, 可以设置一些 <code>tlmgr</code> 上的常用配置:</p>
<h3 id="tlmgr-option-repository-ctan"><a href="#tlmgr-option-repository-ctan" class="headerlink" title="tlmgr option repository ctan"></a><code>tlmgr option repository ctan</code></h3><p>告诉 <code>tlmgr</code> 它可以从一个附近的 CTAN 镜像去获取最近的更新, 这条命令还可以写成<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tlmgr option repository http://mirror.ctan.org/systems/texlive/tlnet</span><br></pre></td></tr></table></figure><br>其中 <code>ctan</code> 是 <code>http://mirror.ctan.org/systems/texlive/tlnet</code> 的别名. </p>
<p><strong>注意</strong> mirror.ctan.org 会被解析为多个不同的域名, 它们并不是完全同步的, 我们建议 (它们) 最多每天更新一次<sup><a href="#fn_update" id="reffn_update">update</a></sup>. 如果出现了问题, 我们建议您选择一个特定的镜像站. 全部的镜像站以及它们的状态会列在 <a href="https://ctan.org/mirrors/mirmon">镜像站列表</a>. </p>
<h4 id="大陆地区镜像"><a href="#大陆地区镜像" class="headerlink" title="大陆地区镜像"></a>大陆地区镜像</h4><p>大陆用户可以将源指定为国内的镜像站, 在 CTAN 上可以找到 <a href="https://ctan.org/mirrors#Asia">亚洲镜像列表</a> . 下面列举出截止至 2021-03-04 可用的镜像站<sup><a href="#fn_mainland" id="reffn_mainland">mainland</a></sup>: </p>
<div class="table-container">
<table>
<thead>
<tr>
<th>镜像名</th>
<th>镜像地址</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://developer.aliyun.com/mirror/">阿里云</a></td>
<td><a href="https://mirrors.aliyun.com/CTAN/systems/texlive/">https://mirrors.aliyun.com/CTAN/systems/texlive/</a></td>
</tr>
<tr>
<td><a href="https://mirror.bjtu.edu.cn/">北京交通大学</a></td>
<td><a href="https://mirror.bjtu.edu.cn/ctan/systems/texlive/">https://mirror.bjtu.edu.cn/ctan/systems/texlive/</a></td>
</tr>
<tr>
<td><a href="https://mirrors.bit.edu.cn/web/">北京理工大学</a></td>
<td><a href="https://mirrors.bit.edu.cn/CTAN/systems/texlive/">https://mirrors.bit.edu.cn/CTAN/systems/texlive/</a></td>
</tr>
<tr>
<td><a href="https://mirrors.bfsu.edu.cn/">北京外国语大学</a></td>
<td><a href="https://mirrors.bfsu.edu.cn/CTAN/systems/texlive/">https://mirrors.bfsu.edu.cn/CTAN/systems/texlive/</a></td>
</tr>
<tr>
<td><a href="https://mirrors.cqu.edu.cn/">重庆大学</a></td>
<td><a href="https://mirrors.cqu.edu.cn/CTAN/systems/texlive/">https://mirrors.cqu.edu.cn/CTAN/systems/texlive/</a></td>
</tr>
<tr>
<td><a href="https://mirrors.dgut.edu.cn/">东莞理工学院</a></td>
<td><a href="https://mirrors.dgut.edu.cn/CTAN/systems/texlive/">https://mirrors.dgut.edu.cn/CTAN/systems/texlive/</a></td>
</tr>
<tr>
<td><a href="https://mirrors.hit.edu.cn/">哈尔滨工业大学</a></td>
<td><a href="https://mirrors.hit.edu.cn/CTAN/systems/texlive/">https://mirrors.hit.edu.cn/CTAN/systems/texlive/</a></td>
</tr>
<tr>
<td><a href="https://mirrors.huaweicloud.com/">华为云</a></td>
<td><a href="https://mirrors.huaweicloud.com/CTAN/systems/texlive/">https://mirrors.huaweicloud.com/CTAN/systems/texlive/</a></td>
</tr>
<tr>
<td><a href="http://mirrors.hust.edu.cn/">华中科技大学</a></td>
<td><a href="http://mirrors.hust.edu.cn/CTAN/systems/texlive/">http://mirrors.hust.edu.cn/CTAN/systems/texlive/</a></td>
</tr>
<tr>
<td><a href="https://mirror.lzu.edu.cn/">兰州大学</a></td>
<td><a href="https://mirror.lzu.edu.cn/CTAN/systems/texlive/">https://mirror.lzu.edu.cn/CTAN/systems/texlive/</a></td>
</tr>
<tr>
<td><a href="https://mirrors.nju.edu.cn/">南京大学</a></td>
<td><a href="https://mirrors.nju.edu.cn/CTAN/systems/texlive/">https://mirrors.nju.edu.cn/CTAN/systems/texlive/</a></td>
</tr>
<tr>
<td><a href="https://mirrors.tuna.tsinghua.edu.cn/">清华大学</a></td>
<td><a href="https://mirrors.tuna.tsinghua.edu.cn/CTAN/systems/texlive/">https://mirrors.tuna.tsinghua.edu.cn/CTAN/systems/texlive/</a></td>
</tr>
<tr>
<td><a href="https://mirrors.sjtug.sjtu.edu.cn/">上海交通大学</a></td>
<td><a href="https://mirrors.sjtug.sjtu.edu.cn/ctan/systems/texlive/">https://mirrors.sjtug.sjtu.edu.cn/ctan/systems/texlive/</a></td>
</tr>
<tr>
<td><a href="https://mirrors.geekpie.club/">上海科技大学</a></td>
<td><a href="https://mirrors.geekpie.club/CTAN/systems/texlive/">https://mirrors.geekpie.club/CTAN/systems/texlive/</a></td>
</tr>
<tr>
<td><a href="https://mirrors.cloud.tencent.com/">腾讯云</a></td>
<td><a href="https://mirrors.cloud.tencent.com/CTAN/systems/texlive/">https://mirrors.cloud.tencent.com/CTAN/systems/texlive/</a></td>
</tr>
<tr>
<td><a href="https://mirrors.ustc.edu.cn/">中国科学技术大学</a></td>
<td><a href="https://mirrors.ustc.edu.cn/CTAN/systems/texlive/">https://mirrors.ustc.edu.cn/CTAN/systems/texlive/</a></td>
</tr>
</tbody>
</table>
</div>
<p>并用 <code>tlmgr option repository &lt;site&gt;/tlnet</code> 的方式进行设置. </p>
<h3 id="tlmgr-update-list"><a href="#tlmgr-update-list" class="headerlink" title="tlmgr update --list"></a><code>tlmgr update --list</code></h3><p>仅列出所有可以被升级的内容. </p>
<h3 id="tlmgr-update-all"><a href="#tlmgr-update-all" class="headerlink" title="tlmgr update --all"></a><code>tlmgr update --all</code></h3><p>将您本地的 TeX 安装内容与包管理库中的内容同步. </p>
<h3 id="tlmgr-info-lt-what-gt"><a href="#tlmgr-info-lt-what-gt" class="headerlink" title="tlmgr info &lt;what&gt;"></a><code>tlmgr info &lt;what&gt;</code></h3><p>列出 <code>&lt;what&gt;</code> 的详细信息, 比如它的安装状态以及介绍. 例如, 使用<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tlmgr info ctex</span><br></pre></td></tr></table></figure><br>可以查看 <code>ctex</code> 宏集的详细信息:<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">package:     ctex</span><br><span class="line">category:    Package</span><br><span class="line">shortdesc:   LaTeX classes and packages <span class="keyword">for</span> Chinese typesetting</span><br><span class="line">longdesc:    ctex is a collection of macro packages and document classes <span class="keyword">for</span> LaTeX Chinese typesetting.</span><br><span class="line">installed:   Yes</span><br><span class="line">revision:    56705</span><br><span class="line">sizes:       src: 473k, doc: 1101k, run: 1749k</span><br><span class="line">relocatable: No</span><br><span class="line">cat-version: 2.5.5</span><br><span class="line">cat-license: lppl1.3c</span><br><span class="line">cat-topics:  chinese book-pub class</span><br><span class="line">cat-contact-bugs: https://github.com/CTeX-org/ctex-kit/issues</span><br><span class="line">cat-contact-home: http://www.ctex.org/HomePage</span><br><span class="line">cat-contact-repository: https://github.com/CTeX-org/ctex-kit</span><br><span class="line">collection:  collection-langchinese</span><br></pre></td></tr></table></figure><br>对于 <code>tlmgr</code> 的更详细的用法, 请继续阅读. </p>
<h2 id="选项-OPTIONS"><a href="#选项-OPTIONS" class="headerlink" title="选项 (OPTIONS)"></a>选项 (OPTIONS)</h2><p>下列 <code>tlmgr</code> 的选项是<strong>全局</strong>选项, 不是特定于某一个命令的 (action specific). 对于所有的选项, 无论是全局的还是命令特定的, 都可以在<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tlmgr [option...] action [option...] [operand...]</span><br></pre></td></tr></table></figure><br>的任意位置, 按任意顺序使用. 命令中第一个不是选项的变量将会成为这个命令的主要操作 (main action). 在所有的情况中 <code>-option</code> 与 <code>--option</code> 是等价的, <code>=</code> 可以放在一个选项名和它的值之间, 按 <code>key=value</code> 的格式使用. </p>
<h3 id="repository-lt-url-path-gt"><a href="#repository-lt-url-path-gt" class="headerlink" title="--repository &lt;url|path&gt;"></a><code>--repository &lt;url|path&gt;</code></h3><p>指定一个软件包的仓库, 可以是本地文件夹 <code>&lt;path&gt;</code> 或者网络位置 <code>&lt;url&gt;</code>. 这个设置会临时覆盖掉 TeX Live Package Database (TLPDB, 由文件 <code>tlpkg/texlive.tlpdb</code> 给出) 中默认的软件包仓库. </p>
<p><strong>注意</strong> <code>--repository &lt;url|path&gt;</code> 命令只会修改当前运行的仓库选择, 如果想长期修改仓库, 可以使用 <code>option repository</code> (见 <a href="#action-option"><code>option</code></a>操作)</p>
<p>比如, 你可以这样选择一个特定的 CTAN 镜像</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">-repository http://ctan.example.org/its/ctan/dir/systems/texlive/tlnet</span><br></pre></td></tr></table></figure>
<p>当然，我们必须指定一个真正的主机名及其特定的最高级的 CTAN 目录. 全部可用的 CTAN 镜像可以在 <a href="https://ctan.org/mirrors/mirmon">镜像站列表</a> 处查看. </p>
<p>下面是一个使用本地目录的例子:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">-repository /<span class="built_in">local</span>/TL/repository</span><br></pre></td></tr></table></figure>
<p>也可以使用 <code>--repo</code> 作为 <code>--repository</code> 的简化. </p>
<p>剩下是一些特定的网络下的设置, 略过. </p>
<h3 id="gui-action"><a href="#gui-action" class="headerlink" title="--gui [action]"></a><code>--gui [action]</code></h3><p><code>tlmgr</code> 有两个 GUI 前端, <code>tlshell</code> 和 <code>tlcockpit</code>, 它们是由不同的程序启动的, 详情可以查看它们的文档. </p>
<p>与命令行界面一样, <code>tlmgr</code> 自己有一个图形界面. 我们可以用一个选项 <code>-gui</code> 来调用它. 如果后面还跟着一个操作 (action), 那么会直接在图形界面执行这个操作, 比如</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tlmgr --gui update</span><br></pre></td></tr></table></figure>
<p>会直接启动升级图形界面. 如果 <code>-gui</code> 后面没有跟着操作, 那么就直接打开 GUI 的主界面. 由于我不使用 GUI 界面, 这里就不对这一部分进行介绍, 详情可以参考 <a href="https://www.tug.org/texlive/doc/tlmgr.html#GUI-FOR-TLMGR">GUI FOR TLMGR</a></p>
<h3 id="gui-lang-lt-llcode-gt"><a href="#gui-lang-lt-llcode-gt" class="headerlink" title="--gui-lang &lt;llcode&gt;"></a><code>--gui-lang &lt;llcode&gt;</code></h3><p>通常情况来说, GUI 会从计算机中获取你使用的语言. 如果它没成功, 或者你想指定一个语言的 GUI 界面, 可以设置:</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>语言</th>
<th>语言代码</th>
</tr>
</thead>
<tbody>
<tr>
<td>英语</td>
<td><code>en</code>, 默认</td>
</tr>
<tr>
<td>捷克语</td>
<td><code>cs</code></td>
</tr>
<tr>
<td>德语</td>
<td><code>de</code></td>
</tr>
<tr>
<td>法语</td>
<td><code>fr</code></td>
</tr>
<tr>
<td>意大利语</td>
<td><code>it</code></td>
</tr>
<tr>
<td>日语</td>
<td><code>ja</code></td>
</tr>
<tr>
<td>荷兰语</td>
<td><code>nl</code></td>
</tr>
<tr>
<td>波兰语</td>
<td><code>pl</code></td>
</tr>
<tr>
<td>巴西葡萄牙语</td>
<td><code>pt_BR</code></td>
</tr>
<tr>
<td>俄语</td>
<td><code>ru</code></td>
</tr>
<tr>
<td>斯洛伐克语</td>
<td><code>sl</code></td>
</tr>
<tr>
<td>塞尔维亚语</td>
<td><code>sr</code></td>
</tr>
<tr>
<td>乌克兰语</td>
<td><code>uk</code></td>
</tr>
<tr>
<td>越南语</td>
<td><code>vi</code></td>
</tr>
<tr>
<td>简体中文</td>
<td><code>zh_CN</code></td>
</tr>
<tr>
<td>繁体中文</td>
<td><code>zh_TW</code></td>
</tr>
</tbody>
</table>
</div>
<h3 id="command-logfile-lt-file-gt"><a href="#command-logfile-lt-file-gt" class="headerlink" title="--command-logfile &lt;file&gt;"></a><code>--command-logfile &lt;file&gt;</code></h3><p>将 <code>tlmgr</code> 调用的所有程序 (<code>mktexlr</code>, <code>mtxrun</code>, <code>fmtutil</code>, <code>updmap</code>) 的输出写入一个文件 <code>&lt;file&gt;</code> 中, 默认位置为<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">TEXMFSYSVAR/web2c/tlmgr-commands.log</span><br></pre></td></tr></table></figure></p>
<h3 id="debug-translation"><a href="#debug-translation" class="headerlink" title="--debug-translation"></a><code>--debug-translation</code></h3><p>一个协助翻译的选项, 略过</p>
<h3 id="machine-readable"><a href="#machine-readable" class="headerlink" title="--machine-readable"></a><code>--machine-readable</code></h3><p>将标准输出写成一个更适合计算机解析的格式</p>
<h3 id="package-logfile-lt-file-gt"><a href="#package-logfile-lt-file-gt" class="headerlink" title="--package-logfile &lt;file&gt;"></a><code>--package-logfile &lt;file&gt;</code></h3><p><code>tlmgr</code> 将所有软件包操作 (<code>install</code>, <code>remove</code>, <code>update</code>, <code>failed updates</code>, <code>failed restores</code>) 写入一个单独的日志文件, 默认位置为<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">TEXMFSYSVAR/web2c/tlmgr.log</span><br></pre></td></tr></table></figure><br>这个选项让你可以为日志文件指定另一个路径.</p>
<h3 id="pause"><a href="#pause" class="headerlink" title="--pause"></a><code>--pause</code></h3><p>让 <code>tlmgr</code> 在退出之前等待用户输入, 在 Windows 上可以避免命令行的消失. </p>
<h3 id="usermode"><a href="#usermode" class="headerlink" title="--usermode"></a><code>--usermode</code></h3><p>在这次运行 <code>tlmgr</code> 时启用 user mode. 见 <a href="#user-mode"><code>USER MODE</code></a></p>
<h3 id="usertree-lt-dir-gt"><a href="#usertree-lt-dir-gt" class="headerlink" title="--usertree &lt;dir&gt;"></a><code>--usertree &lt;dir&gt;</code></h3><p>在 <code>&lt;dir&gt;</code> 中创建 user mode 的树. 见 <a href="#user-mode"><code>USER MODE</code></a></p>
<h3 id="verify-repo-lt-none-main-all-gt"><a href="#verify-repo-lt-none-main-all-gt" class="headerlink" title="--verify-repo=&lt;none|main|all&gt;"></a><code>--verify-repo=&lt;none|main|all&gt;</code></h3><p>没看懂</p>
<p>TeX Live 程序的标准选项也可以使用, 比如 <code>--help/-h/-?</code>, <code>--version</code>, <code>-q</code> (无提示信息), <code>-v</code> (显示调试信息)</p>
<h2 id="操作-ACTIONS"><a href="#操作-ACTIONS" class="headerlink" title="操作 (ACTIONS)"></a>操作 (ACTIONS)</h2><h3 id="help"><a href="#help" class="headerlink" title="help"></a><code>help</code></h3><p>显示一个帮助信息并退出, 与 <code>--help</code> 选项的作用相同, 实际就是打开一个与 <a href="https://www.tug.org/texlive/doc/tlmgr.html"><code>tlmgr</code>帮助文档</a> 相同的帮助信息. </p>
<h3 id="version"><a href="#version" class="headerlink" title="version"></a><code>version</code></h3><p>给出版本信息, 与 <code>--version</code> 选项相同, 如果也使用了 <code>-v</code> 选项, 那么所使用模块的版本信息也会被打印. </p>
<h3 id="backup"><a href="#backup" class="headerlink" title="backup"></a><code>backup</code></h3><h4 id="backup-option-lt-pkg-all-gt"><a href="#backup-option-lt-pkg-all-gt" class="headerlink" title="backup [option..] &lt;pkg...|-all&gt;"></a><code>backup [option..] &lt;pkg...|-all&gt;</code></h4><p>如果没有指定 <code>--clean</code> 选项, 那么这个操作会创建一个软件包 <code>&lt;pkg&gt;</code> 的备份, 如果使用了 <code>-all</code> 选项, 则创建一个全部软件包的备份.</p>
<p>备份文件的位置将由 <code>--backupdir &lt;dir&gt;</code> 指定, 前提是 <code>&lt;dir&gt;</code> 存在并且可写. 如果没有指定 <code>--backupdir</code>, 那么就使用 TLPDB 中设置的 <code>backupdir</code>, 如果二者皆空, 那么将不会创建备份. </p>
<p>安装程序将 <code>backupdir</code> 默认设置在了 TeX Live 根目录下的 <code>./tlpkg/backups</code> 中, 所以如果没有额外的设置, <code>backupdir</code> 总是存在. 查看 <a href="#action-option"><code>option</code></a> 以获得更多信息. </p>
<p>如果指定了 <code>--clean</code> 选项, 那么备份文件将被删除, 而不是被保存. 一个可选的整数值 <code>N</code> 可以指定在清理时保留的备份数. 如果没有指定 <code>N</code>, 那么将使用 <code>autobackup</code> 的值, <code>autobackup</code> 默认在 TLPDB 中为 <code>1</code>. 如果二者皆空, 那么将会报错. 查看 <a href="#action-option"><code>option</code></a> 来获得更多关于删除备份文件的详细信息. </p>
<p><code>backup</code> 操作的特定选项: </p>
<h4 id="backupdir-lt-dir-gt"><a href="#backupdir-lt-dir-gt" class="headerlink" title="--backupdir &lt;dir&gt;"></a><code>--backupdir &lt;dir&gt;</code></h4><p>临时覆盖 TLPDB 中 <code>backupdir</code> 的值. 参数 <code>&lt;dir&gt;</code> 必须要指定, 这是备份文件存放的路径, 它必须要存在且可写</p>
<h4 id="all"><a href="#all" class="headerlink" title="--all"></a><code>--all</code></h4><p>如果没有指定 <code>--clean</code> 选项, 那么创建一个 TeX Live 安装过的所有软件包的备份, 这会消耗大量的存储空间与时间. 如果指定 <code>--clean</code> 选项, 所有的备份将被删除. </p>
<h4 id="clean-N"><a href="#clean-N" class="headerlink" title="--clean[=N]"></a><code>--clean[=N]</code></h4><p>删除备份目录 <code>backupdir</code> 中的旧备份, 而不是创建备份. 可选参数整数值 <code>N</code> 会临时覆盖 TLPDB 中 <code>autobackup</code> 的值. 如果使用这个选项, 那么必须要指定 <code>--all</code> 或者一列软件包. </p>
<h4 id="dry-run"><a href="#dry-run" class="headerlink" title="--dry-run"></a><code>--dry-run</code></h4><p>备份或删除的操作将被打印在终端而不真正进行备份或者删除, 如 <code>tlmgr --dry-run backup ctex</code> 会打印出<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">❯❯ tlmgr --dry-run backup ctex</span><br><span class="line">would save current status of ctex to d:/texlive/2020/tlpkg/backups/ctex.r56705.tar.lz4</span><br><span class="line">no action taken due to --dry-run</span><br></pre></td></tr></table></figure></p>
<h3 id="candidate-lt-pkg-gt"><a href="#candidate-lt-pkg-gt" class="headerlink" title="candidate &lt;pkg&gt;"></a><code>candidate &lt;pkg&gt;</code></h3><p>显示软件包 <code>&lt;pkg&gt;</code> 的候选仓库 (candidate repository). 见 <a href="#multiple-repository">MULTIPLE REPOSITORY</a></p>
<h3 id="check-option-lt-depends-excutes-files-runfiles-texmfdbs-all-gt"><a href="#check-option-lt-depends-excutes-files-runfiles-texmfdbs-all-gt" class="headerlink" title="check [option...] &lt;depends|excutes|files|runfiles|texmfdbs|all&gt;"></a><code>check [option...] &lt;depends|excutes|files|runfiles|texmfdbs|all&gt;</code></h3><p>执行安装的一致性 (consistency of installation) 的一个或者全部检查, 如果没发现问题, 那么将不会有输出. (如果想看看 <code>tlmgr</code> 做了什么, 可以用 <code>tlmgr -v check</code>)</p>
<h4 id="depends"><a href="#depends" class="headerlink" title="depends"></a><code>depends</code></h4><p>列出那些没有被安装, 但是作为安装集合的软件包的依赖, 以及哪些没有包含在任何集合中的软件包. </p>
<p>如果使用 <code>tlmgr check collections</code>, 同样会执行 <code>tlmgr check depends</code>, 因为旧版本的 <code>tlmgr</code> 就是这么做的. </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">❯❯ tlmgr check collections</span><br><span class="line">tlmgr.pl: <span class="string">&quot;collections&quot;</span> check has been replaced by <span class="string">&quot;depends&quot;</span>.</span><br></pre></td></tr></table></figure>
<h4 id="excutes"><a href="#excutes" class="headerlink" title="excutes"></a><code>excutes</code></h4><p>检查 TeX Live 数据库中 <code>execute</code>指令引用的文件是否存在.<br>Check that the files referred to by execute directives in the TeX Live Database are present.</p>
<h4 id="files"><a href="#files" class="headerlink" title="files"></a><code>files</code></h4><p>检查列在 TLPDB (<code>texlive.tlpdb</code>) 是否真的存在, 列出不存在的软件包. </p>
<h4 id="runfiles"><a href="#runfiles" class="headerlink" title="runfiles"></a><code>runfiles</code></h4><p>列出在执行文件中出现多次的文件名, 除了已知的重复文件名. </p>
<h4 id="texmfdbs"><a href="#texmfdbs" class="headerlink" title="texmfdbs"></a><code>texmfdbs</code></h4><p>检查与 <code>ls-R</code> 相关的文件. 如果你已经定义了新的 <code>TEXMF</code> 树, 或者更改了 <code>TEXMF</code> 或 <code>TEXMFDBS</code> 变量, 那运行它也没什么坏处 (it can’t hurt to run this). 它检查了</p>
<ul>
<li>all items in <code>TEXMFDBS</code> have the <code>!!</code> prefix.</li>
<li>all items in <code>TEXMFBDS</code> have an <code>ls-R</code> file (if they exist at all).</li>
<li>all items in <code>TEXMF</code> with <code>!!</code> are listed in <code>TEXMFDBS</code>.</li>
<li>all items in <code>TEXMF</code> with an <code>ls-R</code> file are listed in <code>TEXMFDBS</code>.</li>
</ul>
<p>这些没看懂. </p>
<p><code>check</code> 操作的特定选项:</p>
<h4 id="use-svn"><a href="#use-svn" class="headerlink" title="--use-svn"></a><code>--use-svn</code></h4><p>在检查 TL 的发展仓库(? development repository) 时, 用 <code>svn status</code> 输出代替文件列表. (This is run nightly). </p>
<h3 id="conf-dump-tlpdb-generate-gui"><a href="#conf-dump-tlpdb-generate-gui" class="headerlink" title="conf, dump-tlpdb, generate, gui"></a><code>conf</code>, <code>dump-tlpdb</code>, <code>generate</code>, <code>gui</code></h3><p>略</p>
<h3 id="info"><a href="#info" class="headerlink" title="info"></a><code>info</code></h3><h4 id="info-option-pkg-collections-schemes"><a href="#info-option-pkg-collections-schemes" class="headerlink" title="info [option...] [pkg...|collections|schemes]"></a><code>info [option...] [pkg...|collections|schemes]</code></h4><p>如果没有参数, 列出仓库中全部的可用软件包, 把哪些已经安装的用 <code>i</code> 作为前缀. </p>
<p>如果用 <code>collections</code> 或者 <code>schemes</code>, 列出所需的类型, 而不输出软件包名 .</p>
<p>如果用任何其他的参数, 那么就把参数看成软件包名 <code>&lt;pkg...&gt;</code>, 并列出它的信息: 名称 (name), 分类 (category), 简短以及详细的介绍 (short and long description), 大小 (size), 安装状态 (installation status), 以及 TeX Live 中它的修订号 (TeX Live revision number). </p>
<p>如果 <code>&lt;pkg...&gt;</code> 在本地与线上都没有找到, 那么将会搜索与它相关的软件包和文件. </p>
<p>它也会显示从 TeX Catalogue 上获取的信息, 比如软件包版本 (package version), 日期 (date), 和许可证 (license). 考虑这些，特别是软件包版本，获得的信息仅仅是近似的，这是由于不同部分更新的时间偏差造成的. </p>
<p>旧操作 <code>show</code> 与 <code>list</code> 已经被合并到这个操作中, 但是为了后续的兼容性这两个操作依然可用. </p>
<p><code>info</code> 操作的特定选项:</p>
<h4 id="list"><a href="#list" class="headerlink" title="--list"></a><code>--list</code></h4><p>如果指定了 <code>--list</code> 选项, 并且跟了一个软件包 <code>&lt;pkg...&gt;</code>, 那么这个软件包的包含文件也会被展示, 比如执行文件, 源文件, 软件包文档等等, 包括平台特定的依赖包 (platform-specific dependencies)</p>
<p>如果跟的是 <code>schemes</code> 或 <code>collections</code>, 那么输出的内容与不加 <code>--list</code> 相同. </p>
<h4 id="only-installed"><a href="#only-installed" class="headerlink" title="--only-installed"></a><code>--only-installed</code></h4><p>如果指定这个选项, 那么 <code>tlmgr</code> 只会从本地安装的软件包, collections, 或者 schemes 中寻找信息, 而不使用安装的源. </p>
<h4 id="only-remote"><a href="#only-remote" class="headerlink" title="--only-remote"></a><code>--only-remote</code></h4><p>只列出在远端仓库的软件包. 这个选项比较适合配合 <code>tlmgr --repo ...</code> 使用, 来查看某个软件包在某远端仓库是否可用, 用 <code>tlmgr --repo ... --only-remote info &lt;pkg...&gt;</code> 即可. <strong>注意</strong> <code>--only-installed</code> 和 <code>--only-remote</code> 不能同时指定. </p>
<h4 id="data-lt-item1-item2-gt"><a href="#data-lt-item1-item2-gt" class="headerlink" title="--data &lt;item1, item2,...&gt;"></a><code>--data &lt;item1, item2,...&gt;</code></h4><p>如果制定了 <code>--data</code> 选项, 那它的参数只能从以下内容中选择: <code>name</code>, <code>category</code>, <code>localrev</code>, <code>remoterev</code>, <code>shortdesc</code>, <code>longdesc</code>, <code>installed</code>, <code>size</code>, <code>relocatable</code>, <code>depends</code>, <code>cat-version</code>, <code>cat-date</code>, <code>cat-license</code>, 以及字段 <code>cat-contact-*</code> (见下), 这些内容中间要用逗号<code>,</code>隔开. </p>
<p><code>cat-*</code> 字段全部从 <a href="https://ctan.org/pkg/catalogue">TeX Catalogue</a> 中获得. 对于每个字段都有两个变种, 带 <code>l</code> 前缀和带 <code>r</code> 前缀, 比如: <code>lcat-version</code> 与 <code>rcat-version</code>, 分别代表了本地和远端的信息. 如果不带 <code>l</code> 和 <code>r</code> 的选项, 那么就显示最近的一个, 通常来说是远端的信息. </p>
<p>按照这个写法, 那么 <code>cat-contact-*</code> 字段包括了 <code>home</code>, <code>repository</code>, <code>support</code>, <code>bugs</code>, <code>announce</code>, <code>development</code>, 每一个都可能为空, 或者含有一个 url 值, 比如可以用<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tlmgr info --data cat-contact-home amsmath</span><br></pre></td></tr></table></figure><br>查看 <code>amsmath</code> 软件包的主页, 可以得到<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">❯❯ tlmgr info --data cat-contact-home amsmath</span><br><span class="line">http://www.ams.org/tex/amslatex.html</span><br></pre></td></tr></table></figure><br>关于新软件包的简短的介绍可以在 <a href="https://ctan.org/upload">CTAN upload page</a>  上查看. </p>
<h4 id="json"><a href="#json" class="headerlink" title="--json"></a><code>--json</code></h4><p>如果指定 <code>--json</code> 选项, 那么将会给出一个 JSON 格式的输出, 可以在 <code>tlpkg/doc/JSON-formats.txt</code> 查看格式信息, 格式定义在 <code>TLPOBJINFO1</code>. 如果 <code>--json</code> 和 <code>--data</code> 同时被指定, 那么 <code>--json</code> 的优先级会更高.</p>
<h3 id="init-usertree"><a href="#init-usertree" class="headerlink" title="init-usertree"></a><code>init-usertree</code></h3><p>为所谓的 <code>user mode magagement</code> 建立一个 <code>texmf</code> 树, 无论是在默认的用户树 <code>TEXMFHOME</code> 下, 还是一个被 <code>--usertree</code> 指定的树下. 见 <a href="#user-mode"><code>USER MODE</code></a>. </p>
<h3 id="install-option-lt-pkg-gt"><a href="#install-option-lt-pkg-gt" class="headerlink" title="install [option...] &lt;pkg...&gt;"></a><code>install [option...] &lt;pkg...&gt;</code></h3><p>安装每一个 <code>&lt;pkg...&gt;</code> 中提到的软件包, 如果它们没有被安装的话, 这个操作不会去动失敬存在的软件包, 如果想获得软件包的最新版本, 见 <code>update</code> 操作. </p>
<p>这个操作默认也会安装给定的 <code>&lt;pkg...&gt;</code> 的依赖文件.<br>By default this also installs all packages on which the given <em>pkgs</em> are dependent. </p>
<p>下面是 <code>install</code> 操作特有的选项:</p>
<h4 id="dry-run-1"><a href="#dry-run-1" class="headerlink" title="--dry-run"></a><code>--dry-run</code></h4><p>安装会发生的事情会被打印出来, 而不真进的行安装</p>
<h4 id="file"><a href="#file" class="headerlink" title="--file"></a><code>--file</code></h4><p>从给定的软件包文件中安装软件包, 而不从安装仓库进行安装. 这些文件必须是标准的 TeX Live 软件包文件 (含有 <code>tlpobj</code> 文件)<sup><a href="#fn_installfile" id="reffn_installfile">installfile</a></sup></p>
<h4 id="force"><a href="#force" class="headerlink" title="--force"></a><code>--force</code></h4><p>如果 <code>tlmgr</code> 本身或其他基本的部分正在升级, 那么 <code>tlmgr</code> 将会退出这次安装, 并且不会安装任何软件包. 如果给定了 <code>--force</code> 选项, 那么这次的安装依然会继续进行. <strong>不推荐使用</strong></p>
<h4 id="no-dependens"><a href="#no-dependens" class="headerlink" title="--no-dependens"></a><code>--no-dependens</code></h4><p>不安装软件包的依赖. (默认设置下, 安装一个软件包要满足它的所有依赖)</p>
<h4 id="no-dependens-at-all"><a href="#no-dependens-at-all" class="headerlink" title="--no-dependens-at-all"></a><code>--no-dependens-at-all</code></h4><p>略. </p>
<h4 id="reinstall"><a href="#reinstall" class="headerlink" title="--reinstall"></a><code>--reinstall</code></h4><p>重新安装一个软件包 (包括它的依赖), 尽管它们看起来已经被安装了. 这个选项对于恢复在层级中不小心删除的软件包很有用. </p>
<p>当重新安装时, only dependencies on normal packages are followed. (i.e., not those of category Scheme or Collection)</p>
<h4 id="with-doc-与-with-src"><a href="#with-doc-与-with-src" class="headerlink" title="--with-doc 与 --with-src"></a><code>--with-doc</code> 与 <code>--with-src</code></h4><p><code>install-tl</code> 给了一个 “不安装文档/源文件” 的选项, 但是我们不推荐使用这个选项. (默认状态下会安装所有的文件). 如果用了这个选项, 那么当你想获得软件包的文档或者源文件的时候, 可以使用这两个选项与 <code>--reinstall</code>, 比如用 <code>fontspec</code> 宏包为例: </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tlmgr install --reinstall --with-doc --with-src fontspec</span><br></pre></td></tr></table></figure>
<p>这个操作不会在系统目录中自动添加新的符号链接, 需要手动运行 <code>tlmgr path add &quot;path&quot;</code><br><span id="action-option"> <code>option</code> </span><br><span id="user-mode"> <code>USER MODE</code> </span><br><span id="multiple-repository"> <code>MULTIPLE REPOSITORY</code> </span></p>
<blockquote id="fn_update">
<sup>update</sup>. mirror.ctan.org resolves to many different hosts, and they are not perfectly synchronized; we recommend updating only daily (at most), and not more often. <a href="#reffn_update" title="Jump back to footnote [update] in the text."> &#8617;</a>
</blockquote>
<blockquote id="fn_mainland">
<sup>mainland</sup>. 这个表格来自 <a href="https://github.com/OsbertWang/install-latex-guide-zh-cn">install-latex-guide-zh-cn</a>. <a href="#reffn_mainland" title="Jump back to footnote [mainland] in the text."> &#8617;</a>
</blockquote>
<blockquote id="fn_installfile">
<sup>installfile</sup>. 这里我没有看懂, 也没找到合适的例子. <a href="#reffn_installfile" title="Jump back to footnote [installfile] in the text."> &#8617;</a>
</blockquote>
]]></content>
      <categories>
        <category>帮助文档</category>
        <category>LaTeX</category>
      </categories>
      <tags>
        <tag>帮助文档</tag>
        <tag>LaTeX</tag>
        <tag>tlmgr</tag>
      </tags>
  </entry>
  <entry>
    <title>欢迎来到我的 GitHub.io</title>
    <url>/2020-12-12-welcome/</url>
    <content><![CDATA[<h1 id="这里是无锤乙醇的-GitHub-io"><a href="#这里是无锤乙醇的-GitHub-io" class="headerlink" title="这里是无锤乙醇的 GitHub.io"></a>这里是无锤乙醇的 <code>GitHub.io</code></h1><p>花了小一天来折腾 Hexo NexT 主题, 也算是把基本配置弄好了, 咕了好久的博客也是搭好了, 还有一些坑没有填, 比如<a href="https://blog.dlzhang.com/posts/32/">自定义侧边栏图标</a>, 有时间慢慢折腾吧. </p>
<p>接下来会把简书里的东西搬到这里, <del><a href="https://syvshc.gitee.io">Gitee Pages</a> 是主要更新的地方, 这边会同步更新.</del><br>就搁这更新了, Gitee 不折腾了</p>
<p>并且这篇文章会被用做测试</p>
<span id="more"></span>
<h1 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h1><p>更新了字体, <a href="https://leay.net/2020/02/14/hexo-next-font/">字体配置方法</a></p>
<p>this is a footnote test <sup><a href="#fn_1" id="reffn_1">1</a></sup></p>
<blockquote id="fn_1">
<sup>1</sup>. footnote<a href="#reffn_1" title="Jump back to footnote [1] in the text."> &#8617;</a>
</blockquote>
<p>this is a equation $ax^{2}+bx+c=0\,(a\ne 0)$, which solution is </p>
<script type="math/tex; mode=display">x_{1, 2}=\frac{-b\pm\sqrt{b^{2}-4ac}}{2a}</script><p>一元二次方程组 $ax^{2}+bx+c=0\ (a \ne 0)$ 的解为 $\eqref{eq:slo}$<br>\begin{equation}\label{eq:slo}<br>    x_{1, 2}=\frac{-b\pm\sqrt{b^{2}-4ac}}{2a}<br>\end{equation}</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;article&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line">    Hello <span class="keyword">\LaTeX</span></span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;article&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line">    Hello <span class="keyword">\LaTeX</span></span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;article&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line">    Hello <span class="keyword">\LaTeX</span></span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<p>这里是对 simple-icons 的一些测试: <span id="simple-icons-archlinux" class="simple-icon"><img src="https://cdnjs.cloudflare.com/ajax/libs/simple-icons/4.25.0/archlinux.svg" /></span></p>
]]></content>
      <categories>
        <category>杂项</category>
      </categories>
  </entry>
  <entry>
    <title>为博客添加 Gitalk 评论区</title>
    <url>/2021-03-05-enable-gitalk/</url>
    <content><![CDATA[<p>在 <a href="/2021-03-03-build-github-io/" title="搭建 github.io">搭建 github.io</a> 中我们配置了 <code>hexo+NexT</code> 的博客, 这次来给它添加一个评论区. 使用的是 <a href="https://github.com/gitalk/gitalk">gitalk</a>. </p>
<span id="more"></span>
<p><strong>注意</strong> 该方法可能存在隐私问题, 详见 <a href="https://www.v2ex.com/t/535608">V2EX 论坛</a>. </p>
<p>在 <code>hexotest/</code> 文件夹下使用</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm i --save gitalk</span><br></pre></td></tr></table></figure>
<p>来安装 <code>gitalk</code>, 而且 <code>NexT8</code> 内置了 <code>gitalk</code> 的接口, 在 <code>_config.next.yml</code> 中搜索 <code>gitalk</code> 即可看到</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Multiple Comment System Support</span></span><br><span class="line"><span class="attr">comments:</span></span><br><span class="line">  <span class="comment"># Available values: tabs | buttons</span></span><br><span class="line">  <span class="attr">style:</span> <span class="string">tabs</span></span><br><span class="line">  <span class="comment"># Choose a comment system to be displayed by default.</span></span><br><span class="line">  <span class="comment"># Available values: disqus | disqusjs | changyan | livere | gitalk | utterances</span></span><br><span class="line">  <span class="attr">active:</span></span><br><span class="line">  <span class="comment"># Setting `true` means remembering the comment system selected by the visitor.</span></span><br><span class="line">  <span class="attr">storage:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Lazyload all comment systems.</span></span><br><span class="line">  <span class="attr">lazyload:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># Modify texts or order for any navs, here are some examples.</span></span><br><span class="line">  <span class="attr">nav:</span></span><br><span class="line">    <span class="comment">#disqus:</span></span><br><span class="line">    <span class="comment">#  text: Load Disqus</span></span><br><span class="line">    <span class="comment">#  order: -1</span></span><br><span class="line">    <span class="comment">#gitalk:</span></span><br><span class="line">    <span class="comment">#  order: -2</span></span><br><span class="line"><span class="comment"># Gitalk</span></span><br><span class="line"><span class="comment"># For more information: https://gitalk.github.io</span></span><br><span class="line"><span class="attr">gitalk:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">github_id:</span> <span class="comment"># GitHub repo owner</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="comment"># Repository name to store issues</span></span><br><span class="line">  <span class="attr">client_id:</span> <span class="comment"># GitHub Application Client ID</span></span><br><span class="line">  <span class="attr">client_secret:</span> <span class="comment"># GitHub Application Client Secret</span></span><br><span class="line">  <span class="attr">admin_user:</span> <span class="comment"># GitHub repo owner and collaborators, only these guys can initialize gitHub issues</span></span><br><span class="line">  <span class="attr">distraction_free_mode:</span> <span class="literal">true</span> <span class="comment"># Facebook-like distraction free mode</span></span><br><span class="line">  <span class="comment"># When the official proxy is not available, you can change it to your own proxy address</span></span><br><span class="line">  <span class="attr">proxy:</span> <span class="string">https://cors-anywhere.herokuapp.com/https://github.com/login/oauth/access_token</span> <span class="comment"># This is official proxy adress</span></span><br><span class="line">  <span class="comment"># Gitalk&#x27;s display language depends on user&#x27;s browser or system environment</span></span><br><span class="line">  <span class="comment"># If you want everyone visiting your site to see a uniform language, you can set a force language value</span></span><br><span class="line">  <span class="comment"># Available values: en | es-ES | fr | ru | zh-CN | zh-TW</span></span><br><span class="line">  <span class="attr">language:</span></span><br></pre></td></tr></table></figure>
<p>这里做一下简单的说明. </p>
<p>首先要在 <a href="https://github.com/settings/developers">github devoloper</a> 创建新的 OAuth App<br><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/githubdevelop.png" alt=""><br>点击创建好的 OAuth App, 可以看到<br><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/clientid.png" alt=""><br>点击 <code>Generate a new client secret</code> 可以得到一个 <code>client secret</code>. 把 <code>client ID</code> 与 <code>client secret</code> 分别填写在 <code>yml</code> 文件的 <code>client_id</code> 与 <code>client_secret</code> 字段中, 剩下的字段填自己的信息以及用来存放评论的 repo, 这里我填的 <code>&lt;username&gt;.github.io</code>. 配置好以后, 使用<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo g -d</span><br></pre></td></tr></table></figure><br>进行在线部署, 随便选一篇博文, 在最下方登录一下 <code>github</code> 完成初始化. </p>
<p>但是遇到了问题.<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Error: Request failed with status code 403</span><br></pre></td></tr></table></figure><br>经查询发现这个问题普遍存在, 比如微信文章 <a href="https://mp.weixin.qq.com/s?__biz=Mzg3MjU3NzU1OA==&amp;mid=2247496606&amp;idx=1&amp;sn=8e0b6e2600f939c5401f2344dce2cba6&amp;source=41#wechat_redirect">记录一次 Bug 排查过程并分享一些经验</a>, <a href="https://github.com/gitalk/gitalk/issues/429">gitalk’s issue</a>. 作者也给了相应的<a href="https://github.com/gitalk/gitalk/issues/429#issuecomment-789423631">解决方法</a></p>
<p>我这里将 <code>proxy</code> 替换为了<br><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">proxy:</span> <span class="string">https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token</span></span><br></pre></td></tr></table></figure><br>再次 <code>hexo clean &amp;&amp; hexo g -d</code>, 即可使用 <code>gitalk</code>, 评论区会作为设置中的 <code>repo</code> 的 <code>issue</code> 存在. </p>
]]></content>
      <categories>
        <category>帮助文档</category>
        <category>blog</category>
      </categories>
      <tags>
        <tag>配置记录</tag>
        <tag>帮助文档</tag>
        <tag>hexo</tag>
        <tag>gitalk</tag>
      </tags>
  </entry>
  <entry>
    <title>搭建 github.io</title>
    <url>/2021-03-03-build-github-io/</url>
    <content><![CDATA[<p><strong>在 NexT 主题更新 8.0 之后又重新配置了一次 <code>hexo+NexT</code>, 这次来记录一下, 并且会随时更新新增的配置.</strong></p>
<span id="more"></span>
<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p>假定用户的电脑上已经安装 <code>git</code>, 并且已经与 <a href="https://github.com">github</a> 连接, 如何使用 SSH 与 github 连接可以查看<a href="https://docs.github.com/en/authentication/connecting-to-github-with-ssh">官方文档</a>, 并熟悉 <code>git</code> 的相关操作.</p>
<h3 id="创建仓库"><a href="#创建仓库" class="headerlink" title="创建仓库"></a>创建仓库</h3><p>在 <a href="https://github.com">github</a> 上新建一个仓库, 名称为 <code>&lt;username&gt;.github.io</code>, 将 <code>&lt;username&gt;</code> 替换为你的 <code>github</code> 账户名.</p>
<h3 id="安装-node-js"><a href="#安装-node-js" class="headerlink" title="安装 node.js"></a>安装 <code>node.js</code></h3><p>在 <a href="https://nodejs.org/en/">node.js的官网</a> 上下载 <code>LTS</code> 版本安装, 记得勾选 <code>ADD TO PATH</code>. 安装后在命令行输入 <code>npm -v</code>, 如果有版本号输出, 那么说明安装成功, 如果返回</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;npm&#x27;</span> 不是内部或外部命令，也不是可运行的程序或批处理文件。</span><br></pre></td></tr></table></figure>
<p>那么将 <code>&lt;InstallPath&gt;/nodejs</code> 添加到环境变量. 然后命令行运行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br></pre></td></tr></table></figure>
<p>安装 <code>hexo</code>, 确保安装后可以运行 <code>hexo</code> 命令.</p>
<h3 id="初始化博客"><a href="#初始化博客" class="headerlink" title="初始化博客"></a>初始化博客</h3><p>用 <code>cmd</code> 进入想存放博客的文件夹 <code>&lt;folder&gt;</code>, 运行 <code>hexo init &lt;blogname&gt;</code>, 将 <code>&lt;blogname&gt;</code> 替换成博客的项目名, 比如 <code>hexotest</code>. 因为 <code>hexo init</code> 的过程要链接 <code>github</code>, 如果出现卡顿, 可以尝试看<a href="https://github.com/hexojs/hexo/issues/3693">Github issue</a>以及这个<a href="https://yuhaicheng.xyz/5.html">博客</a>尝试解决.</p>
<p>初始化结束后会看到这样的文件树</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">folder</span><br><span class="line">  └── hexotest</span><br><span class="line">        ├── db.json</span><br><span class="line">        ├── node_modules</span><br><span class="line">        ├── package-lock.json</span><br><span class="line">        ├── package.json</span><br><span class="line">        ├── public</span><br><span class="line">        ├── scaffolds</span><br><span class="line">        ├── source</span><br><span class="line">        ├── themes</span><br><span class="line">        ├── _config.landscape.yml</span><br><span class="line">        └── _config.yml</span><br></pre></td></tr></table></figure>
<h2 id="部署博客"><a href="#部署博客" class="headerlink" title="部署博客"></a>部署博客</h2><h3 id="本地部署"><a href="#本地部署" class="headerlink" title="本地部署"></a>本地部署</h3><p>我们进入 <code>hexotest</code> 文件夹, 输入</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo g</span><br><span class="line">hexo s</span><br></pre></td></tr></table></figure>
<p>会有如下输出</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">INFO  Validating config</span><br><span class="line">INFO  Start processing</span><br><span class="line">INFO  Hexo is running at http://localhost:4000 . Press Ctrl+C to stop.</span><br></pre></td></tr></table></figure>
<p>这时在浏览器中输入 <code>localhost:4000</code> 即可看到部署在本地的博客</p>
<p><img src="https://pic4.zhimg.com/80/v2-8c21ffd0058d9cba4be5da45c49f1663.png" alt=""></p>
<p>然后我们命令行输入 <code>ctrl+C</code> 来结束本地部署.</p>
<h3 id="在线部署"><a href="#在线部署" class="headerlink" title="在线部署"></a>在线部署</h3><p>当然我们写博客的目的大多都是要上传到互联网, 于是我们要把博客部署到 <code>&lt;username&gt;.github.io</code>.</p>
<p>首先安装部署插件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-deployer-git</span><br></pre></td></tr></table></figure>
<p>打开 <code>hexotest</code> 下的 <code>_config.yml</code> 配置文件, 找到 <code>deploy</code>, 填入以下信息</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/deployment.html</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">&lt;git</span> <span class="string">repo</span> <span class="string">ssh</span> <span class="string">address&gt;</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure>
<p>注意这里的 <code>&lt;git repo ssh address&gt;</code> 是形如 <code>git@github.com:username/username.github.io.git</code> 的地址. 再注意 <code>branch</code> 字段中的 <code>master</code> 可能为 <code>main</code>. 再运行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo d</span><br></pre></td></tr></table></figure>
<p>等待部署成功, 成功后就可以在 <code>&lt;username&gt;.github.io</code> 上看到博客的内容了.</p>
<h2 id="创建博文"><a href="#创建博文" class="headerlink" title="创建博文"></a>创建博文</h2><h3 id="新建博文"><a href="#新建博文" class="headerlink" title="新建博文"></a>新建博文</h3><p>在 <code>hexotest/</code> 文件夹下, 用 <code>cmd</code> 执行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo n <span class="string">&quot;&lt;blog_name&gt;&quot;</span></span><br></pre></td></tr></table></figure>
<p>将 <code>&lt;blog_name&gt;</code> 替换为博文的名字, 注意不能有空格, 这里我们使用 <code>hexo n &quot;first-blog&quot;</code>, 成功后会在 <code>source/_posts/</code> 文件夹下看到 <code>first-blog.md</code> 文件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">source</span><br><span class="line">└── _posts</span><br><span class="line">   ├── first-blog.md</span><br><span class="line">   └── hello-world.md</span><br></pre></td></tr></table></figure>
<p>同时我们还发现了另一个文件 <code>hello-world.md</code>, 这就是我们在本地部署成功后看到的那一篇博文.</p>
<p>用熟悉的编辑器打开 <code>first-blog.md</code>, 将其内容修改为</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: 第一篇博文</span><br><span class="line">date: 2021-03-04 00:32:07</span><br><span class="line">tags:</span><br><span class="line">    - [博文]</span><br><span class="line">    - [测试]</span><br><span class="line">    - [whatever]</span><br><span class="line">categories:</span><br><span class="line">    - [测试, 测试的子分类]</span><br><span class="line">---</span><br><span class="line">这是我的第一篇博文</span><br></pre></td></tr></table></figure>
<p>其中 <code>tags</code> 与 <code>categories</code> 可以自行设置, 它们的关系可以参考这个<a href="https://www.zhihu.com/question/19561626">问题</a></p>
<p>再使用 <code>hexo g &amp;&amp; hexo s</code> 进行本地部署, 在 <code>localhost:4000</code> 看到刚刚编辑的博文”第一篇博文”, 点进去可以看到</p>
<p> <img src="https://pic4.zhimg.com/80/v2-797a1b83cb08f7653adcb43d56838b8c.png" alt=""></p>
<p> 然后可以再使用 <code>hexo d</code> 将其推送到 <code>&lt;username&gt;.github.io</code>, 等待一会如果没有更新内容, 那么就执行一下 <code>hexo clean</code> 来清空部署缓存. 于是我们将博文推送到远端的命令可以归为</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</span><br></pre></td></tr></table></figure>
<h2 id="美化界面"><a href="#美化界面" class="headerlink" title="美化界面"></a>美化界面</h2><h3 id="配置基本信息"><a href="#配置基本信息" class="headerlink" title="配置基本信息"></a>配置基本信息</h3><p>配置文件 <code>hexotest/_config.yml</code> 是对应于我们博客的最高级的配置文件, 里面有一些字段可以进行配置, 作为示例修改了下面几项</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># Site</span><br><span class="line">title: SYVHSC&#x27;s BLOG</span><br><span class="line">subtitle: &#x27;&#x27;</span><br><span class="line">description: &#x27;无锤乙醇的博客&#x27;</span><br><span class="line">keywords: LaTeX, 数学</span><br><span class="line">author: 无锤乙醇</span><br><span class="line">language: zh-CN</span><br><span class="line">timezone: Asia/Shanghai</span><br></pre></td></tr></table></figure>
<p>进行本地部署可以看到</p>
<p><img src="https://pic4.zhimg.com/80/v2-8121a42938033c596ae6e0a8022d1bcd.png" alt=""></p>
<h3 id="更换主题"><a href="#更换主题" class="headerlink" title="更换主题"></a>更换主题</h3><p>这里我们选用 <code>NexT</code> 主题进行配置. 由于 <code>NexT8.0+</code> 已经支持 <code>npm</code> 安装, 于是可以在目录 <code>hexotest/</code> 下用 <code>cmd</code> 执行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-theme-next</span><br></pre></td></tr></table></figure>
<p>并在 <code>hexotest/_config.yml</code> 中找到 <code>theme</code> 字段, 修改为 <code>theme: next</code>, 保存后本地部署, 可以看到博客的主题已经更换</p>
<p><img src="https://pic4.zhimg.com/80/v2-d115746d176f5fb3a6aa6ac7d05e73ba.png" alt=""></p>
<p>然后我们可以把 <code>node_modules/hexo-theme-next/</code> 中的 <code>_config.yml</code> 改为 <code>_config.next.yml</code> 并且复制到根目录 <code>hexotest/</code> 下进行修改, 这样当我们升级 <code>NexT</code> 主题的时候不需要重新配置.</p>
<h3 id="下面配置-NexT-主题的一些事项-这里只介绍一些功能的作用-并不具体配置"><a href="#下面配置-NexT-主题的一些事项-这里只介绍一些功能的作用-并不具体配置" class="headerlink" title="下面配置 NexT 主题的一些事项, 这里只介绍一些功能的作用, 并不具体配置"></a>下面配置 <code>NexT</code> 主题的一些事项, 这里只介绍一些功能的作用, 并不具体配置</h3><ol>
<li><strong>scheme</strong> <code>NexT</code> 主题内置了 4 种样式, 可以依次启用来选择一个适合自己的, 这里我选择了 <code>Gemini</code>;</li>
<li><strong>favicon</strong> 配置标签页的图标, 可以自行选择图片, 放在 <code>hexotest/source/img</code> 文件夹下便于寻找, 设置中的路径也应改为 <code>/img/***.png(jpg, svg...)</code>;</li>
<li><strong>menu</strong> 配置博客页面的链接;</li>
<li><strong>social</strong> 配置博客页面的外部链接, 图标可以在 <a href="https://fontawesome.com/">fontawsome</a> 进行选择;</li>
<li><strong>avatar</strong> 配置博客侧边栏的头像, 图片选择同 <strong>favicon</strong>;</li>
<li><strong>toc</strong> 配置浏览博文时侧边栏的目录;</li>
<li><p><strong>font</strong> 配置文章中的字体;<br>在 <code>_config.next.yml</code> 中不能配置多种字体, 如果想配置多种字体, 可以修改</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexotest\node_modules\hexo-theme-next\source\css\_variables\base.styl</span><br></pre></td></tr></table></figure>
<p>中的 <code>\\Font families</code> 中的值</p>
</li>
<li><strong>codeblock</strong> 配置代码块;</li>
<li><strong>back2top</strong> 配置返回顶部的按钮;</li>
<li><strong>reading_progress</strong> 配置阅读进度条;</li>
<li><strong>symbols_count_time</strong> 配置站点字数和阅读时间统计, <a href="https://github.com/next-theme/hexo-word-counter">使用方法</a>;</li>
<li><strong>creative_commons</strong> 配置文末版权信息, 关于 cc 协议可以参考<a href="https://zhuanlan.zhihu.com/p/20641764">知乎专栏</a>;</li>
<li><strong>local_search</strong> 配置搜索栏, <a href="https://github.com/theme-next/hexo-generator-searchdb">使用方法</a>;</li>
<li><strong>links_settings &amp; links</strong> 配置友情链接;</li>
</ol>
<h3 id="这是一些不知道放到哪里的配置"><a href="#这是一些不知道放到哪里的配置" class="headerlink" title="这是一些不知道放到哪里的配置"></a>这是一些不知道放到哪里的配置</h3><ol>
<li><strong>markdown-it-plus</strong> 可以提供脚注等功能, 目录, emoji, katex 等功能, <a href="https://github.com/CHENXCHEN/hexo-renderer-markdown-it-plus">使用方法</a> emoji 功能与 <code>hexo-renderer-pandoc</code> 冲突;</li>
<li><p><strong>hexo-renderer-pandoc</strong> 提供 mathjax 渲染, 将 <code>tags</code> 设置为 <code>ams</code> 还可以使用公式编号<a href="https://theme-next.js.org/docs/third-party-services/math-equations">使用方法</a>;</p>
<p>示例:</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line">一元二次方程组 <span class="built_in">$</span>ax<span class="built_in">^</span>&#123;2&#125;+bx+c=0<span class="keyword">\ </span>(a <span class="keyword">\ne</span> 0)<span class="built_in">$</span> 的解为 <span class="built_in">$</span><span class="keyword">\eqref</span>&#123;eq:slo&#125;<span class="built_in">$</span></span><br><span class="line"><span class="comment">% 注意: 行内公式的 $...$ 前后不要有空格</span></span><br><span class="line"><span class="keyword">\begin</span>&#123;equation&#125;<span class="keyword">\label</span>&#123;eq:slo&#125;</span><br><span class="line">     x<span class="built_in">_</span>&#123;1, 2&#125;=<span class="keyword">\frac</span>&#123;-b<span class="keyword">\pm</span><span class="keyword">\sqrt</span>&#123;b<span class="built_in">^</span>&#123;2&#125;-4ac&#125;&#125;&#123;2a&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;equation&#125;</span><br></pre></td></tr></table></figure>
<p>一元二次方程组 $ax^{2}+bx+c=0\ (a \ne 0)$ 的解为 $\eqref{eq:slo}$<br>\begin{equation}\label{eq:slo}<br>   x_{1, 2}=\frac{-b\pm\sqrt{b^{2}-4ac}}{2a}<br>\end{equation}</p>
</li>
<li><p><strong>gitalk</strong> 配置评论区. 配置方法在 <a href="/2021-03-05-enable-gitalk/" title="为博客添加 Gitalk 评论区">为博客添加 Gitalk 评论区</a>.</p>
</li>
<li><strong>busuanzi</strong> 配置阅读访问量. 在 <code>hexotest/</code> 文件夹下运行</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install busuanzi.pure.js --save</span><br></pre></td></tr></table></figure>
<p>来安装不蒜子阅读访问量插件, 在 <code>_config.next.yml</code> 文件中搜索 <code>busuanzi</code> 即可找到</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Show Views / Visitors of the website / page with busuanzi.</span></span><br><span class="line"><span class="comment"># For more information: http://ibruce.info/2015/04/04/busuanzi/</span></span><br><span class="line"><span class="attr">busuanzi_count:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">total_visitors:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">total_visitors_icon:</span> <span class="string">fa</span> <span class="string">fa-user</span></span><br><span class="line">  <span class="attr">total_views:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">total_views_icon:</span> <span class="string">fa</span> <span class="string">fa-eye</span></span><br><span class="line">  <span class="attr">post_views:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">post_views_icon:</span> <span class="string">far</span> <span class="string">fa-eye</span></span><br></pre></td></tr></table></figure>
<p>把 <code>enable</code> 字段改为 <code>true</code> 即可开启. 使用</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo g -d</span><br></pre></td></tr></table></figure>
<p>部署到线上, 如果没有刷新, 使用 <code>ctrl+f5</code> 进行强制刷新即可.</p>
<ol>
<li><strong>hexo-pdf</strong> 可以在博客中插入 PDF 文件, 需要将 <code>_config.next.yml</code> 中的 <code>pdf</code> 中的 <code>enable</code> 字段改为 <code>true</code>, 感谢 <a href="https://shukangzhang.com/hexo-tian-jia-pdf/">shukangzhang 的博客</a>.</li>
</ol>
<h2 id="未完待续"><a href="#未完待续" class="headerlink" title="未完待续"></a>未完待续</h2>]]></content>
      <categories>
        <category>帮助文档</category>
        <category>blog</category>
      </categories>
      <tags>
        <tag>配置记录</tag>
        <tag>帮助文档</tag>
      </tags>
  </entry>
  <entry>
    <title>全国大学生数学建模竞赛模板的 `\maketitle` 处报错</title>
    <url>/2021-08-04-cumcmthesis-maketitle/</url>
    <content><![CDATA[<p>在各种地方获取的全国大学生数学建模竞赛的模板 CUMCMThesis, 使用 <code>xelatex</code> 编译后会有如下的报错</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">! Extra &#125;, or forgotten \endgroup.</span><br><span class="line">\UL@stop ...alty \ifnum \lastkern =\thr@@ \egroup </span><br><span class="line">                                                  \egroup \ifdim \wd \UL@box...</span><br><span class="line">l.22  \maketitle</span><br><span class="line">                </span><br><span class="line">?</span><br></pre></td></tr></table></figure>
<span id="more"></span>
<h3 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h3><p>先说解决方法: 在 <a href="https://github.com/latexstudio/CUMCMThesis">LaTeXStudio 的 Github</a> 上的 <code>Code</code> 处进行模板的下载或者 <code>clone</code>. 并搭配 <code>TeXLive 2020/2021</code>, 使用 <code>xelatex</code> 编译即可. </p>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/cumcmthesis-maketitle/cumcm.jpg" alt=""></p>
<h3 id="产生问题的原因"><a href="#产生问题的原因" class="headerlink" title="产生问题的原因"></a>产生问题的原因</h3><p>产生问题的原因可以看这个 <a href="https://github.com/latexstudio/CUMCMThesis/pull/17">Pull Request</a>, 这里再拿出来说一下</p>
<p>参考 <a href="https://tex.stackexchange.com/questions/568732/uline-does-not-work-with-hspace">TeX.SE</a> 与 <a href="https://wenda.latexstudio.net/q-5448.html">问答站</a> 可以知道<br><figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;article&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;ulem&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line">    <span class="keyword">\uline</span>&#123;<span class="keyword">\hspace</span>&#123;2em&#125;&#125;</span><br><span class="line">    <span class="comment">% \uline&#123;\mbox&#123;\hspace&#123;2em&#125;&#125;&#125; % 为正确写法</span></span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure></p>
<p>会导致错误<br><figure class="highlight tex"><table><tr><td class="code"><pre><span class="line">! Extra &#125;, or forgotten <span class="keyword">\endgroup</span>.</span><br><span class="line"><span class="keyword">\UL@stop</span> ...alty <span class="keyword">\ifnum</span> <span class="keyword">\lastkern</span> =<span class="keyword">\thr@@</span> <span class="keyword">\egroup</span></span><br><span class="line">                                                  <span class="keyword">\egroup</span> <span class="keyword">\ifdim</span> <span class="keyword">\wd</span> <span class="keyword">\UL@box</span>...</span><br><span class="line">l.4     <span class="keyword">\uline</span>&#123;<span class="keyword">\hspace</span>&#123;2em&#125;&#125;</span><br></pre></td></tr></table></figure></p>
<p>于是将 <code>cumcmthesis.cls</code> 中 346—384 行 (行数可能不对, 需要自行确认) 中的 <code>\hspace&#123;1em&#125;</code> 改为 <code>\mbox&#123;\hspace&#123;1em&#125;&#125;</code> 即可.</p>
]]></content>
      <categories>
        <category>LaTeX</category>
        <category>模板</category>
      </categories>
      <tags>
        <tag>LaTeX</tag>
        <tag>日经问题</tag>
        <tag>模板</tag>
      </tags>
  </entry>
  <entry>
    <title>Arch Linux 与 Windows 10 的双系统安装与折腾</title>
    <url>/2021-09-02-ArchLinux/</url>
    <content><![CDATA[<p>手贱小白还愿意折腾. 自从上次重装系统之后, Ubuntu 总时不时地卡顿, 一气之下试了好几个发行版, 如 <a href="https://manjaro.org/">manjaro</a>, <a href="https://www.deepin.org/zh/">deepin</a> (我是没想到 deepin 的卡顿竟然是永久性的, 也许是我空间分配不合理吧), <a href="https://www.debian.org/index.zh-cn.html">debian</a> (这个体验还蛮好的), 最终一狠心, 要折腾不如折腾大的, 直接 <a href="https://archlinux.org/">Arch Linux</a> 走起.</p>
<span id="more"></span>
<p>从介绍来看 Arch Linux 最吸引我的有两点, 一个是 <a href="https://aur.archlinux.org/">AUR 仓库</a>, 另一个是 <a href="https://wiki.archlinux.org/">Arch Wiki</a>, 前者提供了海量用户打包好的软件, 后者提供了海量的说明文档.</p>
<p><strong><em>以下内容如没有特殊说明, 均在普通用户下操作, 即终端起始为 <code>$</code> 时, 同时也是在 Arch Linux + KDE Plasma 桌面下的配置, 其余发行版或桌面需要自行调整设置</em></strong></p>
<h3 id="双系统安装"><a href="#双系统安装" class="headerlink" title="双系统安装"></a>双系统安装</h3><p>第二次安装我看了另一个<a href="https://archlinuxstudio.github.io/ArchLinuxTutorial/#/">教程</a>, 它没有让 Arch 和 Windows 共用一个 EFI, 所以也不会干扰到正常的 Windows 启动. 或者说……这就不是一个双系统的安装教程.</p>
<p>双系统安装可以看<a href="https://zhuanlan.zhihu.com/p/138951848">这篇知乎</a>, 动手能力强的建议直接看 <a href="https://wiki.archlinux.org/title/Installation_guide_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87">Arch Wiki</a>), 我选择的桌面环境是 KDE Plasma, 默认环境下就很好看</p>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/ArchLinux/screenshot.png" alt="KDE Plasma"></p>
<p>安装后在系统设置中将语言与地区改为中文, 在改 Region 的时候注意是 <code>zh-CN</code>, 不要改成蒙古语 <code>mn_CN</code>.</p>
<h3 id="软件的安装与配置"><a href="#软件的安装与配置" class="headerlink" title="软件的安装与配置"></a>软件的安装与配置</h3><h4 id="安装重要组件-yay"><a href="#安装重要组件-yay" class="headerlink" title="安装重要组件 yay"></a>安装重要组件 <code>yay</code></h4><h5 id="添加-archlinuxcn-源"><a href="#添加-archlinuxcn-源" class="headerlink" title="添加 archlinuxcn 源"></a>添加 <code>archlinuxcn</code> 源</h5><p>国内的 Arch 组织也打包了一些软件, 我们将<a href="https://github.com/archlinuxcn/repo#readme"><code>archlinuxcn</code></a> 的源也添加到 <code>pacman</code> 的源列表</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kate /etc/pacman.conf</span><br></pre></td></tr></table></figure>
<p>在最下方添加</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[archlinuxcn]</span><br><span class="line">Server = https://repo.archlinuxcn.org/$arch</span><br></pre></td></tr></table></figure>
<p>用管理员权限保存后, 在终端运行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo pacman -Sy &amp;&amp; sudo pacman -S archlinuxcn-keyring</span><br></pre></td></tr></table></figure>
<p>来刷新仓库以及获取 PGP 钥匙串</p>
<h5 id="安装-yay"><a href="#安装-yay" class="headerlink" title="安装 yay"></a>安装 yay</h5><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo pacman -S yay</span><br></pre></td></tr></table></figure>
<p>简单说一下 <code>yay</code>: Arch Linux 除了官方的软件库以外, 还提供了一个允许用户上传软件包的仓库, <a href="https://aur.archlinux.org/">AUR 仓库</a>, 你可以在上面找到几乎任何你想要安装的软件, <del>甚至基于 <code>deepin-wine</code> 的 qq 和微信</del>(这个在我的计算机上出现了问题, QQ 的问题见<a href="https://github.com/countstarlight/deepin-wine-qq-arch/issues/58">该issue</a>, 微信的问题为严重卡顿), Arch Linux 官方的包管理软件为 <code>pacman</code>, AUR 仓库的管理软件则为 <code>yay</code>.</p>
<p>当然, 也可以选择去 <a href="https://aur.archlinux.org/packages/yay/">AUR 仓库</a> 中将 <code>yay</code> 克隆到本地并使用 <code>makepkg -si</code> 进行安装.</p>
<h4 id="我的常用软件"><a href="#我的常用软件" class="headerlink" title="我的常用软件"></a>我的常用软件</h4><p>一些软件可以在 Arch Wiki 上找到它们的不同版本的对比信息, 一些软件的详细配置会在后文详述</p>
<h5 id="官方仓库"><a href="#官方仓库" class="headerlink" title="官方仓库"></a>官方仓库</h5><p>用 <code>sudo pacman -S &lt;软件包&gt;</code> 安装, 这里序号后的名称就是包名, 下同</p>
<ol>
<li><a href="https://archlinux.org/packages/extra/x86_64/firefox/">firefox</a>, Mozilla 出品的火狐浏览器, 使用体验不错</li>
<li><a href="https://archlinux.org/packages/community/x86_64/flameshot/">flameshot</a>, 火焰截图, 一款截图/贴图软件, 使用方便, 如何设置全局快捷键可以看 <a href="https://github.com/flameshot-org/flameshot#keyboard-shortcuts">README</a>, 英文看不懂的可以看<a href="https://www.djc8.cn/archives/manjaro-uses-flashshot-as-a-screenshot-tool.html">这个博客</a></li>
<li><a href="https://archlinux.org/packages/community/x86_64/fcitx/">fcitx</a>, 小企鹅输入框架, <del>这里我选了 v4 版本的, 没有用 fcitx5</del>, 我换成 <a href="https://archlinux.org/groups/x86_64/fcitx5-im/">fcitx5-im</a> 了, 同理下面的变成 <a href="https://archlinux.org/packages/community/x86_64/fcitx5-rime/">fcitx5-rime</a></li>
<li><a href="https://archlinux.org/packages/community/x86_64/fcitx-rime/">fcitx-rime</a>, 中州韵输入法, 我常用的小鹤音形可以在该输入法上实现, 具体的其他输入方式可以看 <a href="https://wiki.archlinux.org/title/Fcitx_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87">Fcitx (简体中文)</a>)</li>
<li><a href="https://archlinux.org/packages/community/x86_64/fcitx-qt5/">fcitx-qt5</a>, <a href="https://archlinux.org/packages/community/x86_64/kcm-fcitx/">kcm-fcitx</a>, <a href="https://archlinux.org/packages/community/x86_64/fcitx-configtool/">fcitx-configtool</a>, 分别为fcitx 提供对 Qt 提供的输入法模块, fcitx 的图形配置界面, fcitx 的配置工具</li>
<li><a href="https://archlinux.org/packages/extra/x86_64/zsh/">zsh</a>, Z-Shell 终端, 有 <code>oh-my-zsh</code> 的配合, 配置起来相对容易</li>
<li><p><a href="https://archlinux.org/packages/community/any/screenfetch/"><del>screenfetch</del></a>, 在终端通过 <code>screenfetch</code> 命令来显示发行版的 logo 与信息, 该软件的 3.9.1 版本输出时会报 warning:</p>
 <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/usr/bin/screenfetch:行1802: 7020826624-：语法错误: 需要操作数 (错误符号是 &quot;-&quot;)</span><br></pre></td></tr></table></figure>
</li>
<li><p><a href="https://archlinux.org/packages/community/any/neofetch/">neofetch</a>, 与 screenfetch 相同的功能.</p>
</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">➜ neofetch</span><br><span class="line">                   -`                    syvshc@archlinux </span><br><span class="line">                  .o+`                   ---------------- </span><br><span class="line">                 `ooo/                   OS: Arch Linux x86_64 </span><br><span class="line">                `+oooo:                  Host: Inspiron 5577 1.1.3 </span><br><span class="line">               `+oooooo:                 Kernel: 5.13.13-arch1-1 </span><br><span class="line">               -+oooooo+:                Uptime: 4 hours, 1 min </span><br><span class="line">             `/:-:++oooo+:               Packages: 1493 (pacman) </span><br><span class="line">            `/++++/+++++++:              Shell: zsh 5.8 </span><br><span class="line">           `/++++++++++++++:             Resolution: 1920x1080, 1920x1080 </span><br><span class="line">          `/+++ooooooooooooo/`           DE: Plasma 5.22.5 </span><br><span class="line">         ./ooosssso++osssssso+`          WM: KWin </span><br><span class="line">        .oossssso-````/ossssss+`         Theme: Breeze Light [Plasma], Breeze [GTK2/3] </span><br><span class="line">       -osssssso.      :ssssssso.        Icons: Papirus-Nordic [Plasma], Papirus-Nordic [GTK2/3] </span><br><span class="line">      :osssssss/        osssso+++.       Terminal: konsole </span><br><span class="line">     /ossssssss/        +ssssooo/-       CPU: Intel i5-7300HQ (4) @ 3.500GHz </span><br><span class="line">   `/ossssso+/:-        -:/+osssso+-     GPU: Intel HD Graphics 630 </span><br><span class="line">  `+sso+:-`                 `.-/+oso:    GPU: NVIDIA GeForce GTX 1050 Mobile </span><br><span class="line"> `++:.                           `-/+/   Memory: 8548MiB / 15775MiB </span><br><span class="line"> .`                                 `/                                   </span><br></pre></td></tr></table></figure>
<ol>
<li><p><a href="https://archlinux.org/packages/?name=steam">steam</a>, 需要在 <code>/etc/pacman.conf</code> 中开启 <code>multilib</code> 仓库, 并且需要安装一些图形驱动, 详见 <a href="https://wiki.archlinux.org/title/Steam_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87">steam 的 Wiki</a>), 如果开启 steam 后商店等界面均为黑屏幕, 不显示内容, 可以将 steam 的通道改为 <code>beta channel</code>, 具体问题见<a href="https://www.gamingonlinux.com/2021/09/steam-not-working-right-on-arch-linux-its-an-issue-with-freetype-and-theres-a-fix">关于 steam 黑屏的讨论</a>. 在安装 steam 的过程中发现了一个可选的依赖项</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">steam 的可选依赖</span><br><span class="line">    steam-native-runtime: steam native runtime support</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>将其 <code>pacman</code> 安装后 steam 启动很丝滑, 虽然不知道为什么, 好用就行吧</p>
<ol>
<li><p><a href="https://archlinux.org/packages/community/x86_64/obs-studio/">obs-studio</a>, 老牌屏幕录制软件</p>
</li>
<li><p><a href="https://archlinux.org/packages/extra/x86_64/vim/">vim</a>, 文本编辑器, 正在学习</p>
</li>
<li><p><a href="https://archlinux.org/packages/community/any/man-pages-zh_cn/">man-pages-zh_cn</a>, 中文帮助手册, 在终端用 <code>man &lt;命令&gt;</code> 来呼出</p>
</li>
<li><a href="https://archlinux.org/packages/community/x86_64/peek/">peek</a>, 好用的 gif 录制软件</li>
<li><a href="https://archlinux.org/packages/community/x86_64/latte-dock/">latte-dock</a>, KDE 下的 Dock 软件, 挺好看的, 可以按照这个<a href="https://amane-live.fars.ee/2018/12/04/tweak-kde/">博客</a>来配置一下. 这是我配置好的, 并不完全按照刚才的博客</li>
</ol>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/ArchLinux/2021-09-06_21-28.png" alt="my desktop"></p>
<ol>
<li><a href="https://archlinux.org/packages/community/x86_64/telegram-desktop/">telegram-desktop</a>, 即时通讯软件 Telegram, 可能需要魔法</li>
<li><a href="https://archlinux.org/packages/community/any/screenkey/">screenkey</a>, 可以在屏幕上显示按键, 配合录屏软件表现不错</li>
</ol>
<h5 id="AUR-仓库"><a href="#AUR-仓库" class="headerlink" title="AUR 仓库"></a>AUR 仓库</h5><p>用 <code>yay -S &lt;软件包&gt;</code> 安装,</p>
<ol>
<li><a href="https://aur.archlinux.org/packages/microsoft-edge-dev-bin">microsoft-edge-dev-bin</a>, 微软的新 edge, 由于我的插件与书签等都备份在了 Windows 的 edge 上, 这里我首选 edge, 如果没有这些包袱, 新的 FireFox 也是很好的选择. <del>注意！95.0.0997.1 及以后的版本疑似与更新的 <code>systemd</code> 不兼容, 会无法启动, 见 <a href="https://techcommunity.microsoft.com/t5/discussions/edge-dev-95-0-997-1-consistently-fails-to-launch-since-systemd/m-p/2727796">techcommunity</a>, 请在”查看更改”处选择 <a href="https://aur.archlinux.org/cgit/aur.git/commit/?h=microsoft-edge-dev-bin&amp;id=b43b6cd9d428ecccf9be1f854c0802b61344c622">94.0.982.2 版本</a> 进行下载并本地安装, 且在 <code>yay -Syu</code> 时忽略 microsoft-edge-dev-bin 的更新!</del> 95.0.1020.0-1 版本已经修复问题, 可以正常使用.</li>
<li><a href="https://aur.archlinux.org/packages/visual-studio-code-bin/">visual-studio-code-bin</a>, 这里我选择了微软官方专用软件版本, 为了设置同步. 安装后可以直接在终端使用 <code>code &lt;文件夹/文件&gt;</code> 打开文件夹/文件</li>
<li><a href="https://aur.archlinux.org/packages/telegram-desktop-bin/"><del>telegram-desktop-bin</del></a> <strong><del>该软件已经被官方仓库收编</del>, 原来它一直都在官方仓库里</strong>. 即时通讯软件 Telegram, 虽然我把它贴在这了, 但是由于无法下载部分组件, 我还是去了 <a href="https://desktop.telegram.org/">Telegram 的官网</a>下载了 <code>AppImage</code></li>
<li><p><a href="https://aur.archlinux.org/packages/oh-my-zsh-git/">oh-my-zsh-git</a>, 对于 <code>zsh</code> 的美化, 提供了一些易用的接口, 通过 <code>yay</code> 安装后需要手动将 <code>oh-my-zsh</code> 中的 <code>zshrc</code> 文件复制出来:</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cp /usr/share/oh-my-zsh/zshrc ~/.zshrc</span><br></pre></td></tr></table></figure>
</li>
<li><p><a href="https://aur.archlinux.org/packages/listen1-desktop-appimage/">listen1-desktop-appimage</a>, Listen1, 集成了网易云音乐, QQ 音乐, 咪咕音乐的开源播放器, <a href="https://aur.archlinux.org/packages/qqmusic-bin/">QQ 音乐</a>也有自己的包</p>
</li>
<li><a href="https://aur.archlinux.org/packages/deepin-wine-qq/">deepin-wine-qq</a>, 用 deepin-wine 实现的 windows qq, 这里只是列出, 我并没有使用</li>
<li><a href="https://aur.archlinux.org/packages/deepin-wine-wechat/">deepin-wine-wechat</a>, 用 deepin-wine 实现的 windows wechat, <del>我同样没有使用</del> 我还是用了, 这次很流畅……有玄学内味了. 由于源内的 deepin-udis86 没有更新, 所以安装 deepin-wine-wechat 前要注意先自己安装 deepin-udis86, 在 Github 上有打包好的 <a href="https://github.com/JohnMasoner/deepin-udis86">repo</a>.</li>
<li><p><a href="https://aur.archlinux.org/packages/sunloginclient/">sunloginclient</a>, 向日葵, 远程控制软件, 注意安装后的提示</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">*************************************************************************</span><br><span class="line">*  sunlogin daemon service must be running <span class="keyword">for</span> sunloginclient to work   *</span><br><span class="line">*  Type: systemctl start runsunloginclient.service                      *</span><br><span class="line">*************************************************************************</span><br></pre></td></tr></table></figure>
<p> 需要在终端运行</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">systemctl start runsunloginclient.service  </span><br></pre></td></tr></table></figure>
<p> 开启向日葵的服务才能运行软件.</p>
</li>
<li><a href="https://aur.archlinux.org/packages/7-zip/">7-zip</a>, 老牌解压软件, 好用</li>
<li><a href="https://aur.archlinux.org/packages/ttf-ms-win10/">ttf-ms-win10</a>, Windows10 的字体, 由于版权问题, 需要额外处理,详见<a href="#win10fonts">安装 Windows10 字体</a></li>
<li><a href="https://aur.archlinux.org/packages/wemeet-bin/">wemeet-bin</a>, 腾讯会议 Linux 版, 新鲜的</li>
<li><a href="https://aur.archlinux.org/packages/picgo-appimage/">picgo-appimage</a>, 本地图床软件, 配置见其<a href="https://picgo.github.io/PicGo-Doc/zh/guide/config.html#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BF%AB%E6%8D%B7%E9%94%AE">配置手册</a><sup><a href="#fn_githubimg" id="reffn_githubimg">githubimg</a></sup></li>
<li><a href="https://aur.archlinux.org/packages/wudao-dict-git/">wudao-dict-git</a>, 无道词典, 项目地址在 <a href="https://github.com/ChestnutHeng/Wudao-dict">Github</a>, 可以通过终端 <code>wd &lt;单词&gt;</code> 来查询单词.</li>
<li><a href="https://aur.archlinux.org/packages/v2raya/">v2raya</a>, 持续维护的代理软件, 这里是 <a href="https://github.com/v2rayA/v2rayA">Github repo</a> 与 <a href="https://github.com/v2rayA/v2rayA/wiki">Wiki</a></li>
</ol>
<blockquote id="fn_githubimg">
<sup>githubimg</sup>. 配置 Github 图床时要注意仓库设置为 Public<a href="#reffn_githubimg" title="Jump back to footnote [githubimg] in the text."> &#8617;</a>
</blockquote>
<h5 id="手动安装"><a href="#手动安装" class="headerlink" title="手动安装"></a>手动安装</h5><ol>
<li><a href="http://tug.org/texlive/">TeX Live 2021</a>, 安装可以参考啸行的 <a href="https://ctan.math.illinois.edu/info/install-latex-guide-zh-cn/install-latex-guide-zh-cn.pdf">install-latex-guide-zh-cn</a> 中的 <code>Ubuntu 20.04</code> 部分进行安装. 由于系统不同, 可以不在 <code>visudo</code> 中添加可信路径, 直接使用 <code>sudo tlmgr</code> 即可, 当然, Arch 官方仓库也打包了 <a href="https://archlinux.org/packages/?sort=&amp;q=texlive&amp;maintainer=&amp;flagged=">TeX Live</a>. 使用文档见 <a href="https://wiki.archlinux.org/title/TeX_Live_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87">Arch Wiki</a>), 但是我没用明白, 又给卸了</li>
</ol>
<p><strong>注意</strong>: 安装 TeX Live 后运行 <code>biber</code> 可能会出现</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">biber: error <span class="keyword">while</span> loading shared libraries: libcrypt.so.1: cannot open shared object file: No such file or directory</span><br></pre></td></tr></table></figure>
<p>的错误, 需要</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yay -S libxcrypt-compat</span><br></pre></td></tr></table></figure>
<p>参见 <a href="https://stackoverflow.com/questions/71171446/biber-wants-to-load-libcrypt-so-1-but-it-is-missing">stackoverflow</a></p>
<h5 id="代理"><a href="#代理" class="headerlink" title="代理"></a>代理</h5><p>我这里代理使用的是 <a href="https://qv2ray.net/lang/zh/getting-started/step1.html#linux-arch-linux-%E6%88%96%E5%9F%BA%E4%BA%8E-arch-%E7%9A%84%E5%8F%91%E8%A1%8C%E7%89%88">qv2ray</a>(可惜开发者由于矛盾放弃了这个项目, 正在寻找持续维护的替代品) + <a href="https://github.com/v2fly/v2ray-core/releases">v2core</a>, 由于某些原因, 直接看链接吧.</p>
<p>如果连接时出现类似</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[Warning] failed to handler mux client connection &gt; v2ray.com/core/proxy/vmess/outbound: connection ends &gt; v2ray.com/core/proxy/vmess/outbound: failed to <span class="built_in">read</span> header &gt; v2ray.com/core/proxy/vmess/encoding: failed to <span class="built_in">read</span> response header &gt; websocket: close 1000 (normal)</span><br></pre></td></tr></table></figure>
<p>的错误, 首先校对一下系统时间, 再进行连接.</p>
<h4 id="软件配置"><a href="#软件配置" class="headerlink" title="软件配置"></a>软件配置</h4><p>这里会给出一些软件的配置, 使用的插件等等.</p>
<h5 id="baloo"><a href="#baloo" class="headerlink" title="baloo"></a><a href="https://wiki.archlinux.org/title/Baloo">baloo</a></h5><p>这是 KDE 桌面自带的索引程序, 会检测文件的内容提供更精确的搜索服务, 但是屁用没有, 在建立索引的时候还会占用大量的 CPU 资源, Arch 社区的仙子建议直接把它干掉</p>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/ArchLinux/chat.png" alt="chat"></p>
<h4 id="系统时间"><a href="#系统时间" class="headerlink" title="系统时间"></a>系统时间</h4><p>由于 Windows 和 Linux 对于硬件时间的处理不同, 会出现切换到另一个系统时系统时间不对的情况. 可以参考<a href="https://sspai.com/post/55983">少数派的文章</a>, 我修改的是 Linux 的时间.</p>
<h5 id="microsoft-edge"><a href="#microsoft-edge" class="headerlink" title="microsoft-edge"></a>microsoft-edge</h5><p>我使用的插件有</p>
<ul>
<li><a href="https://microsoftedge.microsoft.com/addons/detail/adblock-%E2%80%94-%E6%9C%80%E4%BD%B3%E5%B9%BF%E5%91%8A%E6%8B%A6%E6%88%AA%E5%B7%A5%E5%85%B7/ndcileolkflehcjpmjnfbnaibdcgglog">AD Block</a> 广告拦截插件</li>
<li><a href="https://microsoftedge.microsoft.com/addons/detail/adblock-plus-%E5%85%8D%E8%B4%B9%E7%9A%84%E5%B9%BF%E5%91%8A%E6%8B%A6%E6%88%AA%E5%99%A8/gmgoamodcdcjnbaobigkjelfplakmdhh">AD Block Plus</a> 广告拦截插件</li>
<li><a href="https://microsoftedge.microsoft.com/addons/detail/listen-1/hneiglcmpeedblkmbndhfbeahcpjojjg">Listen 1</a> 与桌面版的 Listen 1 同样功能, 此为浏览器插件版本</li>
<li><a href="https://microsoftedge.microsoft.com/addons/detail/office/gggmmkjegpiggikcnhidnjjhmicpibll">Office</a> 在线的 Office 软件, 对于买了 Microsoft 365 的用户体验会有提升</li>
<li><a href="https://microsoftedge.microsoft.com/addons/detail/smartup%E6%89%8B%E5%8A%BF/elponhbfjjjihgeijofonnflefhcbckp">smartUp 手势</a> 鼠标手势插件</li>
<li><a href="https://microsoftedge.microsoft.com/addons/detail/%E5%93%94%E5%93%A9%E5%93%94%E5%93%A9%E5%8A%A9%E6%89%8B%EF%BC%9Abilibilicom-%E7%BB%BC%E5%90%88%E8%BE%85%E5%8A%A9%E6%89%A9/fcfebhekhbkhjjimonjmbgmkbclheaoh">Bilibili 助手</a> 提供 B 站的一些支持, 自动签到等</li>
<li><a href="https://microsoftedge.microsoft.com/addons/detail/%E6%B2%99%E6%8B%89%E6%9F%A5%E8%AF%8D%E8%81%9A%E5%90%88%E8%AF%8D%E5%85%B8%E5%88%92%E8%AF%8D%E7%BF%BB%E8%AF%91/idghocbbahafpfhjnfhpbfbmpegphmmp">沙拉查词</a> 词典插件, 支持划词查询, 集成了多家词典</li>
<li><a href="https://chrome.google.com/webstore/detail/absolute-enable-right-cli/jdocbkpgdakpekjlhemmfcncgdjeiika">Absolute Enable Right Click &amp; Copy</a> 强制启用复制, 右键功能, 此为 Chrome 插件</li>
</ul>
<h5 id="vscode"><a href="#vscode" class="headerlink" title="vscode"></a>vscode</h5><p>我主要使用 vscode 写 LaTeX, 这里并没有其他的配置信息.</p>
<ol>
<li><p>我使用的插件有</p>
<ul>
<li>C/C++</li>
<li>Chinese (Simplified) Language Pack for Visual Studio Code: 中文语言包</li>
<li>Git History: 查看 git 历史的插件, 现在貌似有 vscode 官方的管理器了</li>
<li>Jupyter: vscode 中使用 jupyter notebook</li>
<li>LaTeX Workshop: LaTeX 用户必备插件</li>
<li>Local History: 本地保存的时候会生成一个副本, 可以回滚版本, 一般用不上, 用上了就救命</li>
<li>Markdown All in One: markdown 高亮等支持</li>
<li>Markdown Preview Enhanced: 更强的 md 渲染器</li>
<li>Material Icon Theme: 好看的图标包</li>
<li>One Dark Pro: 好看的主题</li>
<li>Pylance &amp; Python: Python 用户插件</li>
<li>QQ: vscode 中使用 QQ</li>
<li>Terminal Here: 直接使 Terminal 定位在所打开的文件夹上</li>
<li>Cloudmusic: vscode 中使用网易云音乐</li>
</ul>
</li>
<li>这里是我的 <a href="https://gist.github.com/syvshc/999313a798d87a590b74ada95ec121ff">settings.json</a>, <a href="https://gist.github.com/syvshc/18a4dd84f7b47927ec6ed0ee3dbd474a">latex.json</a> 与 <a href="https://gist.github.com/syvshc/2fd2ed7af40500dafd861a2a1b3890f5">keybindings.json</a> 的内容, 点击链接即可查看/下载, 其中有针对 Windows 用户以及 KDE/Okular 用户的 LaTeX 正反向搜索的内容<sup><a href="#fn_1" id="reffn_1">1</a></sup>.</li>
<li><p>如果登录账户的时候出现<strong>将登陆信息写入钥匙串失败</strong>的错误信息, 在终端运行</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yay -S qtkeychain gnome-keyring</span><br></pre></td></tr></table></figure>
<p> 再重新在 vscode 中登录即可</p>
</li>
</ol>
<h5 id="Okular"><a href="#Okular" class="headerlink" title="Okular"></a>Okular</h5><ul>
<li><p>如果无法显示中文, 在终端运行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo pacman -S  poppler-data</span><br></pre></td></tr></table></figure>
<p>并重启 okular 即可.</p>
</li>
<li><p>使用 vscode 与 okular 进行 LaTeX 的正反向搜索, 在上述 <code>settings.json</code> 正确写入的基础上, 在 okular-&gt;设置-&gt;配置 Okular-&gt;编辑器 中, 选择自定义文本编辑器, 命令部分填写</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">code -r -g %f:%l</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/ArchLinux/okular.png" alt="okular"><br>应用后, 在默认设置下, 在 vscode 中的 <code>.tex</code> 文件中同时按 <code>Ctrl+Alt+j</code> 会唤起 okular 到对应的位置, 在 okular 中激活”手型工具”的基础上, 按住 <code>Shift</code>, 同时鼠标左键点击 <code>PDF</code> 中的内容, 即可唤起 vscode 跳转到对应的源代码位置<sup><a href="#fn_2" id="reffn_2">2</a></sup>.</p>
</li>
</ul>
<h5 id="zsh-amp-oh-my-zsh"><a href="#zsh-amp-oh-my-zsh" class="headerlink" title="zsh &amp; oh-my-zsh"></a>zsh &amp; oh-my-zsh</h5><ol>
<li><p>我使用的插件:</p>
<ul>
<li><a href="https://github.com/ohmyzsh/ohmyzsh/tree/master/plugins/git#readme">git</a>: oh-my-zsh 自带插件, 直接填入 plugin 即可使用, 提供了一些 <code>git</code> 的 alias</li>
<li><p><a href="https://github.com/ohmyzsh/ohmyzsh/blob/master/plugins/z/README.md">z</a>: oh-my-zsh 自带插件, 会记录曾经 <code>cd</code> 过的路径, 通过 <code>z &lt;不完整路径&gt;</code> 即可实现跳转, 如</p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/git/syvshc.github.io</span><br><span class="line">z github</span><br></pre></td></tr></table></figure>
<p>  即可直接进入 <code>~/git/syvshc.github.io</code> 文件夹.</p>
</li>
<li><a href="https://github.com/ohmyzsh/ohmyzsh/blob/master/plugins/sudo/README.md">sudo</a>: oh-my-zsh 自带插件, 敲两下 <code>ESC</code> 键即可为命令添加 <code>sudo</code></li>
<li><a href="https://github.com/zsh-users/zsh-syntax-highlighting">zsh-syntax-highlighting</a>, 命令高亮, 默认设置下绿色为正确, 红色为错误</li>
<li><a href="https://github.com/zsh-users/zsh-autosuggestions">zsh-autosuggestions</a>, 会记录用户输入过的命令, 并将其显示为灰色, 按 <code>-&gt;</code> 即可补全.</li>
</ul>
</li>
<li><p>安装插件</p>
<ol>
<li><p>可以通过直接 <code>git clone</code> 到用户目录的方式进行安装, 以 <code>zsh-autosuggestions</code> 插件为例</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/zsh-users/zsh-autosuggestions <span class="variable">$&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;</span>/plugins/zsh-autosuggestions</span><br></pre></td></tr></table></figure>
</li>
<li><p>可以先 <code>clone</code> 到本地目录</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> git@github.com:zsh-users/zsh-autosuggestions.git ~/.zsh/zsh-autosuggestions</span><br></pre></td></tr></table></figure>
<p> 再将下面一行添加到 <code>~/.zshrc</code></p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> ~/.zsh/zsh-autosuggestions/zsh-autosuggestions.zsh</span><br></pre></td></tr></table></figure>
<p> 重启终端即可, 注意: 如果使用这种方法, 则不需要在 <code>plugins</code> 中进行添加, 事实是就算添加了它也提示找不到插件.</p>
</li>
<li><p>通过 AUR 仓库与符号链接安装</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yay -S zsh-autosuggestions</span><br></pre></td></tr></table></figure>
<p> 安装后在 <code>zsh</code> 的目录下建立符号链接</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo ln -s /usr/share/zsh/plugins/zsh-autosuggestions /usr/share/oh-my-zsh/custom/plugins/</span><br></pre></td></tr></table></figure>
<p> 这样做的好处是 <code>yay -Syu</code> 更新软件的时候插件同样会被更新, 而不用手动再去 <code>git pull</code></p>
<p>安装完成后需要在 <code>~/.zshrc</code> 中修改 <code>plugins</code> 词条, 比如</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">plugins=(git z sudo zsh-autosuggestions)</span><br></pre></td></tr></table></figure>
<p>然后保存, 终端运行 <code>source ~/.zshrc</code> 使配置生效</p>
</li>
</ol>
</li>
<li>安装皮肤<ol>
<li>官方提供了一些皮肤, 可以在 <a href="https://github.com/ohmyzsh/ohmyzsh/wiki/Themes">oh-my-zsh 的 Wiki</a> 上查看,</li>
<li>用户皮肤. 一些皮肤没有进入到官方的皮肤库, 需要自行安装, 官方也整理了一些民间皮肤, 在 <a href="https://github.com/ohmyzsh/ohmyzsh/wiki/External-themes">External themes</a> 中, 每个皮肤都配备了对应的安装说明, 按照其说明安装即可</li>
</ol>
</li>
</ol>
<p>找到/安装完合适的皮肤后直接修改 <code>~/.zshrc</code> 文件中的 <code>ZSH_THEME</code> 词条即可. 然后 <code>source ~/.zshrc</code> 使配置生效, 我选择的皮肤为 <code>spaceship</code><br><img src="https://user-images.githubusercontent.com/10276208/36086434-5de52ace-0ff2-11e8-8299-c67f9ab4e9bd.gif" alt="spaceship"></p>
<h5 id="fcitx-rime"><a href="#fcitx-rime" class="headerlink" title="fcitx-rime"></a>fcitx-rime</h5><p><strong>需要在安装 fcitx 相关的软件包后进行</strong></p>
<h6 id="fcitx4"><a href="#fcitx4" class="headerlink" title="fcitx4"></a>fcitx4</h6><p>我使用的方案是小鹤音形, 从小鹤音形的<a href="https://flypy.com/">官网</a>提供的<a href="http://flypy.ys168.com/">网盘</a>中的”____3.小鹤音形挂接第三方平台”中下载”小鹤音形“鼠须管”for macOS.zip”, 解压后将 <code>/rime</code> 文件夹覆盖到 <code>~/.config/fcitx/rime</code> 文件夹, 再在配置中将 Rime 提到第一位, 重新部署即可.</p>
<p>在某些软件中会出现无法调出 fcitx 输入法的情况, 如 Telegram, 这时需要配置环境</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kate ~/.pam_environment</span><br></pre></td></tr></table></figure>
<p>在 <code>~/.pam_environment</code> 中写入</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GTK_IM_MODULE DEFAULT=fcitx</span><br><span class="line">QT_IM_MODULE  DEFAULT=fcitx</span><br><span class="line">XMODIFIERS    DEFAULT=\@im=fcitx</span><br></pre></td></tr></table></figure>
<p>重新登录 Arch 使环境生效. 我的皮肤是在<a href="https://github.com/winjeg/fcitx-skins">这里</a>进行选择以及安装的. 更多的配置需要查看 <a href="https://wiki.archlinux.org/title/Fcitx_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87">fcitx 的 Wiki</a>)</p>
<h6 id="我又换了-fcitx5"><a href="#我又换了-fcitx5" class="headerlink" title="我又换了 fcitx5"></a>我又换了 <code>fcitx5</code></h6><p>需要安装 <a href="https://archlinux.org/groups/x86_64/fcitx5-im/">fcitx5-im</a>, 及 <a href="https://archlinux.org/packages/community/x86_64/fcitx5-rime/">fcitx5-rime</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo pacman -S fcitx5-im fcitx5-rime</span><br></pre></td></tr></table></figure>
<p>然后将上文提到的 <code>rime</code> 文件夹放入 <code>~/.local/share/fcitx5/</code> 中, 覆盖其中的同名文件夹 <code>rime/</code>, 重新部署即可.<br>然后参照 <a href="https://wiki.archlinux.org/title/Fcitx5_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87">Wiki</a>#%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F) 中的内容, 在 <code>~/.pam_envionment</code> 中写入</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">GTK_IM_MODULE DEFAULT=fcitx</span><br><span class="line">QT_IM_MODULE  DEFAULT=fcitx</span><br><span class="line">XMODIFIERS    DEFAULT=\@im=fcitx</span><br><span class="line">INPUT_METHOD  DEFAULT=fcitx</span><br><span class="line">SDL_IM_MODULE DEFAULT=fcitx</span><br><span class="line">GLFW_IM_MODULE DEFAULT=ibus</span><br></pre></td></tr></table></figure>
<p>皮肤我在使用 <a href="https://aur.archlinux.org/packages/fcitx5-skin-material/">fcitx5-skin-material</a>, 使用 <code>yay -S fcitx5-skin-material</code> 即可安装, 安装后在 <code>~/.config/fcitx5/conf/classicui.conf</code> 中添加</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Theme=fcitx5-skin-material</span><br></pre></td></tr></table></figure>
<p>也可以在其中的 <code>Font</code> 选项处修改字体及字号. 如果想修改输入法为单行输入, 可以在 <code>~/.config/fcitx5/conf</code> 中新建 <code>rime.conf</code>, 并添加</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PreeditInApplication=True</span><br></pre></td></tr></table></figure>
<p>配置结束后要重启 <code>fcitx5</code> 来更新配置.</p>
<h5 id="vim"><a href="#vim" class="headerlink" title="vim"></a>vim</h5><p>暂时作为 vim 半吊子的存在. 先装插件 <a href="https://github.com/VundleVim/Vundle.vim">Vundle</a> 按着 <code>README.md</code> 中的操作安装即可. 然后配置一下 vim 与 fcitx5 的配合, 使得按下 <code>ESC</code> 返回 normal 模式时可以自动将输入法切换为英文, 再进入输入模式时自动切换为退出前的模式, 见仙子的 <a href="https://github.com/lilydjwg/fcitx.vim">fcitx.vim</a>, 解压到 <code>~/.vim</code> 中即可使用, 注意要将 <code>ttimeoutlen</code> 设置为较小的值, 如在 vim 中</p>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">:<span class="keyword">set</span> ttimeoutlen=<span class="number">100</span></span><br></pre></td></tr></table></figure>
<p>插件折腾挺热心, 软件倒没学咋样……</p>
<h5 id="KRunnner"><a href="#KRunnner" class="headerlink" title="KRunnner"></a>KRunnner</h5><p>还可以按照 <a href="https://wiki.archlinux.org/title/KRunner_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87">Wiki</a>) 的指示来配置一下 KRunner 的快捷键, 作为全局搜索来用.</p>
<h5 id="向日葵-Sunloginclient"><a href="#向日葵-Sunloginclient" class="headerlink" title="向日葵 Sunloginclient"></a>向日葵 Sunloginclient</h5><p>上文提到过安装后需要运行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">systemctl start runsunloginclient.service  </span><br></pre></td></tr></table></figure>
<p>开启向日葵服务, 如果需要远程操作 GNOME 的 Ubuntu 系统, 会显示”链接已中断”, 这时需要 Ubuntu 用户安装 <code>x11</code> 的桌面环境如 <code>lightdm</code>:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get upgrade</span><br><span class="line">sudo apt install lightdm</span><br></pre></td></tr></table></figure>
<p>安装后可以任意选择桌面环境, 也可以使用 <code>sudo dpkg-reconfigure lightdm</code> 与 <code>sudo dpkg-reconfigure gdm3</code> 来进行切换桌面环境, 注意在接受向日葵远程的时候需要保证处于 <code>lightdm</code> 环境下.<sup><a href="#fn_sunlogin" id="reffn_sunlogin">sunlogin</a></sup></p>
<blockquote id="fn_sunlogin">
<sup>sunlogin</sup>. 这里我也不太懂, 意思就是这个意思.<a href="#reffn_sunlogin" title="Jump back to footnote [sunlogin] in the text."> &#8617;</a>
</blockquote>
<h4 id="安装字体"><a href="#安装字体" class="headerlink" title="安装字体"></a>安装字体</h4><h5 id="解决系统默认字体显示效果差的问题"><a href="#解决系统默认字体显示效果差的问题" class="headerlink" title="解决系统默认字体显示效果差的问题"></a>解决系统默认字体显示效果差的问题</h5><p>照着这个博客弄就ok: <a href="https://szclsya.me/zh-cn/posts/fonts/linux-config-guide/">Linux 下的字体调教指南</a></p>
<h5 id="安装用户字体"><a href="#安装用户字体" class="headerlink" title="安装用户字体"></a>安装用户字体</h5><ol>
<li><p>Arch 的源中有一部分字体可以直接通过 <code>sudo pacman -S</code> 安装, 如</p>
<ol>
<li><a href="https://aur.archlinux.org/packages/noto-fonts-sc/">noto-fonts-sc</a>, 包含了 Google 打包的思源宋体 (Noto Serif CJK SC), 思源黑体 (Noto Sans CJK SC), 以及 Noto Mono CJK SC (这个我不知道怎么称呼, 我也没用过)</li>
<li><a href="https://archlinux.org/packages/community/any/ttf-sarasa-gothic/">ttf-sarasa-gothic</a>, 更纱黑体, 特点是中文宽度严格为英文的 2 倍, 适合用在代码环境, 其文件命名的介绍可以看 <a href="https://github.com/be5invis/Sarasa-Gothic#readme">README</a></li>
<li><a href="https://archlinux.org/packages/extra/any/noto-fonts-emoji/">noto-fonts-emoji</a> 提供了 emoji 表情. 这三款字体在上一小节中已经安装过了</li>
<li><a href="https://archlinux.org/packages/community/any/adobe-source-han-sans-cn-fonts/">adobe-source-han-sans-cn-fonts</a>, 由 Adobe 打包的思源黑体 (Source Han Sans CN), 由于我需要字形更多的 SC 版本, 故没有安装, <code>adobe-source-han-serif-cn-fonts</code> 同.</li>
<li><a href="https://archlinux.org/packages/community/any/adobe-source-han-serif-cn-fonts/">adobe-source-han-serif-cn-fonts</a>, 由 Adobe 打包的思源宋体 (Source Han Serif CN).</li>
</ol>
</li>
<li><p>AUR 源中的字体可以通过 <code>yay -S</code> 安装, 如</p>
<ol>
<li><a href="https://aur.archlinux.org/packages/ttf-lxgw-wenkai/">ttf-lxgw-wenkai</a>, 霞鹜文楷, 很不错的一款中文楷书, 它的介绍可以看 <a href="https://github.com/lxgw/LxgwWenKai#readme">README</a></li>
<li><a href="https://aur.archlinux.org/packages/nerd-fonts-fira-code/">nerd-fonts-fira-code</a>, 带图标的 Fira Code, 是一款不错的等宽字体, 字形介绍可以看 <a href="https://github.com/ryanoasis/nerd-fonts/tree/master/patched-fonts/FiraCode">README</a></li>
<li><a href="https://aur.archlinux.org/packages/otf-fira-code-git/"><del>otf-fira-code-git</del></a>, 不带图标的 Fira Code, 字形介绍可以看 <a href="https://github.com/tonsky/FiraCode#readme">README</a>. AUR 源中只有 <code>-git</code> 的版本, 关于软件包 <code>foo</code> 与 <code>foo-git</code> 的区别可以参考 <a href="https://wiki.archlinux.org/title/Arch_User_Repository_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87">Wiki</a>#foo<em>%E5%92%8C_foo-git</em>%E7%9A%84%E5%8C%BA%E5%88%AB%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F), 这个我没有编译成功, 可以直接去 <a href="https://github.com/tonsky/FiraCode/releases">Release</a> 处下载字体然后手动安装</li>
<li><a href="https://aur.archlinux.org/packages/nerd-fonts-jetbrains-mono/">nerd-fonts-jetbrains-mono</a>, JetBrains 提供的一款带图标的等宽字体, 适合用在终端</li>
</ol>
</li>
<li><p>手动安装字体: 这里以 <code>Fira Code</code> 为例. 在 <a href="https://github.com/tonsky/FiraCode/releases">Release</a> 处下载 <code>.zip</code> 文件, 解压到 <code>~/FiraCode</code> 文件夹, 将它复制/移动到系统字体文件夹 <code>/usr/share/fonts</code> 下, 也可以在 <code>/usr/share/fonts/</code> 下建立一个新的用户字体文件夹, 下面进行示例<sup><a href="#fn_3" id="reffn_3">3</a></sup></p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo mkdir /usr/share/fonts/myfonts</span><br><span class="line">sudo cp -r ~/FiraCode /usr/share/fonts/myfonts/</span><br></pre></td></tr></table></figure>
<p> 复制结束后可以删除 <code>~/FiraCode</code> 文件夹, 并在终端运行</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo fc-cache -fv</span><br></pre></td></tr></table></figure>
<p> 刷新字体缓存, 安装后可以在终端中运行</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">fc-list &gt; font.txt &amp;&amp; kate font.txt</span><br></pre></td></tr></table></figure>
<p> 在打开的 <code>font.txt</code> 文件中可以搜索来查看是否存在 <code>/myfonts</code> 路径下的 <code>FiraCode</code> 等字体, 下面列一些我没有找到软件包或者软件包编译不成功的字体, 这里只给出仓库地址, 不给出具体如何下载</p>
<ol>
<li><a href="https://github.com/tonsky/FiraCode">FiraCode</a></li>
<li><a href="https://github.com/adobe-fonts/source-han-serif/tree/release/OTF/SimplifiedChinese">Source Han Serif SC</a> Adobe 打包的思源宋体</li>
<li><a href="https://github.com/adobe-fonts/source-han-sans/tree/release/OTF/SimplifiedChinese">Source Han Sans SC</a> Adobe 打包的思源黑体</li>
</ol>
</li>
</ol>
<p><span id="win10fonts"> </span></p>
<h5 id="安装-Windows10-字体"><a href="#安装-Windows10-字体" class="headerlink" title="安装 Windows10 字体"></a>安装 Windows10 字体</h5><p><strong><em>安装 Windows 字体可能导致桌面环境字体混乱, 请自行甄别利弊</em></strong></p>
<p>由于版权原因, 不允许直接下载各 Windows 字体, 所以需要自己手动提取字体后, 用 <code>makepkg</code> 进行安装.</p>
<ol>
<li>先使用 <code>git clone</code> 将该 <a href="https://aur.archlinux.org/ttf-ms-win10.git">repo</a> 克隆到本地,</li>
<li>然后在<a href="https://www.microsoft.com/zh-cn/software-download/windows10">微软官网</a>下载 Windows10 的镜像, 并且按照 <a href="https://wiki.archlinux.org/title/Microsoft_fonts_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87">Wiki</a>#%E4%BB%8E<em>Windows_ISO</em>%E4%B8%AD%E6%8F%90%E5%8F%96%E5%AD%97%E4%BD%93) 使用 <code>7zip</code> 将 ISO 中的字体与许可证提取出来, 放到刚才克隆到本地的 <code>ttf-ms-win10</code> 文件夹中, 如果中途出现需要手动确认的项目, 选 <code>Y</code>,</li>
<li>终端在 <code>ttf-ms-win10</code> 中运行 <code>makepkg -si</code> 安装字体, 并运行 <code>fc-cache -fv</code> 刷新字体缓存, 安装后的字体位于 <code>/usr/share/fonts/TTF</code> 中,</li>
<li>如果想要在 LaTeX 的 ctex 宏集中使用 <code>fontset=windows</code> 选项的话, 还需要在 Windows 中复制 “黑体, 楷体, 微软雅黑, 隶书, 幼圆” 到 <code>/usr/share/fonts/TTF</code>, 并运行 <code>fc-cache -fv</code> 刷新缓存后即可使用.</li>
</ol>
<h3 id="暂时告一段落-再有什么东西再往上添吧"><a href="#暂时告一段落-再有什么东西再往上添吧" class="headerlink" title="暂时告一段落, 再有什么东西再往上添吧"></a>暂时告一段落, 再有什么东西再往上添吧</h3><blockquote id="fn_1">
<sup>1</sup>. 如果使用了不同版本的 vscode, 命令行唤起 vscode 的方式可能不同, 这时需要修改配置文件中的 <code>code</code> 为其他内容, 同时也要修改 okular 配置中命令中的 <code>code</code>. 如安装了 <code>vscodium-bin</code> 用户需要改为 <code>codium</code>, 具体可看 <a href="https://wiki.archlinux.org/title/Visual_Studio_Code_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87">Wiki</a>)<a href="#reffn_1" title="Jump back to footnote [1] in the text."> &#8617;</a>
</blockquote>
<blockquote id="fn_2">
<sup>2</sup>. 在使用正反向搜索功能时需要保证 <code>.synctex.gz</code> 文件的存在, 其生成的方式为: 编译时添加 <code>-synctex=1</code> 选项, 如使用 <code>pdflatex -synctex=1 main.tex</code> 编译<a href="#reffn_2" title="Jump back to footnote [2] in the text."> &#8617;</a>
</blockquote>
<blockquote id="fn_3">
<sup>3</sup>. 不必完全按照示例中的文件夹进行命名与放置, 只有 <code>/usr/share/fonts</code> 这个路径是必需的<a href="#reffn_3" title="Jump back to footnote [3] in the text."> &#8617;</a>
</blockquote>
]]></content>
      <categories>
        <category>配置记录</category>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>配置记录</tag>
        <tag>帮助文档</tag>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>beamer 的字体设置</title>
    <url>/2021-03-03-beamer-font-set/</url>
    <content><![CDATA[<p>在使用 <code>beamer</code> 文档类的时候, 可能会有需要更换字体. </p>
<span id="more"></span>
<p>如果按照 <code>article</code> 的方式设置正文字体:</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;beamer&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;amsmath, fontspec&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;frame&#125;</span><br><span class="line">    Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Utpurus elit, vestibulum ut, placerat ac, adipiscing vitae, felis.</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">\setmainfont</span>&#123;Fira Sans&#125;</span><br><span class="line">    Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Utpurus elit, vestibulum ut, placerat ac, adipiscing vitae, felis.</span><br><span class="line"><span class="keyword">\end</span>&#123;frame&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<p>会发现字体并没有发生变化</p>
<p><img src="https://pic4.zhimg.com/80/v2-a79642cc1fef73b11effa52b21dc02ca.png" alt=""></p>
<p>查阅 <code>texdoc beamer</code> 的 18.1 节会发现如果想使用其他字体, 需要设置 <code>\usefonttheme&#123;professionalfonts&#125;</code>, 但是添加了该命令后修改依旧失败. </p>
<p>在群里咨询后得知, <code>\setmainfont&#123;Fira Sans&#125;</code> 命令修改的字体为 <code>rmfamily</code>, 默认为衬线体. 所以要先将字体设置为衬线体 <code>\usefonttheme&#123;serif&#125;</code>, 再进行修改:</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;beamer&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;amsmath, fontspec&#125;</span><br><span class="line"><span class="keyword">\usefonttheme</span>&#123;serif&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;frame&#125;</span><br><span class="line">    Lorem ipsum dolor sit amet, consectetuer adipiscing elit. </span><br><span class="line">    Utpurus elit, vestibulum ut, placerat ac, adipiscing vitae, felis.</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">\setmainfont</span>&#123;Fira Sans&#125;</span><br><span class="line">    Lorem ipsum dolor sit amet, consectetuer adipiscing elit. </span><br><span class="line">    Utpurus elit, vestibulum ut, placerat ac, adipiscing vitae, felis.</span><br><span class="line"><span class="keyword">\end</span>&#123;frame&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://pic4.zhimg.com/80/v2-2078e554f7891d8ae674b0dd7d87a97b.png" alt=""></p>
<p>另外, 因为 <code>beamer</code> 文档类默认正文使用无衬线体, 于是也可以偷鸡地设置 <code>\setsansfont&#123;Fira Sans&#125;</code> 但是这样做会导致数学模式的 <code>\mathrm</code> 变成衬线体</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;beamer&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;amsmath&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;fontspec&#125;</span><br><span class="line"><span class="keyword">\setsansfont</span>&#123;Fira Sans&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;frame&#125;</span><br><span class="line">    Lorem ipsum dolor sit amet, consectetuer adipiscing elit.</span><br><span class="line">    Utpurus elit, vestibulum ut, placerat ac, adipiscing vitae, felis.</span><br><span class="line">    <span class="keyword">\[</span></span><br><span class="line">        <span class="keyword">\int</span><span class="built_in">_</span>&#123;0&#125;<span class="built_in">^</span>&#123;<span class="keyword">\pi</span>&#125;<span class="keyword">\sin</span> x<span class="keyword">\,</span><span class="keyword">\mathrm</span>&#123;d&#125;x=2 </span><br><span class="line">    <span class="keyword">\]</span></span><br><span class="line"><span class="keyword">\end</span>&#123;frame&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://pic4.zhimg.com/80/v2-94edf62ee34ec47955526aabbba5a438.png" alt=""></p>
<p>在 <code>texdoc fontspec</code> 中查找原因, 可以在 3.2 节 Maths fonts adjustments 中找到</p>
<p><img src="https://pic4.zhimg.com/80/v2-6ded00e03780caf7534fb7a3e5f7a9a9.png" alt=""></p>
<p>即在默认设置下, <code>fontspec</code> 宏包会将数学字体设置成 <code>Computer Modern</code>, 于是我们需要用 <code>no-math</code> 选项来阻止它, 同时 <code>\mathrm&#123;d&#125;</code> 也会调用 <code>rmfamily</code> 的字体, 我们将它改为 <code>\mathsf&#123;d&#125;</code>:</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;beamer&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;amsmath&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>[no-math]&#123;fontspec&#125;</span><br><span class="line"><span class="keyword">\setsansfont</span>&#123;Fira Sans&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;frame&#125;</span><br><span class="line">    Lorem ipsum dolor sit amet, consectetuer adipiscing elit.</span><br><span class="line">    Utpurus elit, vestibulum ut, placerat ac, adipiscing vitae, felis.</span><br><span class="line">    <span class="keyword">\[</span></span><br><span class="line">        <span class="keyword">\int</span><span class="built_in">_</span>&#123;0&#125;<span class="built_in">^</span>&#123;<span class="keyword">\pi</span>&#125;<span class="keyword">\sin</span> x<span class="keyword">\,</span><span class="keyword">\mathsf</span>&#123;d&#125;x=2</span><br><span class="line">    <span class="keyword">\]</span></span><br><span class="line"><span class="keyword">\end</span>&#123;frame&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<p>这个暂时不知道是什么原因导致的. 如果想正文和数学公式都使用 Fira 系列的字体, 同时保留衬线字体, 可以如下设置:<br><figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;beamer&#125;</span><br><span class="line"><span class="comment">% \usepackage[no-math]&#123;fontspec&#125;</span></span><br><span class="line"><span class="keyword">\usepackage</span>&#123;unicode-math&#125;</span><br><span class="line"><span class="keyword">\usefonttheme</span>&#123;serif&#125;</span><br><span class="line"><span class="comment">% \setsansfont&#123;Fira Sans&#125;</span></span><br><span class="line"><span class="keyword">\setmainfont</span>&#123;Fira Sans&#125;</span><br><span class="line"><span class="keyword">\setsansfont</span>&#123;CMU Serif&#125;</span><br><span class="line"><span class="keyword">\setmathfont</span>&#123;Fira Math&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line">    <span class="keyword">\begin</span>&#123;frame&#125;</span><br><span class="line">        Handgloves, <span class="built_in">$</span><span class="keyword">\sin</span><span class="built_in">$</span>, <span class="built_in">$</span><span class="keyword">\mathrm</span>&#123;Handgloves&#125;<span class="built_in">$</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">\textsf</span>&#123;this is CMU Serif&#125;</span><br><span class="line">    <span class="keyword">\end</span>&#123;frame&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure><br><img src="https://pic4.zhimg.com/80/v2-84d784c2f5396f6b2e529e0d7506b38d.png" alt=""></p>
<p>如果设置中文字体, 使用 <code>ctexbeamer</code> 文档类并设置 <code>\setCJK(main, sans, mono)font</code>, 类比上文即可. </p>
]]></content>
      <categories>
        <category>LaTeX</category>
        <category>字体</category>
      </categories>
      <tags>
        <tag>LaTeX</tag>
        <tag>字体设置</tag>
        <tag>示例</tag>
      </tags>
  </entry>
  <entry>
    <title>使用 KDE 桌面时遇到的一些问题</title>
    <url>/2021-09-22-KDEProblems/</url>
    <content><![CDATA[<p>这里记录一些使用 ArchLinux + KDE 时遇到的问题</p>
<span id="more"></span>
<h4 id="某些情况下快捷键失灵"><a href="#某些情况下快捷键失灵" class="headerlink" title="某些情况下快捷键失灵"></a>某些情况下快捷键失灵</h4><p>表现与这个<a href="https://forum.kde.org/viewtopic.php?f=17&amp;t=166079">帖子</a>一致, 解决方法在贴子中也已经提到, 即将 <code>~/.config/kglobalshortcutsrc</code> 重命名或删除, 在重新登录 KDE 的时候将会自动重新生成一个 <code>~/.config/kglobalshortcutsrc</code>, 并且问题解决.</p>
<h4 id="flameshot-延迟启动"><a href="#flameshot-延迟启动" class="headerlink" title="flameshot 延迟启动"></a><a href="https://github.com/flameshot-org/flameshot/issues/1916">flameshot 延迟启动</a></h4><p>老实说这个系统问题与 flameshot 没什么大关系, 但是我是通过它发现这个问题的……<br>KDE 桌面安装后使用<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">balooctl <span class="built_in">disable</span></span><br></pre></td></tr></table></figure><br>要关掉 <code>baloo</code> 服务, 这个东西没什么用, 建立索引的时候还会占用大量的 CPU. </p>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/ArchLinux/chat.png" alt="(重复利用图片)"></p>
<p>其他的桌面操作卡顿或延迟, 如终端中对命令的响应, 软件的启动与关闭也可能与其相关.</p>
<h4 id="桌面黑屏"><a href="#桌面黑屏" class="headerlink" title="桌面黑屏"></a>桌面黑屏</h4><p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/KDEProblems/black.png" alt=""></p>
<p>右键时不出现菜单, 新建文件夹也不显示, 需要重启 plasma, 在终端中运行</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">plasmashell --replace &amp;</span><br></pre></td></tr></table></figure>
<p>其他桌面环境的问题可以类似处理.</p>
<h4 id="桌面动画效果消失"><a href="#桌面动画效果消失" class="headerlink" title="桌面动画效果消失"></a>桌面动画效果消失</h4><p>首先尝试 <code>Alt+Shift+F12</code> 来打开”显示特效混合器”, 如果无效, 需要重启 kwin, 在终端中运行</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">kwin_x11 --replace &amp;</span><br></pre></td></tr></table></figure>
<h4 id="默认状态下按-Ctrl-Alt-F2-可以退出桌面进入终端-在终端中按-Ctrl-Alt-F1-可以返回桌面"><a href="#默认状态下按-Ctrl-Alt-F2-可以退出桌面进入终端-在终端中按-Ctrl-Alt-F1-可以返回桌面" class="headerlink" title="默认状态下按 Ctrl+Alt+F2 可以退出桌面进入终端, 在终端中按 Ctrl+Alt+F1 可以返回桌面"></a>默认状态下按 <code>Ctrl+Alt+F2</code> 可以退出桌面进入终端, 在终端中按 <code>Ctrl+Alt+F1</code> 可以返回桌面</h4><h4 id="桌面语言中英混合"><a href="#桌面语言中英混合" class="headerlink" title="桌面语言中英混合"></a>桌面语言中英混合</h4><p>首先在 <code>设置-&gt;区域设置-&gt;语言</code> 中查看是否添加了 <code>简体中文</code> </p>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/KDEProblems/language.png" alt=""></p>
<p>再查看 <code>设置-&gt;区域设置-&gt;格式</code> 中是否设置为了 <code>zh_CN</code></p>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/KDEProblems/region.png" alt=""></p>
<p>如果一致, 在终端中运行 <code>locale</code> 与 <code>locale -a</code> 查看其中的输出是否含有 <code>zh_CN.utf8</code> 及 <code>zh_CN.UTF-8</code>, 如否, 请参考 <a href="https://wiki.archlinux.org/title/Locale_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87">Wiki</a>#%E7%B3%BB%E7%BB%9F%E5%8C%BA%E5%9F%9F%E8%AE%BE%E7%BD%AE) 进行设置.</p>
<h4 id="安装-nvidia-驱动后字体变大"><a href="#安装-nvidia-驱动后字体变大" class="headerlink" title="安装 nvidia 驱动后字体变大"></a>安装 nvidia 驱动后字体变大</h4><p>首先发现在设置中“桌面特效”部分的部分特效缺失, 查找后发现这些特效被”排除不支持的特效”隐藏了</p>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/KDEProblems/screeneffect.png" alt="桌面特效"></p>
<p>可以通过安装 <a href="https://wiki.archlinux.org/title/NVIDIA_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87"><code>nvidia</code></a>#%E5%AE%89%E8%A3%85) 驱动来解决, 但是安装后有一个问题, 会发现所有的字体都变大了, 经过查找, 在 reddit 上找到了<a href="https://www.reddit.com/r/kde/comments/8ywniu/kde_plasma_everything_is_larger_after/">答案</a>, 即修改下图中的固定 DPI 为 96, 并重新登录.</p>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/KDEProblems/fontsize.png" alt="fontsize"></p>
<h4 id="音频处显示没有输入或输出设备"><a href="#音频处显示没有输入或输出设备" class="headerlink" title="音频处显示没有输入或输出设备"></a>音频处显示没有输入或输出设备</h4><p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/KDEProblems/no-sound.png" alt="没有输入或输出设备"></p>
<p>我的设备是 Dell G15 5511, 属于比较新的设备, 查看了 <a href="https://forum.manjaro.org/t/i-have-no-sound/86412">Fourm</a> 与 <a href="https://wiki.archlinux.org/title/Advanced_Linux_Sound_Architecture#ALSA_firmware">wiki</a> 后使用 </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yay -S sof-firmware</span><br></pre></td></tr></table></figure>
<p>安装框架之后即可使用.</p>
<h4 id="能连接上网络但是显示“受限的连接”"><a href="#能连接上网络但是显示“受限的连接”" class="headerlink" title="能连接上网络但是显示“受限的连接”"></a>能连接上网络但是显示“受限的连接”</h4><p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/KDEProblems/limit-connect.png" alt="受限的连接"></p>
<p>解决方法见 <a href="https://wiki.archlinux.org/title/NetworkManager#Checking_connectivity">Wiki</a></p>
]]></content>
      <categories>
        <category>配置记录</category>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>帮助文档</tag>
        <tag>Linux</tag>
        <tag>KDE</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows 不合法的缓存路径导致 TeX Live 安装失败</title>
    <url>/2021-04-07-illegal-temp-cause-tlinstall-failure/</url>
    <content><![CDATA[<p>在 Windows 上安装 TeX Live 时可能遇到由于缓存路径名称不合法, 即 <strong>不是纯英文的无空格的路径</strong>, 而安装错误的情况.</p>
<span id="more"></span>
<h3 id="错误"><a href="#错误" class="headerlink" title="错误"></a>错误</h3><p>在使用 GUI 界面安装时, 出现的错误形如下图</p>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/failuregui.jpg" alt=""></p>
<p>命令行安装时不会出现问题, 具体安装方法请查看啸行的<a href="http://mirrors.ctan.org/info/install-latex-guide-zh-cn/install-latex-guide-zh-cn.pdf">install-latex-guide-zh-cn</a></p>
<h3 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h3><p>这是因为 TeX Live 安装的时候需要使用环境变量 <code>TEMP</code> 与 <code>TMP</code> 来释放临时文件, 但是路径名不合法会导致调用失败.</p>
<h3 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h3><ol>
<li>永久修改 <code>TEMP</code> 与 <code>TMP</code> 环境变量的值. 知道了问题在哪就容易解决了, 首先 <code>右键此电脑→属性→高级系统设置→环境变量→用户环境变量</code> 找到 <code>TEMP</code> 与 <code>TMP</code>, 如果没有刻意设置的话其值应该都为</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">%USERPROFILE%\AppData\Local\Temp</span><br></pre></td></tr></table></figure>
<p>中文用户名便会导致 <code>%USERPROFILE%</code> 中含有无法识别的中文字符, 我们可以修改这个路径改为合法路径, 如</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">C:/Temp</span><br></pre></td></tr></table></figure>
<p>再启动安装程序即可安装成功.</p>
<ol>
<li>临时修改 <code>TEMP</code> 与 <code>TMP</code> 环境变量的值. 在 <code>cmd</code> 中执行</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkdir C:\temp</span><br><span class="line"><span class="built_in">set</span> TEMP=C:\temp</span><br><span class="line"><span class="built_in">set</span> TMP=C:\temp</span><br></pre></td></tr></table></figure>
<p>即可临时修改这两个环境变量的值, 然后继续在 <code>cmd</code> 中执行安装程序即可. 关闭 <code>cmd</code> 窗口时这两个环境变量将恢复为原始状态.</p>
<h3 id="另一些事情"><a href="#另一些事情" class="headerlink" title="另一些事情"></a>另一些事情</h3><p>在使用中发现中文的用户名还会影响到 <code>biber</code> 制作参考文献. 报错如下</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Process started: biber.exe &quot;main&quot;</span><br><span class="line"></span><br><span class="line">Use of uninitialized value in anonymous hash (&#123;&#125;) at C:\Users\凌霄\AppData\Local\Temp\par-c1e8cff6\cache-485d9ee7398586ce889a97f1d7a34ff027ca8881\inc\lib/Win32/Unicode/File.pm line 337. Odd number of elements in anonymous hash at C:\Users\凌霄\AppData\Local\Temp\par-c1e8cff6\cache-485d9ee7398586ce889a97f1d7a34ff027ca8881\inc\lib/Win32/Unicode/File.pm line 337.</span><br><span class="line">Empty String at C:\Users\凌霄\AppData\Local\Temp\par-c1e8cff6\cache-485d9ee7398586ce889a97f1d7a34ff027ca8881\inc\lib/Biber/LaTeX/Recode.pm line 116.</span><br><span class="line">INFO - This is Biber 2.16</span><br><span class="line">INFO - Logfile is &#x27;main.blg&#x27;</span><br><span class="line">Process exited with error(s)  </span><br></pre></td></tr></table></figure>
<p>这个问题同样可以通过修改环境变量 <code>%USERPROFILE%\AppData\Local\Temp</code> 来解决</p>
<h3 id="后续"><a href="#后续" class="headerlink" title="后续"></a>后续</h3><p>但是中文用户名带来的问题不仅仅是安装 TeX Live 失败. 所以最好可以拥有一个英文无空格的用户名, 首先最推荐的就是重装系统, 重新设置用户名. 如果无法或不愿重装系统, 可以尝试修改用户名, 但是<strong>直接修改用户名可能会导致严重的后果, 操作之前要做好数据备份以及心理准备</strong>, 下面放上可供参考的修改方法及知乎上的问题：</p>
<p><a href="http://www.xitongtiandi.net/wenzhang/win10/15351.html">可供参考的方法</a></p>
<p><a href="https://www.zhihu.com/question/37082172">知乎上的问题</a></p>
<p><a href="https://answers.microsoft.com/zh-hans/windows/forum/windows_10-other_settings/win10%E5%AE%B6%E5%BA%AD%E7%89%88%E5%A6%82%E4%BD%95/26e8cc30-97e4-434d-9d11-406b3d25e0d1">微软社区的技术支持1</a></p>
<p><a href="https://answers.microsoft.com/zh-hans/windows/forum/windows_10-security/win10%E5%A6%82%E4%BD%95%E8%83%BD%E5%A4%9F%E5%BD%BB/681b5ea9-7ba6-4860-bc9c-a3f59a2ee269">微软社区的技术支持2</a></p>
]]></content>
      <categories>
        <category>帮助文档</category>
        <category>LaTeX</category>
      </categories>
      <tags>
        <tag>帮助文档</tag>
        <tag>LaTeX</tag>
      </tags>
  </entry>
  <entry>
    <title>修复 Windows 坏掉的 EFI 引导</title>
    <url>/2021-09-02-RepairEFI/</url>
    <content><![CDATA[<p><strong><em>下次使用 <code>sudo</code> 之前一定确认好命令再执行</em></strong></p>
<p>因为半夜迷糊, 运行了<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo rm -rf /*</span><br></pre></td></tr></table></figure><br>来删除我某文件夹下的全部文件. 删到一半才反应过来我干了些什么, 看着崩坏的图形界面, 我只想回到 Windows, 把 Arch Linux 的分区格式化, 再重新安装, 但是我发现, 我已经把 Windows 的 EFI 引导破坏了……</p>
<span id="more"></span>
<p>感谢 <code>#archlinux-cn-offtopic</code> 群的 Xiao Jerry!</p>
<ol>
<li>准备好一个 Windows 10 的启动 U 盘, 在 BIOS 界面从 U 盘启动<br><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/RepairEFI/boot.jpg" alt="BOOT"></li>
<li>点击右下角: 修复计算机</li>
<li>进入命令行, 运行<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">bootrec /rebuildbcd</span><br></pre></td></tr></table></figure>
找到后用 <code>A</code> 添加<br><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/RepairEFI/bootrec.jpg" alt="扫描 Windows 安装"></li>
<li>添加后退出命令行, 点击启动修复<br><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/RepairEFI/startup-repair.jpg" alt="启动修复"></li>
<li>完成</li>
</ol>
]]></content>
      <categories>
        <category>帮助文档</category>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>帮助文档</tag>
        <tag>Windows</tag>
      </tags>
  </entry>
  <entry>
    <title>一种特殊的参考文献引用样式的设置</title>
    <url>/2021-10-02-extcite/</url>
    <content><![CDATA[<p>今天在群里得到了这样的一种引用格式的需求:</p>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/extcite/20211002163210.png" alt=""></p>
<p>下面使用两种方法来进行实现</p>
<span id="more"></span>
<p>以下是我用来测试的 <code>ref.bib</code> 文件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">@INPROCEEDINGS&#123;cnproceed,</span><br><span class="line">	author    = &#123;王重阳 and 黄药师 and 欧阳峰 and 洪七公 and 段皇帝&#125;,</span><br><span class="line">	title     = &#123;武林高手从入门到精通&#125;,</span><br><span class="line">	booktitle = &#123;第~$N$~次华山论剑&#125;,</span><br><span class="line">	year      = 2006,</span><br><span class="line">	address   = &#123;西安, 中国&#125;,</span><br><span class="line">	month     = sep,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@ARTICLE&#123;cnarticle,</span><br><span class="line">	AUTHOR  = &quot;贾宝玉 and 林黛玉 and 薛宝钗 and 贾探春&quot;,</span><br><span class="line">	TITLE   = &quot;论刘姥姥食量大如牛之现实意义&quot;,</span><br><span class="line">	JOURNAL = &quot;红楼梦杂谈&quot;,</span><br><span class="line">	PAGES   = &quot;260--266&quot;,</span><br><span class="line">	VOLUME  = &quot;224&quot;,</span><br><span class="line">	YEAR    = &quot;1800&quot;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@inbook&#123;Lin1992,</span><br><span class="line">	AUTHOR     = &quot;林来兴&quot;,</span><br><span class="line">	TITLE      = &quot;空间控制技术&quot;,</span><br><span class="line">	PUBLISHER  = &quot;宇航出版社&quot;,</span><br><span class="line">	YEAR       = &quot;1992&quot;,</span><br><span class="line">	Pages      = &quot;25-42&quot;,</span><br><span class="line">	ADDRESS    = &quot;北京&quot;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@book&#123;xin1994,</span><br><span class="line">	title=&#123;信息技术与信息服务国际研讨会论文集&#125;,</span><br><span class="line">	author=&#123;辛希孟 and 中国科学院文献信息中心 and 孟广均 and 信息学&#125;,</span><br><span class="line">	year=&#123;1994&#125;,</span><br><span class="line">	publisher=&#123;中国社会科学出版社&#125;,</span><br><span class="line">	pages=&#123;45-49&#125;,</span><br><span class="line">	address=&#123;北京&#125;,</span><br><span class="line">	typeoflit=&#123;C&#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@book&#123;zhao1998,</span><br><span class="line">	title=&#123;新时代的工业工程师&#125;,</span><br><span class="line">	author=&#123;赵耀东&#125;,</span><br><span class="line">	year=&#123;1998&#125;,</span><br><span class="line">	citedate =     &#123;1998-09-26&#125;,</span><br><span class="line">	address=&#123;台北&#125;,</span><br><span class="line">	publisher=&#123;天下文化出版社&#125;,</span><br><span class="line">	url=&#123;http://www.ie.nthu.edu.tw/info/ie.newie.htm(Big5)&#125;,</span><br><span class="line">	typeoflit=&#123;M/OL&#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@phdthesis&#123;Chen1992,</span><br><span class="line">	Author = &#123;谌颖&#125;,</span><br><span class="line">	Title = &#123;空间最优交会控制理论与方法研究&#125;,</span><br><span class="line">	ADDRESS    = &quot;哈尔滨&quot;,</span><br><span class="line">	School = &#123;哈尔滨工业大学&#125;,</span><br><span class="line">	Year = &#123;1992&#125;,</span><br><span class="line">	pages= &#123;8-13&#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@article&#123;hithesis2017,</span><br><span class="line">	title=&#123;Hi!Thesis!,Harbin Institue of Technology&#125;,</span><br><span class="line">	author=&#123;Yanshuo Chu&#125;,</span><br><span class="line">	journal=&#123;Github&#125;,</span><br><span class="line">	volume=&#123;001&#125;,</span><br><span class="line">	number=&#123;0001&#125;,</span><br><span class="line">	pages=&#123;000-999&#125;,</span><br><span class="line">	year=&#123;2017&#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="使用-cite-宏包"><a href="#使用-cite-宏包" class="headerlink" title="使用 cite 宏包"></a>使用 <code>cite</code> 宏包</h4><p>这种方法适合裸用各种 <code>\bibliographystyle</code> 的同学, 直接看代码</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;ctexart&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>[noadjust,super]&#123;cite&#125;</span><br><span class="line"><span class="comment">% texdoc cite : More Customization</span></span><br><span class="line"><span class="keyword">\renewcommand</span><span class="keyword">\citeform</span>[1]&#123;[<span class="params">#1</span>]&#125;</span><br><span class="line"><span class="keyword">\renewcommand</span>&#123;<span class="keyword">\citeleft</span>&#125;&#123;&#125;</span><br><span class="line"><span class="keyword">\renewcommand</span>&#123;<span class="keyword">\citeright</span>&#125;&#123;&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line">    text<span class="keyword">\cite</span>&#123;cnproceed,Chen1992,hithesis2017,zhao1998,xin1994,cnarticle&#125;</span><br><span class="line"></span><br><span class="line">    text<span class="keyword">\cite</span>&#123;Lin1992,xin1994&#125;</span><br><span class="line">    <span class="keyword">\bibliographystyle</span>&#123;plain&#125;</span><br><span class="line">    <span class="keyword">\bibliography</span>&#123;ref.bib&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/extcite/20211002165243.png" alt=""></p>
<h4 id="使用-natbib-宏包或-gbt7714-宏包"><a href="#使用-natbib-宏包或-gbt7714-宏包" class="headerlink" title="使用 natbib 宏包或 gbt7714 宏包"></a>使用 <code>natbib</code> 宏包或 <code>gbt7714</code> 宏包</h4><p>直接上代码</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;ctexart&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>[sort<span class="built_in">&amp;</span>compress,numbers,super]&#123;natbib&#125;</span><br><span class="line"><span class="keyword">\setcitestyle</span>&#123;open=&#123;&#125;,close=&#123;&#125;&#125;</span><br><span class="line"><span class="comment">% texdoc natbib : sec 2.12</span></span><br><span class="line"><span class="keyword">\renewcommand</span>&#123;<span class="keyword">\citenumfont</span>&#125;[1]&#123;[<span class="params">#1</span>]&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line">    text<span class="keyword">\cite</span>&#123;cnproceed,Chen1992,hithesis2017,zhao1998,xin1994,cnarticle&#125;</span><br><span class="line"></span><br><span class="line">    text<span class="keyword">\cite</span>&#123;Lin1992,xin1994&#125;</span><br><span class="line">    <span class="keyword">\bibliographystyle</span>&#123;plain&#125;</span><br><span class="line">    <span class="keyword">\bibliography</span>&#123;ref.bib&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/extcite/20211002165718.png" alt=""></p>
<p>当使用 <code>gbt7714</code> 宏包的时候, 需要把参数拆开, 实现效果如下</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;ctexart&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>[sort<span class="built_in">&amp;</span>compress]&#123;gbt7714&#125;</span><br><span class="line"><span class="keyword">\citestyle</span>&#123;super&#125;</span><br><span class="line"><span class="keyword">\setcitestyle</span>&#123;open=&#123;&#125;,close=&#123;&#125;&#125;</span><br><span class="line"><span class="comment">% texdoc natbib : sec 2.12</span></span><br><span class="line"><span class="keyword">\renewcommand</span>&#123;<span class="keyword">\citenumfont</span>&#125;[1]&#123;[<span class="params">#1</span>]&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line">    text<span class="keyword">\cite</span>&#123;cnproceed,Chen1992,hithesis2017,zhao1998,xin1994,cnarticle&#125;</span><br><span class="line"></span><br><span class="line">    text<span class="keyword">\cite</span>&#123;Lin1992,xin1994&#125;</span><br><span class="line">    <span class="keyword">\bibliographystyle</span>&#123;gbt7714-numerical&#125;</span><br><span class="line">    <span class="keyword">\bibliography</span>&#123;ref.bib&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/extcite/20211002165924.png" alt=""></p>
]]></content>
      <categories>
        <category>LaTeX</category>
        <category>参考文献</category>
      </categories>
      <tags>
        <tag>LaTeX</tag>
        <tag>示例</tag>
        <tag>参考文献</tag>
      </tags>
  </entry>
  <entry>
    <title>统计一节中的列表项数量</title>
    <url>/2021-11-10-compute-total-items/</url>
    <content><![CDATA[<p>在群里遇到一个需求: 使用 <code>ctexart</code> 文档类排版试卷, 使用 <code>enumerate</code> 环境生成题目并对题目计数, 希望在每个 <code>\section</code> 中显示”本节共xx题”, 并在目录中显示, 其中 xx 为该节中的一级列表环境中的 item 数量.</p>
<p>下面来进行实现.</p>
<span id="more"></span>
<p>根据我在 <a href="tex.stackexchange.com">tex.se</a> 上的 <a href="https://tex.stackexchange.com/q/622028/180617">提问</a> 进行修改:</p>
<h2 id="实现思路"><a href="#实现思路" class="headerlink" title="实现思路"></a>实现思路</h2><ol>
<li>使用计数器 <code>totalitems</code> 来统计每一节的 <code>\item</code> 的数量之和</li>
<li>在一节的末尾使用命令将这一节的 <code>totalitems</code> 的值输出到辅助文件 <code>main.aux</code></li>
<li>第二次编译的时候再在 <code>section</code> 中调用该计数器来显示题目的数量</li>
</ol>
<h2 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h2><p>我又傻了, 不需要写两个 <code>enumerate</code> 的判断, 直接在 <code>\item</code> 内部让它判断自己在不在第一层就好了, 修改重定义 <code>\item</code> 的部分为</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\RenewDocumentCommand</span>&#123;<span class="keyword">\item</span>&#125;&#123; s o &#125;&#123;</span><br><span class="line">      <span class="keyword">\IfNoValueTF</span>&#123;<span class="params">#2</span>&#125;&#123;<span class="keyword">\it@m</span>&#125;&#123;<span class="keyword">\it@m</span>[<span class="params">#2</span>]&#125;</span><br><span class="line">      <span class="keyword">\ifnum</span><span class="keyword">\enit@depth</span>=<span class="keyword">\@ne</span></span><br><span class="line">          <span class="keyword">\IfBooleanT</span>&#123;<span class="params">#1</span>&#125;&#123;<span class="keyword">\addtocounter</span>&#123;totalitems&#125;&#123;-1&#125;&#125;<span class="comment">%</span></span><br><span class="line">          <span class="keyword">\stepcounter</span>&#123;totalitems&#125;</span><br><span class="line">      <span class="keyword">\fi</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>然后注释掉 </p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\newif</span><span class="keyword">\ifenum</span></span><br><span class="line">...</span><br><span class="line"><span class="keyword">\LetLtxMacro</span>&#123;<span class="keyword">\@numerate</span>&#125;&#123;<span class="keyword">\enumerate</span>&#125;</span><br><span class="line"><span class="keyword">\LetLtxMacro</span>&#123;<span class="keyword">\end@numerate</span>&#125;&#123;<span class="keyword">\endenumerate</span>&#125;</span><br><span class="line">...</span><br><span class="line"><span class="keyword">\renewcommand</span>&#123;<span class="keyword">\enumerate</span>&#125;[1][]&#123;<span class="comment">%</span></span><br><span class="line">        <span class="keyword">\@numerate</span>[<span class="params">#1</span>]</span><br><span class="line">        <span class="keyword">\ifnum</span><span class="keyword">\enit@depth</span>=<span class="keyword">\@ne</span></span><br><span class="line">            <span class="keyword">\enumtrue</span></span><br><span class="line">        <span class="keyword">\else</span></span><br><span class="line">            <span class="keyword">\enumfalse</span></span><br><span class="line">        <span class="keyword">\fi</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">\renewcommand</span>&#123;<span class="keyword">\endenumerate</span>&#125;&#123;</span><br><span class="line">        <span class="keyword">\ifnum</span><span class="keyword">\enit@depth</span>=<span class="keyword">\@ne</span> </span><br><span class="line">            <span class="keyword">\enumfalse</span></span><br><span class="line">        <span class="keyword">\else</span></span><br><span class="line">            <span class="keyword">\enumtrue</span></span><br><span class="line">        <span class="keyword">\fi</span></span><br><span class="line">        <span class="keyword">\end@numerate</span><span class="comment">%</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>即可</p>
<h2 id="具体实现-新"><a href="#具体实现-新" class="headerlink" title="具体实现 (新)"></a>具体实现 (新)</h2><p>在发现了可以判断层级的命令后, 思路就可以打开了, 这次我们直接修改 <code>\item</code> 命令, 让第一层级内的 <code>\item</code> 进行记数, 然后再处理嵌套以及 <code>\item</code> 的参数问题. 我更喜欢这种方式.</p>
<ol>
<li><p>添加判断命令 <code>\ifenum</code> 来判断是否处于第一层级</p>
 <figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\newif</span><span class="keyword">\ifenum</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>这次我们只需要定义一个计数器</p>
 <figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\newcounter</span>&#123;totalitems&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>存储旧的 <code>enumerate</code> 环境以及 <code>\item</code> 命令</p>
 <figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\usepackage</span>&#123;letltxmacro&#125;</span><br><span class="line"><span class="keyword">\LetLtxMacro</span>&#123;<span class="keyword">\@numerate</span>&#125;&#123;<span class="keyword">\enumerate</span>&#125;</span><br><span class="line"><span class="keyword">\LetLtxMacro</span>&#123;<span class="keyword">\end@numerate</span>&#125;&#123;<span class="keyword">\endenumerate</span>&#125;</span><br><span class="line"><span class="keyword">\LetLtxMacro</span>&#123;<span class="keyword">\it@m</span>&#125;&#123;<span class="keyword">\item</span>&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>重定义 <code>\item</code> 命令, 使它具有以下功能: 如果使用 <code>\item*</code> 则不进行计数, 同时可以使用 <code>\item[para]</code> 来进行自定义序号, 如可以写 <code>\item[附加题]</code> 等等, 该功能默认计数, 如果不想计数也可以使用 <code>\item*[para]</code> 来取消计数. <strong>更新: 需要将 <code>\IfBooleanT</code> 放在 <code>\ifenum</code> 内部, 防止在非第一层级中误用 <code>\item*</code> 造成的计数错误</strong>:</p>
 <figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\DeclareDocumentCommand</span>&#123;<span class="keyword">\item</span>&#125;&#123; s o &#125;&#123;</span><br><span class="line">    <span class="keyword">\IfNoValueTF</span>&#123;<span class="params">#2</span>&#125;&#123;<span class="keyword">\it@m</span>&#125;&#123;<span class="keyword">\it@m</span>[<span class="params">#2</span>]&#125;</span><br><span class="line">    <span class="keyword">\ifenum</span></span><br><span class="line">        <span class="keyword">\IfBooleanT</span>&#123;<span class="params">#1</span>&#125;&#123;<span class="keyword">\addtocounter</span>&#123;totalitems&#125;&#123;-1&#125;&#125;<span class="comment">%</span></span><br><span class="line">        <span class="keyword">\stepcounter</span>&#123;totalitems&#125;</span><br><span class="line">    <span class="keyword">\fi</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>然后来确定什么时候打开和关闭判断的开关: 由于嵌套的存在, 我们需要在非第一层的环境开始时关闭 <code>\ifenum</code>, 并在非第一层的环境结束时开启 <code>\ifenum</code>. 如果出现了多层嵌套或者连续嵌套也不会影响, 因为 <code>\ifenum</code> 总会在非第一层环境的开始时被关闭:</p>
 <figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\renewcommand</span>&#123;<span class="keyword">\enumerate</span>&#125;[1][]&#123;<span class="comment">%</span></span><br><span class="line">    <span class="keyword">\@numerate</span>[<span class="params">#1</span>]</span><br><span class="line">    <span class="keyword">\ifnum</span><span class="keyword">\enit@depth</span>=<span class="keyword">\@ne</span></span><br><span class="line">        <span class="keyword">\enumtrue</span></span><br><span class="line">    <span class="keyword">\else</span></span><br><span class="line">        <span class="keyword">\enumfalse</span></span><br><span class="line">    <span class="keyword">\fi</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\renewcommand</span>&#123;<span class="keyword">\endenumerate</span>&#125;&#123;</span><br><span class="line">    <span class="keyword">\ifnum</span><span class="keyword">\enit@depth</span>=<span class="keyword">\@ne</span> </span><br><span class="line">        <span class="keyword">\enumfalse</span></span><br><span class="line">    <span class="keyword">\else</span></span><br><span class="line">        <span class="keyword">\enumtrue</span></span><br><span class="line">    <span class="keyword">\fi</span></span><br><span class="line">    <span class="keyword">\end@numerate</span><span class="comment">%</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在一节中题目结束的位置使用 <code>\exerend</code> 命令来将此时的 <code>totalitems</code> 的值输出到辅助文件, 写入为形如 <code>\gdef\totalenumi@i&#123;4&#125;</code> 的全局命令</p>
 <figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\def</span><span class="keyword">\exerend</span>&#123;</span><br><span class="line">    <span class="keyword">\immediate</span><span class="keyword">\write</span><span class="keyword">\@mainaux</span>&#123;<span class="comment">%</span></span><br><span class="line">        <span class="keyword">\string</span><span class="keyword">\gdef</span><span class="keyword">\string</span><span class="keyword">\totalenumi@</span><span class="keyword">\romannumeral</span><span class="comment">%</span></span><br><span class="line">        <span class="keyword">\csname</span> c@section<span class="keyword">\endcsname</span></span><br><span class="line">        &#123;<span class="keyword">\number</span><span class="keyword">\csname</span> c@totalitems<span class="keyword">\endcsname</span>&#125;</span><br><span class="line">    &#125;<span class="comment">%</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在每个 <code>\section</code> 开始的时候都将 <code>totalitems</code> 的值重置为 0</p>
 <figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\let</span><span class="keyword">\s@ction</span><span class="keyword">\section</span></span><br><span class="line"><span class="keyword">\def</span><span class="keyword">\section</span>&#123;</span><br><span class="line">    <span class="keyword">\setcounter</span>&#123;totalitems&#125;&#123;0&#125;<span class="keyword">\s@ction</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>定义输出总题数的命令 <code>\exer@sectoin&#123;&#125;</code>, 注意到在第一次编译的时候 <code>\totalenumi@i</code> 是没有定义的, 需要进行判断</p>
 <figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\def</span><span class="keyword">\exer@section</span><span class="params">#1</span>&#123;<span class="keyword">\@ifundefined</span>&#123;totalenumi@<span class="keyword">\romannumeral</span> <span class="params">#1</span>&#125;<span class="comment">%</span></span><br><span class="line">    &#123;0&#125;<span class="comment">%</span></span><br><span class="line">    &#123;<span class="keyword">\csname</span> totalenumi@<span class="keyword">\romannumeral</span> <span class="params">#1</span><span class="keyword">\endcsname</span>&#125;<span class="comment">%</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>定义输出总题数的命令:</p>
 <figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\def</span><span class="keyword">\outputexer</span>&#123;</span><br><span class="line">    (There <span class="keyword">\ifnum</span> <span class="keyword">\exer@section</span>&#123;<span class="keyword">\c@section</span>&#125;=0<span class="comment">%</span></span><br><span class="line">        is ??&#123;&#125; exercise<span class="comment">%</span></span><br><span class="line">    <span class="keyword">\else</span><span class="comment">%</span></span><br><span class="line">        <span class="keyword">\ifnum</span> <span class="keyword">\exer@section</span>&#123;<span class="keyword">\c@section</span>&#125;=1<span class="comment">%</span></span><br><span class="line">            is 1 exercise<span class="comment">%</span></span><br><span class="line">        <span class="keyword">\else</span><span class="comment">%</span></span><br><span class="line">            are <span class="keyword">\exer@section</span>&#123;<span class="keyword">\c@section</span>&#125; exercises<span class="comment">%</span></span><br><span class="line">        <span class="keyword">\fi</span><span class="comment">%</span></span><br><span class="line">    <span class="keyword">\fi</span>.)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> 由于英文中有 is 和 are 以及单复数的关系, 就需要多一层判断. 如果是中文的话, 连带着上一个命令可以直接写为</p>
 <figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\def</span><span class="keyword">\exer@sectionzh</span><span class="params">#1</span>&#123;<span class="comment">%</span></span><br><span class="line"><span class="keyword">\@ifundefined</span>&#123;totalenumi@<span class="keyword">\romannumeral</span> <span class="params">#1</span>&#125;<span class="comment">%</span></span><br><span class="line">    &#123;??&#125;<span class="comment">%</span></span><br><span class="line">    &#123;<span class="keyword">\csname</span> totalenumi@<span class="keyword">\romannumeral</span> <span class="params">#1</span><span class="keyword">\endcsname</span>&#125;<span class="comment">%</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\def</span><span class="keyword">\outputexerzh</span>&#123;<span class="comment">%</span></span><br><span class="line">    (本节共有 <span class="keyword">\exer@sectionzh</span>&#123;<span class="keyword">\c@section</span>&#125;题.)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="实例-新"><a href="#实例-新" class="headerlink" title="实例 (新)"></a>实例 (新)</h2><figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;ctexart&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;enumitem&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>[margin=2.5cm]&#123;geometry&#125;</span><br><span class="line"><span class="keyword">\makeatletter</span></span><br><span class="line"><span class="keyword">\newif</span><span class="keyword">\ifenum</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">\newcounter</span>&#123;totalitems&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;letltxmacro&#125;</span><br><span class="line"><span class="keyword">\LetLtxMacro</span>&#123;<span class="keyword">\@numerate</span>&#125;&#123;<span class="keyword">\enumerate</span>&#125;</span><br><span class="line"><span class="keyword">\LetLtxMacro</span>&#123;<span class="keyword">\end@numerate</span>&#125;&#123;<span class="keyword">\endenumerate</span>&#125;</span><br><span class="line"><span class="keyword">\LetLtxMacro</span>&#123;<span class="keyword">\it@m</span>&#125;&#123;<span class="keyword">\item</span>&#125;</span><br><span class="line"><span class="keyword">\DeclareDocumentCommand</span>&#123;<span class="keyword">\item</span>&#125;&#123; s o &#125;&#123;</span><br><span class="line">    <span class="keyword">\IfNoValueTF</span>&#123;<span class="params">#2</span>&#125;&#123;<span class="keyword">\it@m</span>&#125;&#123;<span class="keyword">\it@m</span>[<span class="params">#2</span>]&#125;</span><br><span class="line">    <span class="keyword">\ifenum</span></span><br><span class="line">        <span class="keyword">\IfBooleanT</span>&#123;<span class="params">#1</span>&#125;&#123;<span class="keyword">\addtocounter</span>&#123;totalitems&#125;&#123;-1&#125;&#125;<span class="comment">%</span></span><br><span class="line">        <span class="keyword">\stepcounter</span>&#123;totalitems&#125;</span><br><span class="line">    <span class="keyword">\fi</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\renewcommand</span>&#123;<span class="keyword">\enumerate</span>&#125;[1][]&#123;<span class="comment">%</span></span><br><span class="line">    <span class="keyword">\@numerate</span>[<span class="params">#1</span>]</span><br><span class="line">    <span class="keyword">\ifnum</span><span class="keyword">\enit@depth</span>=<span class="keyword">\@ne</span></span><br><span class="line">        <span class="keyword">\enumtrue</span></span><br><span class="line">    <span class="keyword">\else</span></span><br><span class="line">        <span class="keyword">\enumfalse</span></span><br><span class="line">    <span class="keyword">\fi</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\renewcommand</span>&#123;<span class="keyword">\endenumerate</span>&#125;&#123;</span><br><span class="line">    <span class="keyword">\ifnum</span><span class="keyword">\enit@depth</span>=<span class="keyword">\@ne</span> </span><br><span class="line">        <span class="keyword">\enumfalse</span></span><br><span class="line">    <span class="keyword">\else</span></span><br><span class="line">        <span class="keyword">\enumtrue</span></span><br><span class="line">    <span class="keyword">\fi</span></span><br><span class="line">    <span class="keyword">\end@numerate</span><span class="comment">%</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\def</span><span class="keyword">\exerend</span>&#123;</span><br><span class="line">    <span class="keyword">\immediate</span><span class="keyword">\write</span><span class="keyword">\@mainaux</span>&#123;<span class="comment">%</span></span><br><span class="line">        <span class="keyword">\string</span><span class="keyword">\gdef</span><span class="keyword">\string</span><span class="keyword">\totalenumi@</span><span class="keyword">\romannumeral</span><span class="comment">%</span></span><br><span class="line">        <span class="keyword">\csname</span> c@section<span class="keyword">\endcsname</span></span><br><span class="line">        &#123;<span class="keyword">\number</span><span class="keyword">\csname</span> c@totalitems<span class="keyword">\endcsname</span>&#125;</span><br><span class="line">    &#125;<span class="comment">%</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\let</span><span class="keyword">\s@ction</span><span class="keyword">\section</span></span><br><span class="line"><span class="keyword">\def</span><span class="keyword">\section</span>&#123;</span><br><span class="line">    <span class="keyword">\setcounter</span>&#123;totalitems&#125;&#123;0&#125;<span class="keyword">\s@ction</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\def</span><span class="keyword">\exer@section</span><span class="params">#1</span>&#123;<span class="keyword">\@ifundefined</span>&#123;totalenumi@<span class="keyword">\romannumeral</span> <span class="params">#1</span>&#125;<span class="comment">%</span></span><br><span class="line">    &#123;0&#125;<span class="comment">%</span></span><br><span class="line">    &#123;<span class="keyword">\csname</span> totalenumi@<span class="keyword">\romannumeral</span> <span class="params">#1</span><span class="keyword">\endcsname</span>&#125;<span class="comment">%</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\def</span><span class="keyword">\outputexer</span>&#123;</span><br><span class="line">    (There <span class="keyword">\ifnum</span> <span class="keyword">\exer@section</span>&#123;<span class="keyword">\c@section</span>&#125;=0<span class="comment">%</span></span><br><span class="line">        is ??&#123;&#125; exercise<span class="comment">%</span></span><br><span class="line">    <span class="keyword">\else</span><span class="comment">%</span></span><br><span class="line">        <span class="keyword">\ifnum</span> <span class="keyword">\exer@section</span>&#123;<span class="keyword">\c@section</span>&#125;=1<span class="comment">%</span></span><br><span class="line">            is 1 exercise<span class="comment">%</span></span><br><span class="line">        <span class="keyword">\else</span><span class="comment">%</span></span><br><span class="line">            are <span class="keyword">\exer@section</span>&#123;<span class="keyword">\c@section</span>&#125; exercises<span class="comment">%</span></span><br><span class="line">        <span class="keyword">\fi</span><span class="comment">%</span></span><br><span class="line">    <span class="keyword">\fi</span>.)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\def</span><span class="keyword">\exer@sectionzh</span><span class="params">#1</span>&#123;<span class="comment">%</span></span><br><span class="line"><span class="keyword">\@ifundefined</span>&#123;totalenumi@<span class="keyword">\romannumeral</span> <span class="params">#1</span>&#125;<span class="comment">%</span></span><br><span class="line">    &#123;??&#125;<span class="comment">%</span></span><br><span class="line">    &#123;<span class="keyword">\csname</span> totalenumi@<span class="keyword">\romannumeral</span> <span class="params">#1</span><span class="keyword">\endcsname</span>&#125;<span class="comment">%</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\def</span><span class="keyword">\outputexerzh</span>&#123;<span class="comment">%</span></span><br><span class="line">    (本节共有 <span class="keyword">\exer@sectionzh</span>&#123;<span class="keyword">\c@section</span>&#125;题.)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\makeatother</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"><span class="keyword">\tableofcontents</span></span><br><span class="line"><span class="keyword">\section</span>&#123;Optional, nested, and resume<span class="keyword">\outputexer</span>&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;</span><br><span class="line">    <span class="keyword">\item</span> test</span><br><span class="line">    <span class="keyword">\begin</span>&#123;enumerate&#125;</span><br><span class="line">        <span class="keyword">\item</span> this is the second level of enumerate</span><br><span class="line">        <span class="keyword">\begin</span>&#123;enumerate&#125;</span><br><span class="line">            <span class="keyword">\item</span> this is the third level of enumerate</span><br><span class="line">        <span class="keyword">\end</span>&#123;enumerate&#125;</span><br><span class="line">        <span class="keyword">\item</span>* this is a star verion in the second level, will do nothing</span><br><span class="line">    <span class="keyword">\end</span>&#123;enumerate&#125;</span><br><span class="line">    <span class="keyword">\item</span>[option] this is an optional paramater without star.</span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;[resume]</span><br><span class="line">    <span class="keyword">\item</span> this is a resume version</span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br><span class="line"><span class="keyword">\exerend</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">\section</span>&#123;带星号以及可选参数<span class="keyword">\outputexerzh</span>&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;</span><br><span class="line">    <span class="keyword">\item</span> test</span><br><span class="line">    <span class="keyword">\item</span>*[option] this is a star version with an optional paramater.</span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;</span><br><span class="line">    <span class="keyword">\item</span> test</span><br><span class="line">    <span class="keyword">\item</span>* this is a star version</span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br><span class="line"><span class="keyword">\exerend</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">\section</span>&#123;A regular enumerate&#125; </span><br><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;</span><br><span class="line">    <span class="keyword">\item</span> test</span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\section</span>&#123;A single item<span class="keyword">\outputexer</span>&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;</span><br><span class="line">    <span class="keyword">\item</span> just one item</span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br><span class="line"><span class="keyword">\exerend</span></span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<p>使用 <code>xelatex</code> 编译三次后可以输出</p>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/compute-total-items/new.png" alt="new output"></p>
<h2 id="具体实现-旧"><a href="#具体实现-旧" class="headerlink" title="具体实现 (旧)"></a>具体实现 (旧)</h2><ol>
<li><p>新定义计数器 <code>totalitems</code>, <code>itemsinenum</code>, <code>beginitems</code>, <code>enditems</code>. 分别用来存放: 一节中的所有 item 的数量, 一个 <code>enumerate</code> 环境中的 item 数量, <code>enumerate</code> 环境开始以及结束时的 <code>enumi</code> 的值.</p>
 <figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\newcounter</span>&#123;totalitems&#125;</span><br><span class="line"><span class="keyword">\newcounter</span>&#123;itemsinenum&#125;</span><br><span class="line"><span class="keyword">\newcounter</span>&#123;beginitems&#125;</span><br><span class="line"><span class="keyword">\newcounter</span>&#123;enditems&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>重新定义 <code>enumerate</code> 环境, 使其可以添加可选参数, 并且在开始与结束时记录 <code>enumi</code> 的值, 使用 <code>itemsinenum</code> 计数器来存储二者之差, 也就是当前环境中 item 的数量, 然后把这个数量添加到 <code>totalitems</code> 计数器中. 这里使用了 <code>\enit@depth</code> 命令来判断是否处于最高级的 <code>enumerate</code> 环境中</p>
 <figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\usepackage</span>&#123;letltxmacro&#125;</span><br><span class="line"><span class="keyword">\LetLtxMacro</span>&#123;<span class="keyword">\@numerate</span>&#125;&#123;<span class="keyword">\enumerate</span>&#125;</span><br><span class="line"><span class="keyword">\LetLtxMacro</span>&#123;<span class="keyword">\end@numerate</span>&#125;&#123;<span class="keyword">\endenumerate</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\renewcommand</span>&#123;<span class="keyword">\enumerate</span>&#125;[1][]&#123;<span class="comment">%</span></span><br><span class="line">    <span class="keyword">\@numerate</span>[<span class="params">#1</span>]</span><br><span class="line">    <span class="keyword">\ifnum</span><span class="keyword">\enit@depth</span>=<span class="keyword">\@ne</span> </span><br><span class="line">        <span class="keyword">\setcounter</span>&#123;beginitems&#125;&#123;<span class="keyword">\arabic</span>&#123;enumi&#125;&#125;</span><br><span class="line">    <span class="keyword">\fi</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\renewcommand</span>&#123;<span class="keyword">\endenumerate</span>&#125;&#123;</span><br><span class="line">    <span class="keyword">\ifnum</span><span class="keyword">\enit@depth</span>=<span class="keyword">\@ne</span> </span><br><span class="line">        <span class="keyword">\setcounter</span>&#123;enditems&#125;&#123;<span class="keyword">\arabic</span>&#123;enumi&#125;&#125;</span><br><span class="line">        <span class="keyword">\setcounter</span>&#123;itemsinenum&#125;&#123;<span class="keyword">\numexpr</span> <span class="keyword">\c@enditems</span> - <span class="keyword">\c@beginitems</span> <span class="keyword">\relax</span>&#125;</span><br><span class="line">        <span class="keyword">\addtocounter</span>&#123;totalitems&#125;&#123;<span class="keyword">\arabic</span>&#123;itemsinenum&#125;&#125;</span><br><span class="line">    <span class="keyword">\fi</span></span><br><span class="line">    <span class="keyword">\end@numerate</span><span class="comment">%</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>接下来就是记录题数, 输出题数的过程, 与上文相同, 这里不多赘述.</p>
</li>
</ol>
<h2 id="实例-旧"><a href="#实例-旧" class="headerlink" title="实例 (旧)"></a>实例 (旧)</h2><figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;ctexart&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;enumitem&#125;</span><br><span class="line"><span class="keyword">\makeatletter</span></span><br><span class="line"><span class="keyword">\newcounter</span>&#123;totalitems&#125;</span><br><span class="line"><span class="keyword">\newcounter</span>&#123;itemsinenum&#125;</span><br><span class="line"><span class="keyword">\newcounter</span>&#123;beginitems&#125;</span><br><span class="line"><span class="keyword">\newcounter</span>&#123;enditems&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\usepackage</span>&#123;letltxmacro&#125;</span><br><span class="line"><span class="keyword">\LetLtxMacro</span>&#123;<span class="keyword">\@numerate</span>&#125;&#123;<span class="keyword">\enumerate</span>&#125;</span><br><span class="line"><span class="keyword">\LetLtxMacro</span>&#123;<span class="keyword">\end@numerate</span>&#125;&#123;<span class="keyword">\endenumerate</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\renewcommand</span>&#123;<span class="keyword">\enumerate</span>&#125;[1][]&#123;<span class="comment">%</span></span><br><span class="line">    <span class="keyword">\@numerate</span>[<span class="params">#1</span>]</span><br><span class="line">    <span class="keyword">\ifnum</span><span class="keyword">\enit@depth</span>=<span class="keyword">\@ne</span> </span><br><span class="line">        <span class="keyword">\setcounter</span>&#123;beginitems&#125;&#123;<span class="keyword">\arabic</span>&#123;enumi&#125;&#125;</span><br><span class="line">    <span class="keyword">\fi</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\renewcommand</span>&#123;<span class="keyword">\endenumerate</span>&#125;&#123;</span><br><span class="line">    <span class="keyword">\ifnum</span><span class="keyword">\enit@depth</span>=<span class="keyword">\@ne</span> </span><br><span class="line">        <span class="keyword">\setcounter</span>&#123;enditems&#125;&#123;<span class="keyword">\arabic</span>&#123;enumi&#125;&#125;</span><br><span class="line">        <span class="keyword">\setcounter</span>&#123;itemsinenum&#125;&#123;<span class="keyword">\numexpr</span> <span class="keyword">\c@enditems</span> - <span class="keyword">\c@beginitems</span> <span class="keyword">\relax</span>&#125;</span><br><span class="line">        <span class="keyword">\addtocounter</span>&#123;totalitems&#125;&#123;<span class="keyword">\arabic</span>&#123;itemsinenum&#125;&#125;</span><br><span class="line">    <span class="keyword">\fi</span></span><br><span class="line">    <span class="keyword">\end@numerate</span><span class="comment">%</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\def</span><span class="keyword">\exerend</span>&#123;</span><br><span class="line">    <span class="keyword">\immediate</span><span class="keyword">\write</span><span class="keyword">\@mainaux</span>&#123;<span class="comment">%</span></span><br><span class="line">        <span class="keyword">\string</span><span class="keyword">\gdef</span><span class="keyword">\string</span><span class="keyword">\totalenumi@</span><span class="keyword">\romannumeral</span><span class="comment">%</span></span><br><span class="line">        <span class="keyword">\csname</span> c@section<span class="keyword">\endcsname</span></span><br><span class="line">        &#123;<span class="keyword">\number</span><span class="keyword">\csname</span> c@totalitems<span class="keyword">\endcsname</span>&#125;</span><br><span class="line">    &#125;<span class="comment">%</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\let</span><span class="keyword">\s@ction</span><span class="keyword">\section</span></span><br><span class="line"><span class="keyword">\def</span><span class="keyword">\section</span>&#123;</span><br><span class="line">    <span class="keyword">\setcounter</span>&#123;totalitems&#125;&#123;0&#125;<span class="keyword">\s@ction</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\def</span><span class="keyword">\exer@section</span><span class="params">#1</span>&#123;<span class="keyword">\@ifundefined</span>&#123;totalenumi@<span class="keyword">\romannumeral</span> <span class="params">#1</span>&#125;<span class="comment">%</span></span><br><span class="line">    &#123;0&#125;<span class="comment">%</span></span><br><span class="line">    &#123;<span class="keyword">\csname</span> totalenumi@<span class="keyword">\romannumeral</span> <span class="params">#1</span><span class="keyword">\endcsname</span>&#125;<span class="comment">%</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\def</span><span class="keyword">\outputexer</span>&#123;</span><br><span class="line">    (There <span class="keyword">\ifnum</span> <span class="keyword">\exer@section</span>&#123;<span class="keyword">\c@section</span>&#125;=0<span class="comment">%</span></span><br><span class="line">        is ??&#123;&#125; exercise<span class="comment">%</span></span><br><span class="line">    <span class="keyword">\else</span><span class="comment">%</span></span><br><span class="line">        <span class="keyword">\ifnum</span> <span class="keyword">\exer@section</span>&#123;<span class="keyword">\c@section</span>&#125;=1<span class="comment">%</span></span><br><span class="line">            is 1 exercise<span class="comment">%</span></span><br><span class="line">        <span class="keyword">\else</span><span class="comment">%</span></span><br><span class="line">            are <span class="keyword">\exer@section</span>&#123;<span class="keyword">\c@section</span>&#125; exercises<span class="comment">%</span></span><br><span class="line">        <span class="keyword">\fi</span><span class="comment">%</span></span><br><span class="line">    <span class="keyword">\fi</span>.)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\def</span><span class="keyword">\exer@sectionzh</span><span class="params">#1</span>&#123;<span class="comment">%</span></span><br><span class="line"><span class="keyword">\@ifundefined</span>&#123;totalenumi@<span class="keyword">\romannumeral</span> <span class="params">#1</span>&#125;<span class="comment">%</span></span><br><span class="line">    &#123;??&#125;<span class="comment">%</span></span><br><span class="line">    &#123;<span class="keyword">\csname</span> totalenumi@<span class="keyword">\romannumeral</span> <span class="params">#1</span><span class="keyword">\endcsname</span>&#125;<span class="comment">%</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\def</span><span class="keyword">\outputexerzh</span>&#123;<span class="comment">%</span></span><br><span class="line">    (本节共有 <span class="keyword">\exer@sectionzh</span>&#123;<span class="keyword">\c@section</span>&#125;题.)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\makeatother</span></span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"><span class="keyword">\tableofcontents</span></span><br><span class="line"><span class="keyword">\section</span>&#123;One<span class="keyword">\outputexer</span>&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;</span><br><span class="line">    <span class="keyword">\item</span> test</span><br><span class="line">    <span class="keyword">\begin</span>&#123;enumerate&#125;</span><br><span class="line">        <span class="keyword">\item</span> this is the second level of enumerate</span><br><span class="line">    <span class="keyword">\end</span>&#123;enumerate&#125;</span><br><span class="line">    <span class="keyword">\item</span> test</span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;[resume]</span><br><span class="line">    <span class="keyword">\item</span> test</span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br><span class="line"><span class="keyword">\exerend</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">\section</span>&#123;Two<span class="keyword">\outputexerzh</span>&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;[start=5]</span><br><span class="line">    <span class="keyword">\item</span> test</span><br><span class="line">    <span class="keyword">\item</span> test</span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;</span><br><span class="line">    <span class="keyword">\item</span> test</span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br><span class="line"><span class="keyword">\exerend</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">\section</span>&#123;No output&#125; </span><br><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;</span><br><span class="line">    <span class="keyword">\item</span> test</span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\section</span>&#123;Three<span class="keyword">\outputexer</span>&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;</span><br><span class="line">    <span class="keyword">\item</span> test</span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br><span class="line"><span class="keyword">\exerend</span></span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<p>三次 <code>xelatex</code> 编译后显示效果为</p>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/compute-total-items/20211111094748.png" alt="output"></p>
<h2 id="已知的问题"><a href="#已知的问题" class="headerlink" title="已知的问题"></a><del>已知的问题</del></h2><ol>
<li><p><del>当一节中出现带 <code>[resume]</code> 选项的 <code>enumerate</code> 环境的时候, <code>totalitems</code> 会将两个环境结束时的 <code>enumi</code> 值相加, 导致计数错误.</del> 已经支持添加 <code>[resume]</code>, <code>[start=]</code> 等可选参数</p>
</li>
<li><p><del>不支持嵌套</del>, 已使用 <code>\enit@depth</code> 命令来判断层级, 嵌套的问题被解决.</p>
</li>
</ol>
<h2 id="后续"><a href="#后续" class="headerlink" title="后续"></a>后续</h2><p>我在 <code>tex.se</code> 上还看到到了一种实现方式, 直接使用 <code>\label</code> 来进行辅助文件的输出, 这里是回答的<a href="https://tex.stackexchange.com/a/74617/180617">地址</a>, 这个方法局限性较大, 不采用</p>
<p>这个需求应该是结束了, 欢迎测试和评论 :&gt;</p>
]]></content>
      <categories>
        <category>LaTeX</category>
        <category>列表</category>
      </categories>
      <tags>
        <tag>LaTeX</tag>
        <tag>示例</tag>
        <tag>列表</tag>
      </tags>
  </entry>
  <entry>
    <title>备份博客内容</title>
    <url>/2021-11-18-backup-blogs/</url>
    <content><![CDATA[<p>在 <a href="https://ssayno.github.io">ssayno 的博客</a> 没备份挂了之后, 来写一个我备份博客的方法.</p>
<span id="more"></span>
<p>我们已经在 <a href="/2021-03-03-build-github-io/" title="搭建 github.io">搭建 github.io</a> 中介绍了如何搭建一个博客. 这里介绍把博客备份在 <a href="https://github.com">Github</a> 的方法, 包括备份在 <code>&lt;username&gt;.github.io</code> 的另一个分支, 以及备份在另外一个仓库中的方法, 两种方法大同小异.</p>
<h2 id="存放在-lt-username-gt-github-io-的另一个分支中"><a href="#存放在-lt-username-gt-github-io-的另一个分支中" class="headerlink" title="存放在 &lt;username&gt;.github.io 的另一个分支中"></a>存放在 <code>&lt;username&gt;.github.io</code> 的另一个分支中</h2><p>这是我个人选择的方法.</p>
<ol>
<li><p>在存储博客的文件夹 <code>hexotest</code> 中, 运行</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git init</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>来进行 git 仓库的初始化,</p>
<ol>
<li><p>由于默认状态下 <code>&lt;username&gt;.github.io</code> 的主分支 (<code>master</code>/<code>main</code>) 是用来部署 <code>github pages</code> 的, 于是我们新建一个分支, 比如名为 <code>hexo</code></p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git checkout -b hexo</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>此时我们新建了 <code>hexo</code> 分支并且切换到了该分支. </p>
<ol>
<li><p>跟踪所有文件, 添加 commit 信息:</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">&quot;commit message&quot;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>添加远程仓库的地址:</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git remote add origin git@github.com:&lt;username&gt;/&lt;username&gt;.github.io.git</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置默认上游分支并推送</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git push --set-upstream origin hexo</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>push</code> 成功后可以在 <code>&lt;username&gt;.github.io</code> 的 <code>hexo</code> 分支中查看到博客原文.</p>
</li>
</ol>
<h2 id="备份至另一个仓库"><a href="#备份至另一个仓库" class="headerlink" title="备份至另一个仓库"></a>备份至另一个仓库</h2><p>这个方法的好处是可以把博客内容设置为私有仓库, 在 <a href="https://github.com">Github</a> 上新建一个仓库, 这里设名字为 <code>post</code>, 由于不需要规避 <code>main</code> 分支<sup><a href="#fn_1" id="reffn_1">1</a></sup> 的内容, 我们就不需要新建分支, 直接</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">&quot;commit message&quot;</span></span><br></pre></td></tr></table></figure>
<p>再设置远程仓库</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git remote add origin git@github.com:&lt;username&gt;/post.git</span><br></pre></td></tr></table></figure>
<p>设置上游分支并推送</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git push --set-upstream origin main</span><br></pre></td></tr></table></figure>
<p>即可在 <code>post</code> 的主分支 <code>main</code> 中查看到博客原文.</p>
<blockquote id="fn_1">
<sup>1</sup>. 如果未经设置, 默认分支名为 <code>main</code>. 请自行查看新建仓库的默认分支名称<a href="#reffn_1" title="Jump back to footnote [1] in the text."> &#8617;</a>
</blockquote>
]]></content>
      <categories>
        <category>帮助文档</category>
        <category>blog</category>
      </categories>
      <tags>
        <tag>配置记录</tag>
        <tag>帮助文档</tag>
        <tag>hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>不定长, 自动换行且有定长下划线的“论文标题”</title>
    <url>/2021-08-04-thesis-title/</url>
    <content><![CDATA[<p>这篇文章的需求来源为 <a href="https://ask.latexstudio.net/ask/question/3650.html">LaTeX 问答站</a> 的一个问题, 经观察也是普遍遇到的模板设计者的问题. 主要需要达到下图的设计效果:</p>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/thesis-title/goal.png" alt=""></p>
<span id="more"></span>
<h3 id="设计难点"><a href="#设计难点" class="headerlink" title="设计难点"></a>设计难点</h3><p>可以看到设计难点有</p>
<ol>
<li>标题长度不固定, 可能需要自动换行</li>
<li>需要将定长的下划线全范围覆盖</li>
<li>(可选) 需要照顾到用户对自动换行点不满意, 而进行的手动换行</li>
<li>(可选) 由于单行标题与多行标题的视觉效果不同, 也避免第二行只有少量文字而造成的“不好的”观感进行额外的调整</li>
</ol>
<h3 id="尝试实现"><a href="#尝试实现" class="headerlink" title="尝试实现"></a>尝试实现</h3><p>这个问题要使用的基础工具肯定是<strong>表格</strong>, 因为除了标题还会有其他的文字同时需要对齐</p>
<h4 id="格线作为下划线"><a href="#格线作为下划线" class="headerlink" title="格线作为下划线"></a>格线作为下划线</h4><p>我在探究的过程中首先想使用定宽表格 + 下格线来实现这一点很快我就否定了这个想法, 因为</p>
<ol>
<li>定宽表格内部的换行无法添加下格线作为“下划线”</li>
<li>(次要) 定宽表格只能机械地自动换行, 无法手动换行</li>
</ol>
<h4 id="CJKunderline-自动处理"><a href="#CJKunderline-自动处理" class="headerlink" title="\CJKunderline 自动处理"></a><code>\CJKunderline</code> 自动处理</h4><p>否定了这个想法之后继续探究, 我想到了可以使用 <code>\CJKunderline</code> 命令<sup><a href="#fn_CJKunderline" id="reffn_CJKunderline">CJKunderline</a></sup>, 因为该下划线可以自动处理中文的换行, 把它应用在 <code>\parbox</code> 中进行一个嵌套应该可以</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;ctexart&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;xeCJKfntef&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line">    <span class="keyword">\parbox</span>&#123;13<span class="keyword">\ccwd</span>&#125;&#123;<span class="keyword">\centering</span><span class="keyword">\CJKunderline</span>&#123;这是一个很长的学位论文题目中华人民共和国刑法这是一个很长的学位论文&#125;&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/thesis-title/CJKunderline.png" alt=""></p>
<p>问题又出现了, 它无法将最后一行的下划线进行填充. 虽然可以在文本的末尾添加 <code>\hfill</code> 来延长下划线, 但是不居中了.</p>
<h3 id="最离谱的分割字符串"><a href="#最离谱的分割字符串" class="headerlink" title="最离谱的分割字符串"></a>最离谱的分割字符串</h3><p>接下来我想通过分割标题字符串, 然后对每一行的字符串单独使用下划线, 毕竟对于确定的字符串的操作就随意了, 然后再将它们套入 <code>\parbox</code> 就 ok 了, 然后我找到了 <a href="https://ctan.org/pkg/xstring"><code>xstring</code></a> 宏包来对标题进行长度记数与分隔, 然后我将这个想法在 <a href="https://tex.stackexchange.com/questions/609378/cut-string-into-pieces">TeX.SE</a> 进行了提问, 下面简单叙述一下</p>
<ol>
<li>使用 <code>\StrLen</code> 命令来确定标题的长度 <code>n</code></li>
<li>每行假定可放置 13 个字符, 那么就通过 <a href="https://ctan.org/pkg/xfp"><code>xfp</code></a> 提供的计算命令 <code>\fpeval</code> 计算标题被分隔的块数 <code>p = n/13</code> </li>
<li>然后通过 <a href="https://www.ctan.org/pkg/pgf"><code>tikz-pgf</code></a> 宏集提供的 <code>\foreach</code>命令来对块数 <code>p</code> 进行循环, 从而使每一行都具有定长的下划线而且居中</li>
</ol>
<p>但是在 <code>\fpeval</code> 计算的步骤就直接寄了, 会报<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">! You can&#x27;t use `\let&#x27; after \the.</span><br><span class="line">&lt;argument&gt; \let</span><br><span class="line"></span><br><span class="line">l.5     \fpeval&#123;\StrLen&#123;\abc&#125;/5&#125;</span><br><span class="line"></span><br><span class="line">?</span><br></pre></td></tr></table></figure></p>
<h3 id="可实现的方法"><a href="#可实现的方法" class="headerlink" title="可实现的方法"></a>可实现的方法</h3><h4 id="adjustbox-宏包"><a href="#adjustbox-宏包" class="headerlink" title="adjustbox 宏包"></a><code>adjustbox</code> 宏包</h4><p>然后 QQ 群LaTeX技术交流 1 群 (91940767) 中的行者 (qq:957114619) 根据上述问题的 <a href="https://tex.stackexchange.com/a/609433/180617">回答</a> 进行了整理, 发布到了 <a href="https://latexstudio.net/index/details/index/mid/1799.html">LaTeXStudio</a>. 这里进行一下备份</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="comment">% 本文来源:https://tex.stackexchange.com/questions/609378/cut-string-into-pieces,LaTeX技术交流 2 群(qq群号：478023327) 的“乙醇”网友（qq号：914920345）提供来源</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">\documentclass</span>[12pt]&#123;article&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;ctex&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;geometry&#125;</span><br><span class="line"><span class="keyword">\geometry</span>&#123;a4paper,height=225mm,width=156mm&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\usepackage</span>&#123;adjustbox&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">%\usepackage&#123;lipsum&#125;</span></span><br><span class="line"><span class="keyword">\usepackage</span>&#123;xurl&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;hyperref&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"><span class="keyword">\title</span>&#123;“固定列宽、内容居中、自动换行、且有下画线”效果的一种实现方法&#125;</span><br><span class="line"><span class="keyword">\author</span>&#123;zhangsming@foxmail.com&#125;</span><br><span class="line"><span class="keyword">\date</span>&#123;2021/08/04&#125;</span><br><span class="line"><span class="keyword">\maketitle</span></span><br><span class="line"></span><br><span class="line">本文是 <span class="keyword">\LaTeX</span> 工作室网站问答栏目“如何实现“固定列宽，自动换行且有下框线”问题（<span class="keyword">\url</span>&#123;<span class="link">https://ask.latexstudio.net/ask/question/3486.html</span>&#125;）的一种实现方法。</span><br><span class="line"></span><br><span class="line"><span class="comment">%\usepackage&#123;adjustbox&#125;</span></span><br><span class="line"><span class="keyword">\newlength</span><span class="keyword">\myheight</span></span><br><span class="line"><span class="keyword">\newcommand</span><span class="keyword">\Mysavedprevdepth</span>&#123;&#125;<span class="comment">%</span></span><br><span class="line"><span class="keyword">\newcommand</span><span class="keyword">\UnderlineCentered</span>[3]&#123;<span class="comment">%</span></span><br><span class="line">  <span class="keyword">\begin</span>&#123;adjustbox&#125;&#123;minipage=[t]&#123;<span class="keyword">\dimexpr</span><span class="params">#1</span><span class="keyword">\relax</span>&#125;,gstore totalheight=<span class="keyword">\myheight</span>,margin=0pt&#125;<span class="comment">%</span></span><br><span class="line">    <span class="keyword">\centering</span><span class="keyword">\leavevmode</span><span class="params">#3</span><span class="keyword">\par</span><span class="keyword">\xdef</span><span class="keyword">\Mysavedprevdepth</span>&#123;<span class="keyword">\the</span><span class="keyword">\prevdepth</span>&#125;<span class="comment">%</span></span><br><span class="line">  <span class="keyword">\end</span>&#123;adjustbox&#125;<span class="comment">%</span></span><br><span class="line">  <span class="keyword">\hspace</span>*&#123;-<span class="keyword">\dimexpr</span><span class="params">#1</span><span class="keyword">\relax</span>&#125;<span class="comment">%</span></span><br><span class="line">  <span class="keyword">\begin</span>&#123;adjustbox&#125;&#123;minipage=[t][<span class="keyword">\myheight</span>]&#123;<span class="keyword">\dimexpr</span><span class="params">#1</span><span class="keyword">\relax</span>&#125;,margin=0pt&#125;<span class="comment">%</span></span><br><span class="line">    <span class="keyword">\vphantom</span>&#123;Eg&#125;<span class="keyword">\lower</span><span class="keyword">\dimexpr</span><span class="params">#2</span><span class="keyword">\relax</span><span class="keyword">\hbox</span> to<span class="keyword">\hsize</span>&#123;<span class="keyword">\leaders</span><span class="keyword">\hrule</span><span class="keyword">\hfill</span><span class="keyword">\kern</span>0pt&#125;<span class="keyword">\par</span></span><br><span class="line">    <span class="keyword">\kern</span>-<span class="keyword">\dimexpr</span><span class="params">#2</span><span class="keyword">\relax</span></span><br><span class="line">    <span class="keyword">\xleaders</span><span class="keyword">\vbox</span> to<span class="keyword">\baselineskip</span> &#123;<span class="keyword">\vfill</span><span class="keyword">\hbox</span>&#123;<span class="keyword">\lower</span><span class="keyword">\dimexpr</span><span class="params">#2</span><span class="keyword">\relax</span><span class="keyword">\hbox</span> to<span class="keyword">\hsize</span>&#123;<span class="keyword">\leaders</span><span class="keyword">\hrule</span><span class="keyword">\hfill</span><span class="keyword">\kern</span>0pt&#125;&#125;<span class="keyword">\kern</span>-<span class="keyword">\dimexpr</span><span class="params">#2</span><span class="keyword">\relax</span>&#125;<span class="keyword">\vfill</span></span><br><span class="line">    <span class="keyword">\kern</span><span class="keyword">\Mysavedprevdepth</span></span><br><span class="line">  <span class="keyword">\end</span>&#123;adjustbox&#125;<span class="comment">%</span></span><br><span class="line">&#125;<span class="comment">%</span></span><br><span class="line"></span><br><span class="line">本文的主体代码来源于 StackExchange 网站“Cut string into pieces”问题（<span class="keyword">\url</span>&#123;<span class="link">https://tex.stackexchange.com/questions/609378/cut-string-into-pieces</span>&#125;）名为“Ulrich Diez”用户的回答。</span><br><span class="line"></span><br><span class="line"><span class="keyword">\bigskip</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;center&#125;</span><br><span class="line">  <span class="keyword">\begin</span>&#123;tabular&#125;&#123;rc&#125;</span><br><span class="line">    论文题目： <span class="built_in">&amp;</span> <span class="keyword">\UnderlineCentered</span>&#123;8cm&#125;&#123;1.5mm&#125;&#123;这是一个很长很长很长很长很长很长很长很长<span class="keyword">\\</span>很长很长很长很长很长很长很长很长的标题&#125;<span class="keyword">\\</span></span><br><span class="line">  <span class="keyword">\end</span>&#123;tabular&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;center&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\bigskip</span></span><br><span class="line"></span><br><span class="line">上列排版效果的代码使用了自定义的 UnderlineCentered 宏：</span><br><span class="line"></span><br><span class="line"><span class="keyword">\bigskip</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">\verb</span>|<span class="string">\UnderlineCentered&#123;&lt;文本宽度&gt;&#125;&#123;&lt;下画线深度&gt;&#125;&#123;&lt;文本内容&gt;&#125;</span>|</span><br><span class="line"></span><br><span class="line"><span class="keyword">\bigskip</span></span><br><span class="line"></span><br><span class="line">其中，<span class="keyword">\verb</span>|<span class="string">&lt;文本宽度&gt;</span>| 和 <span class="keyword">\verb</span>|<span class="string">&lt;下画线深度&gt;</span>| 的取值均为长度。上例中的代码是：</span><br><span class="line"></span><br><span class="line"><span class="keyword">\bigskip</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">\verb</span>|<span class="string">\UnderlineCentered&#123;8cm&#125;&#123;1.5mm&#125;&#123;这是一个很长...&#125;</span>|</span><br><span class="line"></span><br><span class="line"><span class="keyword">\bigskip</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">\verb</span>|<span class="string">\UnderlineCentered</span>| 主要使用 <span class="keyword">\verb</span>|<span class="string">adjustbox</span>| 宏包提供的 <span class="keyword">\verb</span>|<span class="string">adjustbox</span>| 定义，具体实现方式请查看本文源代码。</span><br><span class="line"></span><br><span class="line"><span class="keyword">\bigskip</span></span><br><span class="line"></span><br><span class="line">致谢：感谢 LaTeX技术交流 2 群(qq群号：478023327) 的“哈尔滨 - 乙醇”网友（qq号：914920345）提供代码来源。</span><br><span class="line"></span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<p>截取部分实现效果为<br><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/thesis-title/adjustbox.jpg" alt=""></p>
<p>可见, 该方法支持自动换行及手动换行, 满足了需求 1, 2, 3, 但是再进行观察可以发现第 4 行只有一个“题”字, 美观度不足, 但是瑕不掩瑜, 任务完成. </p>
<h4 id="rule-与文字分别排版"><a href="#rule-与文字分别排版" class="headerlink" title="\rule 与文字分别排版"></a><code>\rule</code> 与文字分别排版</h4><p>该方法来自于我的另一个 <a href="https://github.com/CTeX-org/forum/issues/208">Github</a> 上问题, 其中 <a href="https://github.com/muzimuzhi">慕子</a> 回答</p>
<blockquote>
<p>知乎文章《<a href="https://zhuanlan.zhihu.com/p/51494365">双语标题：LaTeX 实现</a>》 里有一个实现</p>
</blockquote>
<p>这个文章也是他写的, 可以完美实现我们的需求, 除了代码有点长（</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;ctexart&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;calc&#125;</span><br><span class="line"><span class="keyword">\makeatletter</span></span><br><span class="line"><span class="keyword">\renewcommand</span>&#123;<span class="keyword">\arraystretch</span>&#125;&#123;1.2&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">% inner temp length</span></span><br><span class="line"><span class="keyword">\newlength</span><span class="keyword">\@tempTitleHt</span></span><br><span class="line"><span class="keyword">\newlength</span><span class="keyword">\@tempTitleMaxWd</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% length used as parameters， &quot;Wd&quot; is a shorthand for &quot;Width&quot;</span></span><br><span class="line"><span class="keyword">\newlength</span><span class="keyword">\titleSingleLineMaxWd</span></span><br><span class="line"><span class="keyword">\newlength</span><span class="keyword">\titleMultiLineMaxWd</span></span><br><span class="line"><span class="keyword">\newlength</span><span class="keyword">\titleLRExtraWd</span></span><br><span class="line"><span class="keyword">\newlength</span><span class="keyword">\titleSepWd</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">\setlength</span><span class="keyword">\titleSingleLineMaxWd</span>&#123;0.6<span class="keyword">\textwidth</span>&#125;</span><br><span class="line"><span class="keyword">\setlength</span><span class="keyword">\titleMultiLineMaxWd</span>&#123;0.5<span class="keyword">\textwidth</span>&#125;</span><br><span class="line"><span class="keyword">\setlength</span><span class="keyword">\titleLRExtraWd</span>&#123;.5em&#125;</span><br><span class="line"><span class="keyword">\setlength</span><span class="keyword">\titleSepWd</span>&#123;.5em&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">% main macro, using a simple table</span></span><br><span class="line"><span class="comment">% \newcommand&#123;\multilingualTitles&#125;[2]&#123;%</span></span><br><span class="line"><span class="comment">%   \par</span></span><br><span class="line"><span class="comment">%   &#123;\noindent\centering</span></span><br><span class="line"><span class="comment">%   \begin&#123;tabular&#125;&#123;r @&#123;\hspace&#123;\titleSepWd&#125;&#125; p&#123;\titleSingleLineMaxWd&#125;&#125;</span></span><br><span class="line"><span class="comment">%   	中文标题           &amp; \titleBox&#123;#1&#125; \\</span></span><br><span class="line"><span class="comment">%   	                 &amp;               \\[-10pt]</span></span><br><span class="line"><span class="comment">%   	Title in English &amp; \titleBox&#123;#2&#125;</span></span><br><span class="line"><span class="comment">%   \end&#123;tabular&#125;\par&#125;%</span></span><br><span class="line"><span class="comment">% &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% draw a fixed-width underline</span></span><br><span class="line"><span class="keyword">\newcommand</span>&#123;<span class="keyword">\titleUnderline</span>&#125;&#123;<span class="comment">%</span></span><br><span class="line">  <span class="keyword">\rule</span>[-.3em]&#123;<span class="keyword">\titleSingleLineMaxWd</span> + 2<span class="keyword">\titleLRExtraWd</span>&#125;&#123;.5pt&#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">% title content typesetter</span></span><br><span class="line"><span class="keyword">\newcommand</span><span class="keyword">\titleBox</span>[1]&#123;<span class="comment">%</span></span><br><span class="line">  <span class="keyword">\setlength</span><span class="keyword">\@tempTitleMaxWd</span><span class="keyword">\titleSingleLineMaxWd</span></span><br><span class="line">  <span class="comment">% Measure the total height of #1 subject to \titleSingleLineMaxWd.</span></span><br><span class="line">  <span class="comment">% Here \@titleBox is necessary when #1 contains &quot;\\&quot;.</span></span><br><span class="line">  <span class="keyword">\settototalheight</span><span class="keyword">\@tempTitleHt</span>&#123;<span class="keyword">\@titleBox</span>&#123;<span class="params">#1</span>&#125;&#125;<span class="comment">%</span></span><br><span class="line">  <span class="keyword">\ifdim</span><span class="keyword">\@tempTitleHt</span>=0pt<span class="comment">%</span></span><br><span class="line">    <span class="comment">% case 1: #1 causes empty output</span></span><br><span class="line">    <span class="keyword">\titleUnderline</span></span><br><span class="line">  <span class="keyword">\else</span></span><br><span class="line">    <span class="comment">% Change to LR mode, for inserting a zero-width box right after.</span></span><br><span class="line">    <span class="keyword">\leavevmode</span></span><br><span class="line">    <span class="comment">% note: Use \normalbaseineskip instead of \baselineskip, </span></span><br><span class="line">    <span class="comment">%       since the latter is set to 0pt inside tabular env.</span></span><br><span class="line">    <span class="keyword">\ifdim</span><span class="keyword">\@tempTitleHt</span>&gt;<span class="keyword">\normalbaselineskip</span></span><br><span class="line">      <span class="comment">% case 2: #1 is fit for multilines, or contains `\\`, hence</span></span><br><span class="line">      <span class="comment">%         \titleMultiLineMaxWd is used instead, and the total </span></span><br><span class="line">      <span class="comment">%         height of #1 subject to new max width is re-measured.</span></span><br><span class="line">      <span class="keyword">\setlength</span><span class="keyword">\@tempTitleMaxWd</span><span class="keyword">\titleMultiLineMaxWd</span></span><br><span class="line">      <span class="keyword">\settototalheight</span><span class="keyword">\@tempTitleHt</span>&#123;<span class="keyword">\@titleBox</span>&#123;<span class="params">#1</span>&#125;&#125;<span class="comment">%</span></span><br><span class="line">      <span class="comment">% \rlap&#123;\smash&#123;...&#125;&#125; typesets content of its argument normally </span></span><br><span class="line">      <span class="comment">% but sets it into a zero sized box. Here \@titleBox set </span></span><br><span class="line">      <span class="comment">% (possiblly) multi-line text into a single box, since \smash </span></span><br><span class="line">      <span class="comment">% only takes in argument spreading one line.</span></span><br><span class="line">      <span class="comment">%</span></span><br><span class="line">      <span class="comment">% Every line of title content needs an underline, hense we do</span></span><br><span class="line">      <span class="comment">% a loop to typeset one underline for every line the title </span></span><br><span class="line">      <span class="comment">% content actually spreads.</span></span><br><span class="line">      <span class="keyword">\rlap</span>&#123;<span class="keyword">\smash</span>&#123;<span class="keyword">\@titleBox</span>&#123;<span class="comment">%</span></span><br><span class="line">        <span class="keyword">\@whiledim</span><span class="keyword">\@tempTitleHt</span>&gt;0pt<span class="comment">%</span></span><br><span class="line">        <span class="keyword">\leavevmode</span></span><br><span class="line">        <span class="comment">% </span></span><br><span class="line">        <span class="keyword">\do</span>&#123;<span class="comment">%</span></span><br><span class="line">          <span class="keyword">\rlap</span>&#123;<span class="keyword">\titleUnderline</span>&#125;<span class="keyword">\\</span><span class="comment">%</span></span><br><span class="line">          <span class="keyword">\addtolength</span><span class="keyword">\@tempTitleHt</span>&#123;-<span class="keyword">\normalbaselineskip</span>&#125;<span class="comment">%</span></span><br><span class="line">        &#125;<span class="comment">%</span></span><br><span class="line">      &#125;&#125;&#125;<span class="comment">%</span></span><br><span class="line">      <span class="comment">% Insert h-offset to manually center the title content.</span></span><br><span class="line">      <span class="keyword">\hspace</span>&#123;<span class="keyword">\dimexpr</span><span class="keyword">\titleLRExtraWd</span> + .5<span class="keyword">\titleSingleLineMaxWd</span> - .5<span class="keyword">\titleMultiLineMaxWd</span><span class="keyword">\relax</span>&#125;<span class="comment">%</span></span><br><span class="line">      <span class="keyword">\@titleBox</span>&#123;<span class="keyword">\centering</span> <span class="params">#1</span>&#125;<span class="comment">%</span></span><br><span class="line">    <span class="keyword">\else</span></span><br><span class="line">      <span class="comment">% case 3: #1 is fit for one line</span></span><br><span class="line">      <span class="keyword">\rlap</span>&#123;<span class="keyword">\titleUnderline</span>&#125;<span class="comment">%</span></span><br><span class="line">      <span class="keyword">\hspace</span>&#123;<span class="keyword">\titleLRExtraWd</span>&#125;<span class="comment">%</span></span><br><span class="line">      <span class="keyword">\@titleBox</span>&#123;<span class="keyword">\centering</span> <span class="params">#1</span>&#125;<span class="comment">%</span></span><br><span class="line">    <span class="keyword">\fi</span></span><br><span class="line">  <span class="keyword">\fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">% common operations on every title content</span></span><br><span class="line"><span class="keyword">\newcommand</span>&#123;<span class="keyword">\@titleBox</span>&#125;[1]&#123;<span class="comment">%</span></span><br><span class="line">  <span class="keyword">\parbox</span>[t]&#123;<span class="keyword">\@tempTitleMaxWd</span>&#125;&#123;<span class="params">#1</span>&#125;&#125;</span><br><span class="line"><span class="keyword">\makeatother</span></span><br><span class="line"><span class="keyword">\newlength</span>&#123;<span class="keyword">\lwtm</span>&#125;</span><br><span class="line"><span class="keyword">\setlength</span>&#123;<span class="keyword">\lwtm</span>&#125;&#123;<span class="keyword">\widthof</span>&#123;论文题目 :&#125;&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;tabular&#125;&#123;p&#123;<span class="keyword">\lwtm</span>&#125; p&#123;<span class="keyword">\titleSingleLineMaxWd</span>&#125;&#125;</span><br><span class="line">    <span class="keyword">\makebox</span>[<span class="keyword">\lwtm</span>][s]&#123;论文题目 :&#125;           <span class="built_in">&amp;</span> <span class="keyword">\titleBox</span>&#123;这是一个很长的学位论文题目中华人民共和国刑法这是一个&#125; <span class="keyword">\\</span></span><br><span class="line">    <span class="keyword">\makebox</span>[<span class="keyword">\lwtm</span>][s]&#123;论文题目 :&#125;           <span class="built_in">&amp;</span> <span class="keyword">\titleBox</span>&#123;这是一个很长的学位论文题目中华人民共和&#125; <span class="keyword">\\</span></span><br><span class="line">    <span class="keyword">\makebox</span>[<span class="keyword">\lwtm</span>][s]&#123;论文题目 :&#125;           <span class="built_in">&amp;</span> <span class="keyword">\titleBox</span>&#123;这是一个很长的学位论文题目中华人民共和国&#125; <span class="keyword">\\</span></span><br><span class="line">    <span class="keyword">\makebox</span>[<span class="keyword">\lwtm</span>][s]&#123;论文题目 :&#125;           <span class="built_in">&amp;</span> <span class="keyword">\titleBox</span>&#123;这是一个很长的学位论文题目<span class="keyword">\\</span>中华人民共和国刑法这是一个&#125; <span class="keyword">\\</span></span><br><span class="line">                                            <span class="built_in">&amp;</span>               <span class="keyword">\\</span>[-10pt] <span class="comment">% 用于分隔题目与其他信息</span></span><br><span class="line">    <span class="keyword">\makebox</span>[<span class="keyword">\lwtm</span>][s]&#123;培养单位 :&#125;           <span class="built_in">&amp;</span>    <span class="keyword">\titleBox</span>&#123;厚大法考&#125;          <span class="keyword">\\</span></span><br><span class="line">    <span class="keyword">\makebox</span>[<span class="keyword">\lwtm</span>][s]&#123;专业 :&#125;               <span class="built_in">&amp;</span>   <span class="keyword">\titleBox</span>&#123;法学&#125;<span class="keyword">\\</span></span><br><span class="line">    <span class="keyword">\makebox</span>[<span class="keyword">\lwtm</span>][s]&#123;导师 :&#125;               <span class="built_in">&amp;</span>   <span class="keyword">\titleBox</span>&#123;罗翔&#125; <span class="keyword">\\</span></span><br><span class="line">    <span class="keyword">\makebox</span>[<span class="keyword">\lwtm</span>][s]&#123;研究生 :&#125;              <span class="built_in">&amp;</span>  <span class="keyword">\titleBox</span>&#123;张三&#125; <span class="keyword">\\</span></span><br><span class="line">    <span class="keyword">\makebox</span>[<span class="keyword">\lwtm</span>][s]&#123;完成时间 :&#125;            <span class="built_in">&amp;</span>  <span class="keyword">\titleBox</span>&#123;2003.8&#125; <span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\end</span>&#123;tabular&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<p>该代码中含有大量的注释, 使我能在很短的时间内 (指一上午) 读完代码并且了解操作原理, 下面是实现效果<br><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/thesis-title/muzimuzhi.jpg" alt=""></p>
<p>可以看到, 第二个“论文题目”中单行中的文字比多第三个中的多行文字只少了一个“国”字但是它可以自动换行并且制造一个良好的视觉效果, 代码的关键在于</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="comment">% 设定不同的单行与多行的最大行长度</span></span><br><span class="line"><span class="keyword">\newlength</span><span class="keyword">\titleSingleLineMaxWd</span></span><br><span class="line"><span class="keyword">\newlength</span><span class="keyword">\titleMultiLineMaxWd</span></span><br><span class="line">...</span><br><span class="line"><span class="keyword">\setlength</span><span class="keyword">\titleSingleLineMaxWd</span>&#123;0.6<span class="keyword">\textwidth</span>&#125;</span><br><span class="line"><span class="keyword">\setlength</span><span class="keyword">\titleMultiLineMaxWd</span>&#123;0.5<span class="keyword">\textwidth</span>&#125;</span><br><span class="line">...</span><br><span class="line"><span class="comment">% 将文本内容放入单行长度相当的 \parbox 中, </span></span><br><span class="line"><span class="comment">% 判断其能否用单行进行排版, </span></span><br><span class="line"><span class="comment">% 如果不能, 将使用多行的最大行长相当的 \parbox 进行排版, </span></span><br><span class="line"><span class="comment">% 这样就不会出现第二行之后 1 个或 2 个字的情况</span></span><br><span class="line"><span class="keyword">\newcommand</span>&#123;<span class="keyword">\@titleBox</span>&#125;[1]&#123;<span class="comment">%</span></span><br><span class="line">  <span class="keyword">\parbox</span>[t]&#123;<span class="keyword">\@tempTitleMaxWd</span>&#125;&#123;<span class="params">#1</span>&#125;&#125;</span><br></pre></td></tr></table></figure>
<h3 id="任务完成"><a href="#任务完成" class="headerlink" title="任务完成"></a>任务完成</h3><p>先放松一下, 有更好的方法可以评论, 我会进行补充. </p>
<blockquote id="fn_CJKunderline">
<sup>CJKunderline</sup>. 该命令由宏集 <a href="https://ctan.org/pkg/xecjk"><code>xeCJK</code></a> 中宏包 <code>xeCJKfntef</code> 提供 <a href="#reffn_CJKunderline" title="Jump back to footnote [CJKunderline] in the text."> &#8617;</a>
</blockquote>
]]></content>
      <categories>
        <category>LaTeX</category>
        <category>模板</category>
      </categories>
      <tags>
        <tag>LaTeX</tag>
        <tag>排版设计</tag>
      </tags>
  </entry>
  <entry>
    <title>libertinus 字体与 extarrows 不兼容的处理</title>
    <url>/2021-11-27-extarrows-and-libertinus/</url>
    <content><![CDATA[<p>与群友交流的过程中发现如果将数学字体设置为 <code>Libertinus Math</code> 的时候, 使用 <code>extarrow</code> 宏包的 <code>\xLongrightarrow</code> 会有奇怪的现象:</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;article&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;amsmath&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;extarrows&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;unicode-math&#125;</span><br><span class="line"><span class="keyword">\setmathfont</span>&#123;Libertinus Math&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line">    <span class="keyword">\begin</span>&#123;align*&#125;</span><br><span class="line">        <span class="keyword">\xLongrightarrow</span>&#123;a<span class="built_in">^</span>2+b<span class="built_in">^</span>2=c<span class="built_in">^</span>2&#125; </span><br><span class="line">    <span class="keyword">\end</span>&#123;align*&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/extarrows-and-libertinus/wrongoutput.png" alt="错误输出"></p>
<span id="more"></span>
<p>开始我以为是 <code>unicode-math</code> 与 <code>extarrows</code> 不兼容, 但是当我将字体设置成 <code>STIX Two Math</code> 或者默认的 <code>Latin Modern Math</code> 的时候发现并不是 <code>unicode-math</code> 的问题:</p>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/extarrows-and-libertinus/compare.png" alt="对比"></p>
<p>那就需要看看源码, 找一下有没有能改的地方. </p>
<p>首先找了一下 <code>extarrow.sty</code> 的源码, 看不太懂</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\RequirePackage</span>&#123;amsmath&#125;</span><br><span class="line">...</span><br><span class="line"><span class="keyword">\def</span><span class="keyword">\xLongrightarrowfill@</span>&#123;<span class="keyword">\arrowfill@</span><span class="keyword">\Relbar</span><span class="keyword">\Relbar</span><span class="keyword">\Longrightarrow</span>&#125;</span><br><span class="line"><span class="keyword">\providecommand</span>&#123;<span class="keyword">\xLongrightarrow</span>&#125;[2][]&#123;<span class="comment">%</span></span><br><span class="line">	<span class="keyword">\ext@arrow</span> 0099<span class="keyword">\xLongrightarrowfill@</span>&#123;<span class="params">#1</span>&#125;&#123;<span class="params">#2</span>&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>但是发现了两个没有定义就直接使用的命令: <code>\arrowfill@</code> 与 <code>\Relbar</code>, 那就应该是 <code>amsmath</code> 定义的命令, 顺藤摸瓜再去找一下. </p>
<p>在 <code>amsmath.sty</code> 中发现了</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\ams@def</span><span class="keyword">\relbar</span>&#123;<span class="keyword">\mathrel</span>&#123;<span class="keyword">\mathpalette</span><span class="keyword">\mathsm@sh</span><span class="keyword">\std@minus</span>&#125;&#125;</span><br><span class="line"><span class="keyword">\ams@def</span><span class="keyword">\Relbar</span>&#123;<span class="keyword">\mathrel</span><span class="keyword">\std@equal</span>&#125;</span><br><span class="line"><span class="keyword">\def</span><span class="keyword">\arrowfill@</span><span class="params">#1</span><span class="params">#2</span><span class="params">#3</span><span class="params">#4</span>&#123;<span class="comment">%</span></span><br><span class="line">  <span class="built_in">$</span><span class="keyword">\m@th</span><span class="keyword">\thickmuskip</span>0mu<span class="keyword">\medmuskip</span><span class="keyword">\thickmuskip</span><span class="keyword">\thinmuskip</span><span class="keyword">\thickmuskip</span></span><br><span class="line">   <span class="keyword">\relax</span><span class="params">#4</span><span class="params">#1</span><span class="keyword">\mkern</span>-7mu<span class="comment">%</span></span><br><span class="line">   <span class="keyword">\cleaders</span><span class="keyword">\hbox</span>&#123;<span class="built_in">$</span><span class="params">#4</span><span class="keyword">\mkern</span>-2mu<span class="params">#2</span><span class="keyword">\mkern</span>-2mu<span class="built_in">$</span>&#125;<span class="keyword">\hfill</span></span><br><span class="line">   <span class="keyword">\mkern</span>-7mu<span class="params">#3</span><span class="built_in">$</span><span class="comment">%</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>依然看不懂, 再顺着 <code>\Relbar</code> 定义中的 <code>\std@equal</code> 寻找, 找到了这两行</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\@ifundefined</span>&#123;Umathcode&#125;</span><br><span class="line">  &#123;<span class="comment">%</span></span><br><span class="line">    <span class="keyword">\mathchardef</span><span class="keyword">\std@minus</span><span class="keyword">\mathcode</span>`<span class="keyword">\-</span><span class="keyword">\relax</span></span><br><span class="line">    <span class="keyword">\mathchardef</span><span class="keyword">\std@equal</span><span class="keyword">\mathcode</span>`<span class="keyword">\=</span><span class="keyword">\relax</span></span><br><span class="line">  &#125;</span><br><span class="line">  &#123;<span class="comment">%</span></span><br><span class="line">   <span class="keyword">\Umathcharnumdef</span><span class="keyword">\std@minus</span><span class="keyword">\Umathcodenum</span>`<span class="keyword">\-</span><span class="keyword">\relax</span></span><br><span class="line">   <span class="keyword">\Umathcharnumdef</span><span class="keyword">\std@equal</span><span class="keyword">\Umathcodenum</span>`<span class="keyword">\=</span><span class="keyword">\relax</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>那就可以知道 <code>extarrows</code> 与 <code>\overline</code> 等命令的实现方法了: 用 <code>\longright/leftarrow</code> 与 <code>\Longright/leftarrow</code> 与减号 <code>-</code> 或者等号 <code>=</code> 进行拼接. </p>
<p>猜出了原理, 用 <code>Libertinus Math</code> 进行一下验证:</p>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/extarrows-and-libertinus/equalandarrow.png" alt="= 与 `\Longrightarrow`"></p>
<p>确实等号与 <code>\Longrightarrow</code> 两横之间的间距不同, 也就导致了奇怪的效果. </p>
<p>知道了问题的话就容易解决了, 直接用其他的字体来替换箭头与等号就可以了<sup><a href="#fn_1" id="reffn_1">1</a></sup> .</p>
<blockquote id="fn_1">
<sup>1</sup>. 不知道直接画一个与箭头的间距相等的等号可不可行. <a href="#reffn_1" title="Jump back to footnote [1] in the text."> &#8617;</a>
</blockquote>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;article&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;amsmath&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;extarrows&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;unicode-math&#125;</span><br><span class="line"><span class="keyword">\setmathfont</span>&#123;Libertinus Math&#125;</span><br><span class="line"><span class="keyword">\setmathfont</span>&#123;STIX Two Math&#125;[range = &#123;<span class="keyword">\Longleftarrow</span>, <span class="keyword">\Longrightarrow</span>, <span class="keyword">\equal</span>&#125;]</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;align*&#125;</span><br><span class="line">    <span class="keyword">\xLongleftrightarrow</span>&#123;a<span class="built_in">^</span>2-b<span class="built_in">^</span>2=c<span class="built_in">^</span>2&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;align*&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/extarrows-and-libertinus/right.png" alt=""></p>
<p><code>\Longrightarrow</code> 的问题解决了, 但是出现了新的问题, 在 <code>Latin Modern Math</code> 与 <code>STIX Two Math</code> 中的减号 <code>-</code> 与箭头 <code>\longrightarrow</code> 的粗细或者垂直位置不一致, 这会导致 <code>\xlong</code> 系列的箭头变得奇怪, 所以只是这么处理的话会导致箭头风格不统一. 如果不重制 <code>\Relbar</code> 与 <code>\relbar</code> 的话, 那就祈祷文章种不要同时出现两种箭头吧……</p>
]]></content>
      <categories>
        <category>LaTeX</category>
        <category>unicode-math</category>
      </categories>
      <tags>
        <tag>LaTeX</tag>
        <tag>示例</tag>
        <tag>unicode-math</tag>
      </tags>
  </entry>
  <entry>
    <title>enumitem 宏包中的长度设置</title>
    <url>/2021-12-05-length-in-enumitem/</url>
    <content><![CDATA[<p>在 <a href="http://mirrors.ctan.org/macros/latex/contrib/enumitem/enumitem.pdf"><code>enumitem</code> 的宏包手册</a> 中有 5 个长度命令 <code>\leftmargin</code>, <code>\itemindent</code>, <code>\labelindent</code>, <code>\labelwidth</code> 和 <code>\labelsep</code>. 这些长度关系以及互相的制约让人头疼, 而 <code>enumitem</code> 的作者也晓得这一点:</p>
<blockquote>
<p>New 3.6 If you find these parameters baffling, you are not alone. You can visualize them<br>by writing <code>\DrawEnumitemLabel</code> just before the first item (or in first), which draws 4 rules<br>from top to bottom, <code>labelindent</code>, <code>labelwidth</code>, <code>labelsep</code>, <code>itemindent</code> (thin if positive, thick<br>if negative); the <code>leftmargin</code> is marked with two vertical rules.</p>
</blockquote>
<p>下面来探究一下这些关系应该如何设置.</p>
<span id="more"></span>
<p>首先声明: <strong>以下内容我没有阅读源码, 只是通过阅读文档以及 <a href="https://tex.stackexchange.com/a/490880/180617">TEX.SE 上的回答</a> 而进行的个人总结</strong></p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>在 <code>\leftmargin</code>, <code>\itemindent</code>, <code>\labelindent</code>, <code>\labelwidth</code> 和 <code>\labelsep</code> 这 5 个长度中, 只有 <code>\labelindent</code> 是 <code>enumitem</code> 宏包提供的, 其余都是 TeX 原生的列表环境的长度, <code>enumitem</code> 的作者想让用户可以直接设置左侧到 label 的距离:  <code>\labelindent</code> 的数值, 而不是进行一些运算. 而 <code>\labelindent</code> 满足如下数量关系:</p>
<pre><code>\leftmargin + \itemindent = \labelindent + \labelwidth + \labelsep
</code></pre><p>这是这篇博客共用的外层代码 :</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;article&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\usepackage</span>&#123;enumitem&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\newcommand</span>*<span class="keyword">\printvalue</span>[1]&#123;<span class="keyword">\texttt</span>&#123;<span class="keyword">\string</span> <span class="params">#1</span>&#125; : <span class="keyword">\the</span> <span class="params">#1</span>&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<p>并且我会在每个列表环境中都加入 <code>\DrawEnumitemLabel</code> 来指示各长度的关系. 同时我会加入一些手绘的竖线来更清晰的表示各元素的起止位置.</p>
<p>在不进行额外设置的情况下, 可以看到各项的默认值</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;</span><br><span class="line">    <span class="keyword">\DrawEnumitemLabel</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\leftmargin</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\itemindent</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelsep</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelwidth</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelindent</span></span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/length-in-enumitem/default.png" alt="默认长度"></p>
<h2 id="labelindent"><a href="#labelindent" class="headerlink" title="labelindent"></a><code>labelindent</code></h2><p>这个长度命令是用来表示文章或者上一级列表的左侧边缘到 label 盒子右侧边缘的距离, 默认值是 0.0pt. 注意: 这个长度命令通常不会起作用, 除非其他的长度命令被设置为了 <code>!</code> 或 <code>*</code> (见后文). <code>labelindent</code> 会根据其他的长度来进行计算, 哪怕你对它进行了设置, 比如 <code>labelindent=10pt</code>.</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;[labelindent=10pt]</span><br><span class="line">    <span class="keyword">\DrawEnumitemLabel</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelindent</span></span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/length-in-enumitem/signle-labelindent.png" alt="单独设置 `labelindent`"></p>
<p>可以看到, 即使我们设置了 <code>labelindent=10pt</code>, 这个长度设置依旧被忽略了.</p>
<h2 id="itemindent"><a href="#itemindent" class="headerlink" title="itemindent"></a><code>itemindent</code></h2><p><code>itemindent</code> 设置的是从 <code>leftmargin</code> 右侧到第一行列表内容左侧的长度:</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;[itemindent=10pt]</span><br><span class="line">    <span class="keyword">\DrawEnumitemLabel</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\leftmargin</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\itemindent</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelsep</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelwidth</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelindent</span></span><br><span class="line">    <span class="keyword">\item</span> Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Ut purus elit, vestibulum ut, placerat ac, adipiscing itae, felis.</span><br><span class="line">    <span class="keyword">\item</span> Lorem ipsum</span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/length-in-enumitem/itemindent.png" alt="`itemindent`"></p>
<p>这里第一次出现了 4 条横线, 还是来说明一下它们是什么: 从上到下依次是: <code>labelindent</code>, <code>labelwidth</code>, <code>labelsep</code>, <code>itemindent</code>, 其中两条竖线对应的是 <code>leftmargin</code> 的两端. 可以看到图中两条红线之间的距离即为 <code>itemindent</code> 的长度</p>
<h2 id="leftmargin"><a href="#leftmargin" class="headerlink" title="leftmargin"></a><code>leftmargin</code></h2><p><code>leftmargin</code> 设置的是从正文左侧到每个 item 中换行后的内容的起始位置之间的距离, 这里为了区分, 同时设置了 <code>itemindent</code> 的长度:</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;[itemindent=10pt, leftmargin=20pt]</span><br><span class="line">    <span class="keyword">\DrawEnumitemLabel</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\leftmargin</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\itemindent</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelsep</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelwidth</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelindent</span></span><br><span class="line">    <span class="keyword">\item</span> Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Ut purus elit, vestibulum ut, placerat ac, adipiscing itae, felis.</span><br><span class="line">    <span class="keyword">\item</span> Lorem ipsum</span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/length-in-enumitem/leftmargin.png" alt="`leftmargin`"></p>
<p>可以看到 <code>leftmargin</code> 的右侧线正好对应的换行后内容的开始, 其中两条竖线之间的长度为 <code>leftmargin</code> 的长度.</p>
<h2 id="labelwidth"><a href="#labelwidth" class="headerlink" title="labelwidth"></a><code>labelwidth</code></h2><p><code>labelwidth</code> 设置的是各个 <code>label</code> 的宽度, 通常来说这一项不需要手动控制, 可以使用 <code>widest</code> 参数控制:</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;[labelwidth=10pt]</span><br><span class="line">    <span class="keyword">\DrawEnumitemLabel</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\leftmargin</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\itemindent</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelsep</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelwidth</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelindent</span></span><br><span class="line">    <span class="keyword">\item</span> Lorem ipsum dolor sit amet, consectetuer adipisc<span class="keyword">\\</span>ing elit. Ut purus elit, vestibulum ut, placerat ac, adipiscing itae, felis.</span><br><span class="line">    <span class="keyword">\item</span> Lorem ipsum</span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/length-in-enumitem/labelwidth.png" alt="`labelwidth`"></p>
<h2 id="labelsep"><a href="#labelsep" class="headerlink" title="labelsep"></a><code>labelsep</code></h2><p><code>labelsep</code> 设置的是 <code>labelwidth</code> 右侧到列表内容左侧之间的距离:</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;[labelsep=10pt]</span><br><span class="line">    <span class="keyword">\DrawEnumitemLabel</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\leftmargin</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\itemindent</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelsep</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelwidth</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelindent</span></span><br><span class="line">    <span class="keyword">\item</span> Lorem ipsum dolor sit amet, consectetuer adipisc<span class="keyword">\\</span>ing elit. Ut purus elit, vestibulum ut, placerat ac, adipiscing itae, felis.</span><br><span class="line">    <span class="keyword">\item</span> Lorem ipsum</span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/length-in-enumitem/labelsep.png" alt="`labelsep`"></p>
<p>注意到在 <code>\DrawEnumitemLabel</code> 中第一条线变粗了, 这是因为通过计算, <code>labelindent</code> 的值为负数, 故用粗的线来表示负的 <code>labelindent</code>.</p>
<h2 id=""><a href="#" class="headerlink" title="!"></a><code>!</code></h2><p>因为给出的 5 个长度关系构成了一个方程, 所以总有一个参数可以通过其他参数进行计算. 我们可以将这 5 个长度的其中一个设置为 <code>!</code>, 来表示该长度是最后通过其他长度计算得到, 在默认情况下为 <code>labelindent=!</code>, 这也解释了为什么就算设置了 <code>labelindent=10pt</code> 也不会起作用.</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;[leftmargin=!, itemindent=10pt, labelindent=<span class="keyword">\parindent</span>]</span><br><span class="line">    <span class="keyword">\DrawEnumitemLabel</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\leftmargin</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\itemindent</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelsep</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelwidth</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelindent</span></span><br><span class="line">    <span class="keyword">\item</span> Lorem ipsum dolor sit amet, consectetuer adipisc<span class="keyword">\\</span>ing elit. Ut purus elit, vestibulum ut, placerat ac, adipiscing itae, felis.</span><br><span class="line">    <span class="keyword">\item</span> Lorem ipsum</span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/length-in-enumitem/leftmargin!.png" alt="`!`"></p>
<p>可以看到, 设置了 <code>leftmargin=!</code> 之后, 再对 <code>labelindent</code> 进行设置就起了作用.</p>
<h2 id="-1"><a href="#-1" class="headerlink" title="*"></a><code>*</code></h2><p>在默认的长度中 <code>labelindent</code> 是 20.00003pt, 非常宽, 通常来说不符合我们的需要, 这时候可以手动指定 <code>labelwidth</code>, 或者用将某一个长度设置为 <code>*</code>, 来直接按着标签的类型 (<code>\arabic*</code>, <code>\roman*</code> 等) 来设置标签的宽度<sup><a href="#fn_1" id="reffn_1">1</a></sup>, 除次之外 <code>*</code> 与 <code>!</code> 起相同的作用:</p>
<blockquote id="fn_1">
<sup>1</sup>. 如果设置的是 <code>label=(\Alph*)</code>, 那么会将 <code>(M)</code> 整体的宽度设置为 <code>labelwidth</code>.<a href="#reffn_1" title="Jump back to footnote [1] in the text."> &#8617;</a>
</blockquote>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center"><code>\arabic*</code></th>
<th style="text-align:center"><code>\roman*</code></th>
<th style="text-align:center"><code>\alph*</code></th>
<th style="text-align:center"><code>\Roman*</code></th>
<th style="text-align:center"><code>\Alph*</code></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0</td>
<td style="text-align:center">viii</td>
<td style="text-align:center">m</td>
<td style="text-align:center">VIII</td>
<td style="text-align:center">M</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;[labelindent=*]</span><br><span class="line">    <span class="keyword">\DrawEnumitemLabel</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\leftmargin</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\itemindent</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelsep</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelwidth</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelindent</span></span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;[labelindent=!]</span><br><span class="line">    <span class="keyword">\DrawEnumitemLabel</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\leftmargin</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\itemindent</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelsep</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelwidth</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelindent</span></span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/length-in-enumitem/exclamation-and-ast.png" alt="`*` and `!`"></p>
<p>图中用红线标出了两个 <code>labelwidth</code> 的宽度. 从图可以看出, 虽然显示效果相同, 但是设置 <code>labelindent=!</code> (也就是默认) 时, <code>labelwidth</code> 为默认的 20.00003pt, 而设置 <code>labelindent=*</code> 时, <code>labelwidth</code> 缩小到了 <code>0.</code> 的宽度: 7.7778pt. 如果使用 <code>align=left</code> 的话就会看到明显的显示差距.</p>
<h2 id="left"><a href="#left" class="headerlink" title="left"></a><code>left</code></h2><p><code>left</code> 不是一个长度单位, 是对 <code>labelindent</code> 和 <code>leftmargin</code> 的简化设置, 它有两种格式:</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line">left = &lt;labelindent&gt;</span><br><span class="line">left = &lt;labelindent&gt; .. &lt;leftmargin&gt;</span><br></pre></td></tr></table></figure>
<p>其中 <code>left = &lt;labelindent&gt;</code> 会设置 <code>leftmargin = *</code>, <code>left = &lt;labelindent&gt; .. &lt;leftmargin&gt;</code> 会设置 <code>labelsep = *</code>, 这里为了对比明显, 增加了 <code>itemindent=10pt</code></p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;[left=<span class="keyword">\parindent</span>, itemindent=10pt]</span><br><span class="line">    <span class="keyword">\DrawEnumitemLabel</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\leftmargin</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\itemindent</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelsep</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelwidth</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelindent</span></span><br><span class="line">    <span class="keyword">\item</span> Lorem ipsum dolor sit amet, consectetuer adipisc<span class="keyword">\\</span>ing elit. Ut purus elit, vestibulum ut, placerat ac, adipiscing itae, felis.</span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\verb</span>|<span class="string">left=\parindent</span>|</span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;[left=<span class="keyword">\parindent</span> .. 2<span class="keyword">\parindent</span>, itemindent=10pt]</span><br><span class="line">    <span class="keyword">\DrawEnumitemLabel</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\leftmargin</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\itemindent</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelsep</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelwidth</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelindent</span></span><br><span class="line">    <span class="keyword">\item</span> Lorem ipsum dolor sit amet, consectetuer adipisc<span class="keyword">\\</span>ing elit. Ut purus elit, vestibulum ut, placerat ac, adipiscing itae, felis.</span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\verb</span>|<span class="string">left=\parindent .. 2\parindent</span>|</span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/length-in-enumitem/left.png" alt="left"></p>
<p>可以看到只设置 <code>labelindent</code> 时, <code>labelsep</code> 为默认的 5pt, <code>leftmargin</code> 经过计算, 其值为 17.7778 pt. 在同时设置 <code>labelindent</code> 与 <code>leftmargin</code> 时, <code>labelsep</code> 经过计算, 其值为 17.2222pt.</p>
<h2 id="widest-amp-align"><a href="#widest-amp-align" class="headerlink" title="widest &amp; align"></a><code>widest</code> &amp; <code>align</code></h2><h3 id="widest"><a href="#widest" class="headerlink" title="widest"></a><code>widest</code></h3><p>可以使用 <code>widest</code> 来控制 <code>labelwidth</code> 的长度, 这里我们用了 <code>leftmargin=*</code>, 后文再说.</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;[widest = 10, start=8, leftmargin=*]</span><br><span class="line">    <span class="keyword">\DrawEnumitemLabel</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\leftmargin</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\itemindent</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelsep</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelwidth</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelindent</span></span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/length-in-enumitem/widest.png" alt="widest"></p>
<p><strong>注意</strong>: <code>widest</code> 只会用它的值去替换 <code>label</code> 内的计数 (<code>\roman*</code>, <code>\arabic*</code> 等), 比如我们设置了 <code>[label=(\arabic*)]</code>, 这时候如果指定 <code>[widest = (m)]</code>, 实际得到的 <code>labelwidth</code> 是 <code>((m))</code> 宽度. </p>
<h3 id="align"><a href="#align" class="headerlink" title="align"></a><code>align</code></h3><p>可以通过 <code>align=left</code> 或 <code>align=right</code> (默认) 来控制 <code>label</code> 的宽度与 <code>labelwidth</code> 不同时的对齐方式. 如上图所示, 所有标签都是向右对齐, 当然我们可以设置 <code>align=left</code>:</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;[widest = 10, start=8, leftmargin=*, align=left]</span><br><span class="line">    <span class="keyword">\DrawEnumitemLabel</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\leftmargin</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\itemindent</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelsep</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelwidth</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelindent</span></span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br></pre></td></tr></table></figure>
<p>如果我们不设置 <code>widest</code>, 那么它会按着 <code>*</code> 节中的表格长度来自动设置, 这时候对于固定的 <code>labelsep</code> 会产生不一致的间距:</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;[start=8, leftmargin=*, align=left]</span><br><span class="line">    <span class="keyword">\DrawEnumitemLabel</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\leftmargin</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\itemindent</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelsep</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelwidth</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelindent</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\verb</span>|<span class="string">align=left</span>|</span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;[start=8, leftmargin=*, align=right]</span><br><span class="line">    <span class="keyword">\DrawEnumitemLabel</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\leftmargin</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\itemindent</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelsep</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelwidth</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelindent</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\verb</span>|<span class="string">align=right</span>| (default)</span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;[start=8, leftmargin=*, widest=10, align=right]</span><br><span class="line">    <span class="keyword">\DrawEnumitemLabel</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\leftmargin</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\itemindent</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelsep</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelwidth</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelindent</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\verb</span>|<span class="string">align=right</span>| (default)</span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/length-in-enumitem/no-widest.png" alt="no `widest`"></p>
<p>图中用红线标出了 <code>labelwidth</code> 的长度, 可以看到当没有设置 <code>widest</code> 的时候, <code>label</code> 会只按照 <code>0.</code> 的宽度进行设置, 导致 <code>label</code> 溢出. 所以在 <code>label</code> 长度不一致的时候推荐使用 <code>widest</code> 来干预 <code>labelwidth</code> 的长度.</p>
<h2 id="嵌套"><a href="#嵌套" class="headerlink" title="嵌套"></a>嵌套</h2><p>在嵌套的过程中, 下一层级的 <code>leftmargin</code> 的起始位置就是上一层级的 <code>leftmargin</code> 的结束位置, 并且要根据层级不同而导致的 <code>labelwidth</code> 不同来设置不同的 <code>itemindent</code></p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;[labelindent=.5<span class="keyword">\parindent</span>,leftmargin=<span class="keyword">\parindent</span>, itemindent=5pt, labelsep = *]</span><br><span class="line">    <span class="keyword">\DrawEnumitemLabel</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\leftmargin</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\itemindent</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelsep</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelwidth</span></span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelindent</span></span><br><span class="line">    <span class="keyword">\begin</span>&#123;enumerate&#125;[labelindent=.5<span class="keyword">\parindent</span>,leftmargin=<span class="keyword">\parindent</span>, itemindent=13pt, labelsep = *]</span><br><span class="line">        <span class="keyword">\DrawEnumitemLabel</span></span><br><span class="line">        <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\leftmargin</span></span><br><span class="line">        <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\itemindent</span></span><br><span class="line">        <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelsep</span></span><br><span class="line">        <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelwidth</span></span><br><span class="line">        <span class="keyword">\item</span> <span class="keyword">\printvalue</span><span class="keyword">\labelindent</span></span><br><span class="line">    <span class="keyword">\end</span>&#123;enumerate&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/length-in-enumitem/nest.png" alt="nested"></p>
<h2 id="一些实例"><a href="#一些实例" class="headerlink" title="一些实例"></a>一些实例</h2><p><strong>以下实例都可以根据 <code>label</code> 的宽度来添加 <code>widest=</code> 与 <code>align=</code></strong></p>
<h3 id="实例-1"><a href="#实例-1" class="headerlink" title="实例 1"></a>实例 1</h3><figure class="highlight tex"><table><tr><td class="code"><pre><span class="line">En un lugar de la Mancha, de cuyo nombre no quiero acordarme,</span><br><span class="line">no ha mucho tiempo que viv<span class="keyword">\&#x27;</span>&#123;<span class="keyword">\i</span>&#125;a un hidalgo de los de</span><br><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;[labelindent=<span class="keyword">\parindent</span>,leftmargin=*]</span><br><span class="line">    <span class="keyword">\DrawEnumitemLabel</span></span><br><span class="line">    <span class="keyword">\item</span> lanza en astillero,</span><br><span class="line">    <span class="keyword">\item</span> adarna antigua,</span><br><span class="line">    <span class="keyword">\item</span> Lorem ipsum dolor sit amet, consectetuer adipisc<span class="keyword">\\</span>ing elit. Ut purus elit, vestibulum ut, placerat ac, adipiscing itae, felis.</span><br><span class="line">    <span class="keyword">\item</span> Lorem ipsum</span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br><span class="line">Una olla de algo m<span class="keyword">\&#x27;</span>&#123;a&#125;s vaca que carnero, salpic<span class="keyword">\&#x27;</span>&#123;o&#125;n las m<span class="keyword">\&#x27;</span>&#123;a&#125;snoches, duelos y quebrantos los s<span class="keyword">\&#x27;</span>&#123;a&#125;bados...</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/length-in-enumitem/sample1.png" alt="Sample 1"></p>
<p>可以看到, 由于 <code>itemindent=0pt</code>, 换行后的内容与第一行的列表内容是对齐的.</p>
<h3 id="实例-2"><a href="#实例-2" class="headerlink" title="实例 2"></a>实例 2</h3><figure class="highlight tex"><table><tr><td class="code"><pre><span class="line">En un lugar de la Mancha, de cuyo nombre no quiero acordarme,</span><br><span class="line">no ha mucho tiempo que viv<span class="keyword">\&#x27;</span>&#123;<span class="keyword">\i</span>&#125;a un hidalgo de los de</span><br><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;[leftmargin=*] <span class="comment">% labelindent=0pt by default.</span></span><br><span class="line">    <span class="keyword">\DrawEnumitemLabel</span></span><br><span class="line">    <span class="keyword">\item</span> lanza en astillero,</span><br><span class="line">    <span class="keyword">\item</span> adarna antigua,</span><br><span class="line">    <span class="keyword">\item</span> Lorem ipsum dolor sit amet, consectetuer adipisc<span class="keyword">\\</span>ing elit. Ut purus elit, vestibulum ut, placerat ac, adipiscing itae, felis.</span><br><span class="line">    <span class="keyword">\item</span> Lorem ipsum</span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br><span class="line">Una olla de algo m<span class="keyword">\&#x27;</span>&#123;a&#125;s vaca que carnero, salpic<span class="keyword">\&#x27;</span>&#123;o&#125;n las m<span class="keyword">\&#x27;</span>&#123;a&#125;snoches, duelos y quebrantos los s<span class="keyword">\&#x27;</span>&#123;a&#125;bados...</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/length-in-enumitem/sample2.png" alt="Sample 2"></p>
<p>与上一例的区别是没有设置 <code>labelindent</code>, 这样每个 <code>label</code> 都是从 <code>leftmargin</code> 的起始位置开始.</p>
<h3 id="实例-3"><a href="#实例-3" class="headerlink" title="实例 3"></a>实例 3</h3><figure class="highlight tex"><table><tr><td class="code"><pre><span class="line">En un lugar de la Mancha, de cuyo nombre no quiero acordarme,</span><br><span class="line">no ha mucho tiempo que viv<span class="keyword">\&#x27;</span>&#123;<span class="keyword">\i</span>&#125;a un hidalgo de los de</span><br><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;[leftmargin=<span class="keyword">\parindent</span>]</span><br><span class="line">    <span class="keyword">\DrawEnumitemLabel</span></span><br><span class="line">    <span class="keyword">\item</span> lanza en astillero,</span><br><span class="line">    <span class="keyword">\item</span> adarna antigua,</span><br><span class="line">    <span class="keyword">\item</span> Lorem ipsum dolor sit amet, consectetuer adipisc<span class="keyword">\\</span>ing elit. Ut purus elit, vestibulum ut, placerat ac, adipiscing itae, felis.</span><br><span class="line">    <span class="keyword">\item</span> Lorem ipsum</span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br><span class="line">Una olla de algo m<span class="keyword">\&#x27;</span>&#123;a&#125;s vaca que carnero, salpic<span class="keyword">\&#x27;</span>&#123;o&#125;n las m<span class="keyword">\&#x27;</span>&#123;a&#125;snoches, duelos y quebrantos los s<span class="keyword">\&#x27;</span>&#123;a&#125;bados...</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/length-in-enumitem/sample3.png" alt="Sample 3"></p>
<p>这一例固定了列表的内容是从正文的缩进位置开始, 而不管序号的位置.</p>
<h3 id="实例-4"><a href="#实例-4" class="headerlink" title="实例 4"></a>实例 4</h3><figure class="highlight tex"><table><tr><td class="code"><pre><span class="line">En un lugar de la Mancha, de cuyo nombre no quiero acordarme,</span><br><span class="line">no ha mucho tiempo que viv<span class="keyword">\&#x27;</span>&#123;<span class="keyword">\i</span>&#125;a un hidalgo de los de</span><br><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;[labelindent=<span class="keyword">\parindent</span>, leftmargin=*, label=<span class="keyword">\Roman</span>*., widest=III,  align=left]</span><br><span class="line">    <span class="keyword">\DrawEnumitemLabel</span></span><br><span class="line">    <span class="keyword">\item</span> lanza en astillero,</span><br><span class="line">    <span class="keyword">\item</span> adarna antigua,</span><br><span class="line">    <span class="keyword">\item</span> Lorem ipsum dolor sit amet, consectetuer adipisc<span class="keyword">\\</span>ing elit. Ut purus elit, vestibulum ut, placerat ac, adipiscing itae, felis.</span><br><span class="line">    <span class="keyword">\item</span> Lorem ipsum</span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br><span class="line">Una olla de algo m<span class="keyword">\&#x27;</span>&#123;a&#125;s vaca que carnero, salpic<span class="keyword">\&#x27;</span>&#123;o&#125;n las m<span class="keyword">\&#x27;</span>&#123;a&#125;snoches, duelos y quebrantos los s<span class="keyword">\&#x27;</span>&#123;a&#125;bados...</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/length-in-enumitem/sample4.png" alt="Sample 4"></p>
<h3 id="实例-5"><a href="#实例-5" class="headerlink" title="实例 5"></a>实例 5</h3><figure class="highlight tex"><table><tr><td class="code"><pre><span class="line">En un lugar de la Mancha, de cuyo nombre no quiero acordarme,</span><br><span class="line">no ha mucho tiempo que viv<span class="keyword">\&#x27;</span>&#123;<span class="keyword">\i</span>&#125;a un hidalgo de los de</span><br><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;[labelindent=<span class="keyword">\parindent</span>, leftmargin=<span class="keyword">\parindent</span>, widest=0, itemindent=*]</span><br><span class="line">    <span class="keyword">\DrawEnumitemLabel</span></span><br><span class="line">    <span class="keyword">\item</span> lanza en astillero,</span><br><span class="line">    <span class="keyword">\item</span> adarna antigua,</span><br><span class="line">    <span class="keyword">\item</span> Lorem ipsum dolor sit amet, consectetuer adipisc<span class="keyword">\\</span>ing elit. Ut purus elit, vestibulum ut, placerat ac, adipiscing itae, felis.</span><br><span class="line">    <span class="keyword">\item</span> Lorem ipsum</span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br><span class="line">Una olla de algo m<span class="keyword">\&#x27;</span>&#123;a&#125;s vaca que carnero, salpic<span class="keyword">\&#x27;</span>&#123;o&#125;n las m<span class="keyword">\&#x27;</span>&#123;a&#125;snoches, duelos y quebrantos los s<span class="keyword">\&#x27;</span>&#123;a&#125;bados...</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/length-in-enumitem/sample5.png" alt="Sample 5"></p>
<p>可以看到我们将 <code>leftmargin</code> 与 <code>labelindent</code> 均设置为了 <code>\parindent</code>, 这样可以保证换行后的内容与 <code>label</code> 是左对齐的, 同时用 <code>widest</code> 来限制了 <code>labelwidth</code> 的长度.</p>
<h3 id="实例-6"><a href="#实例-6" class="headerlink" title="实例 6"></a>实例 6</h3><figure class="highlight tex"><table><tr><td class="code"><pre><span class="line">En un lugar de la Mancha, de cuyo nombre no quiero acordarme,</span><br><span class="line">no ha mucho tiempo que viv<span class="keyword">\&#x27;</span>&#123;<span class="keyword">\i</span>&#125;a un hidalgo de los de</span><br><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;[labelindent=<span class="keyword">\parindent</span>, leftmargin=0pt, widest=0, itemindent=*]</span><br><span class="line">    <span class="keyword">\DrawEnumitemLabel</span></span><br><span class="line">    <span class="keyword">\item</span> lanza en astillero,</span><br><span class="line">    <span class="keyword">\item</span> adarna antigua,</span><br><span class="line">    <span class="keyword">\item</span> Lorem ipsum dolor sit amet, consectetuer adipisc<span class="keyword">\\</span>ing elit. Ut purus elit, vestibulum ut, placerat ac, adipiscing itae, felis.</span><br><span class="line">    <span class="keyword">\item</span> Lorem ipsum</span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br><span class="line">Una olla de algo m<span class="keyword">\&#x27;</span>&#123;a&#125;s vaca que carnero, salpic<span class="keyword">\&#x27;</span>&#123;o&#125;n las m<span class="keyword">\&#x27;</span>&#123;a&#125;snoches, duelos y quebrantos los s<span class="keyword">\&#x27;</span>&#123;a&#125;bados...</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/length-in-enumitem/sample6.png" alt="Sample 6"></p>
<p>该例将 <code>leftmargin</code> 设置为 0, 来让换行后的内容与正文部分的左侧对齐.</p>
<h3 id="实例-7"><a href="#实例-7" class="headerlink" title="实例 7"></a>实例 7</h3><figure class="highlight tex"><table><tr><td class="code"><pre><span class="line">En un lugar de la Mancha, de cuyo nombre no quiero acordarme,</span><br><span class="line">no ha mucho tiempo que viv<span class="keyword">\&#x27;</span>&#123;<span class="keyword">\i</span>&#125;a un hidalgo de los de</span><br><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;[leftmargin=0pt, widest=0, itemindent=0pt,  labelindent=*, align=left]</span><br><span class="line">    <span class="keyword">\DrawEnumitemLabel</span></span><br><span class="line">    <span class="keyword">\item</span> lanza en astillero,</span><br><span class="line">    <span class="keyword">\item</span> adarna antigua,</span><br><span class="line">    <span class="keyword">\item</span> Lorem ipsum dolor sit amet, consectetuer adipisc<span class="keyword">\\</span>ing elit. Ut purus elit, vestibulum ut, placerat ac, adipiscing itae, felis.</span><br><span class="line">    <span class="keyword">\item</span> Lorem ipsum</span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br><span class="line">Una olla de algo m<span class="keyword">\&#x27;</span>&#123;a&#125;s vaca que carnero, salpic<span class="keyword">\&#x27;</span>&#123;o&#125;n las m<span class="keyword">\&#x27;</span>&#123;a&#125;snoches, duelos y quebrantos los s<span class="keyword">\&#x27;</span>&#123;a&#125;bados...</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/length-in-enumitem/sample7.png" alt="Sample 7"></p>
]]></content>
      <categories>
        <category>LaTeX</category>
        <category>列表</category>
      </categories>
      <tags>
        <tag>LaTeX</tag>
        <tag>示例</tag>
        <tag>列表</tag>
      </tags>
  </entry>
  <entry>
    <title>第一次被骗</title>
    <url>/2022-01-11-a-stupid-fraud/</url>
    <content><![CDATA[<p>以为不会轻易被骗的我就轻易被骗了……</p>
<span id="more"></span>
<p>前几天我打算接个家教赚点零花钱, 在一个正规家教群里加了一个发布家教信息的（不是群主管理, 这个群没有禁言）, 要信息费 400, 是一节半课的钱, 也算合理, 当场支付宝转了.</p>
<p>然后今天在这个群里一个女生说这个人是骗子, 她转了钱, 过了几天骗子把他删了, 我一看确实, 我也被删了. 我, 她和我对象一起合计了一下, 发现这个人提供的信息就不一样, 是骗子无疑了.</p>
<p>给 110 打了个电话,  110 说 400 块钱肯定不够立案, 而且只有一个支付宝付款码, 没有手机号长个记性吧. 又咽不下这口气, 自己找吧. 没被删之前我看过他的空间, 里面有一些日常照片, QQ 等级一个皇冠, 应该是个大号, 然后用了一些不可描述的手段用 QQ 号获取了手机号, 再支付宝验证了一下这个手机号确实是我给转钱的账户, 这时候再给 110 打了回去, 说知道了手机号, 110 说可以帮联系一下, 这里着重感谢一下哈尔滨市松北区的某警察, 至少可以帮打这个电话, 然后我们这边也又搜了一些他的信息, 并且用支付宝转账试出了他的全名, 发现还是个<a href="https://www.cedf.org.cn/2019Ryjhxs/donate.do?method=listByPage&amp;method=listByPage&amp;year=2019&amp;cid=2731307749&amp;start=5000">中国教育发展基金会</a>的资助学生.</p>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/a-stupid-fraud/foundation.png" alt="foundation"></p>
<p>手握这些信息我对象给骗子发了个邮件:</p>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/a-stupid-fraud/mail.png" alt="mail"></p>
<p>骗子当场顺着邮箱加了我对象的 QQ:</p>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/a-stupid-fraud/chat.png" alt="chat"></p>
<p>一顿连骂带吓唬, 把钱要回来了, 简单一问说警察也给他打了个电话, 估计给这小子吓得不轻. 至此, 打了个漂亮仗.</p>
<p>第一次被骗就遇上了这么蠢的骗子, 用大号诈骗真的……愚蠢. (这好像是我写的最轻松的一个博客)</p>
]]></content>
      <categories>
        <category>日常</category>
      </categories>
      <tags>
        <tag>日常</tag>
        <tag>诈骗</tag>
      </tags>
  </entry>
  <entry>
    <title>用 LaTeX3 实现一些日期相关的功能</title>
    <url>/2022-02-16-date-function-with-l3/</url>
    <content><![CDATA[<p>在给家教学生出题的过程中想实现节标题的自动化, 由于题目是每天都有, 所以我想交替用 <code>\examsection</code> 和 <code>\answersection</code> 来输出节标题, 并且设置页眉和目录, 目标效果如下:</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"><span class="keyword">\setdate</span>[2022, 2, 14]</span><br><span class="line"><span class="keyword">\examsection</span></span><br><span class="line"><span class="keyword">\answersection</span></span><br><span class="line"><span class="keyword">\examsection</span>*</span><br><span class="line"><span class="keyword">\answersection</span>*</span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/date-function-with-l3/goal.png" alt="目标效果"></p>
<span id="more"></span>
<p><strong>我刚刚开始学习 LaTeX3, 对一些函数的使用可能不太得当, 欢迎指出.</strong></p>
<h2 id="实现思路"><a href="#实现思路" class="headerlink" title="实现思路"></a>实现思路</h2><p>首先我们定义一些变量:</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="comment">% 定义年, 月, 日, 后文注释中用 year, month, day 来指代</span></span><br><span class="line"><span class="keyword">\int_new:N</span> <span class="keyword">\g__dailyexam_year_int</span></span><br><span class="line"><span class="keyword">\int_new:N</span> <span class="keyword">\g__dailyexam_month_int</span></span><br><span class="line"><span class="keyword">\int_new:N</span> <span class="keyword">\g__dailyexam_day_int</span></span><br><span class="line"><span class="comment">% 定义最大的月数, 每月的最大天数, 以及特殊的二月的天数</span></span><br><span class="line"><span class="keyword">\int_new:N</span> <span class="keyword">\c__dailyexam_month_max_int</span></span><br><span class="line"><span class="keyword">\int_set:Nn</span> <span class="keyword">\c__dailyexam_month_max_int</span> &#123; 12 &#125;</span><br><span class="line"><span class="keyword">\int_new:N</span> <span class="keyword">\l__dailyexam_day_max_int</span></span><br><span class="line"><span class="keyword">\int_new:N</span> <span class="keyword">\l__dailyexam_day_feb_max_int</span></span><br><span class="line"><span class="comment">% 定义用来接受 \setdate 的参数的 clist</span></span><br><span class="line"><span class="keyword">\clist_new:N</span> <span class="keyword">\l__dailyexam_date_clist</span></span><br></pre></td></tr></table></figure>
<p>然后定义一个 <code>prop</code>, 来存储每个月的名称, 在这里用来输出报错信息: </p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\prop_const_from_keyval:Nn</span> <span class="keyword">\c__dailyexam_month_prop</span></span><br><span class="line">  &#123;</span><br><span class="line">    &#123; 1 &#125; = &#123; January &#125;,</span><br><span class="line">    &#123; 2 &#125; = &#123; February &#125;,</span><br><span class="line">    &#123; 3 &#125; = &#123; March &#125;, </span><br><span class="line">    &#123; 4 &#125; = &#123; April &#125;, </span><br><span class="line">    &#123; 5 &#125; = &#123; May &#125;, </span><br><span class="line">    &#123; 6 &#125; = &#123; June &#125;, </span><br><span class="line">    &#123; 7 &#125; = &#123; July &#125;,</span><br><span class="line">    &#123; 8 &#125; = &#123; August &#125;,</span><br><span class="line">    &#123; 9 &#125; = &#123; September &#125;,</span><br><span class="line">    &#123; 10 &#125; = &#123; October &#125;, </span><br><span class="line">    &#123; 11 &#125; = &#123; November &#125;, </span><br><span class="line">    &#123; 12 &#125; = &#123; December&#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>再定义一些信息, 分别为不合法的年, 月, 日, 因为闰年是从 1582 年的格里高利历开始的记法, 所以这里年要大于 1582 年. </p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\msg_new:nnn</span> &#123; dailyexam &#125; &#123; year~is~illegal &#125; &#123; &quot;year&quot;~must~later~than~1582 &#125;</span><br><span class="line"><span class="keyword">\msg_new:nnn</span> &#123; dailyexam &#125; &#123; month~is~illegal &#125; &#123; &quot;month&quot;~must~be~an~integer~among~1,~2,~3,...,~12 &#125;</span><br><span class="line"><span class="keyword">\msg_new:nnn</span> &#123; dailyexam &#125; &#123; day~is~illegal &#125; &#123; <span class="params">#1</span>~of~<span class="params">#2</span>~has~only~<span class="params">#3</span>~days, <span class="keyword">\\</span></span><br><span class="line">                                                &quot;day&quot;~must~be~an~integer~among~1,~2,~3,...,~<span class="params">#3</span> &#125;</span><br><span class="line"><span class="comment">% 示例输出为</span></span><br><span class="line"><span class="comment">% ! Package dailyexam Error: February of 2022 has only 28 days,</span></span><br><span class="line"><span class="comment">% (dailyexam)                &quot;day&quot; must be an integer among 1, 2, 3,..., 28</span></span><br></pre></td></tr></table></figure>
<p>然后我们来根据月份来设置最大天数 <code>\l_dailyexam_day_max_int</code> :</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="comment">% 设置 month 月份下最大的天数,</span></span><br><span class="line"><span class="keyword">\cs_new:Nn</span> <span class="keyword">\__dailyexam_set_max_day:</span> </span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">% 首先根据大小月规则来设置除二月外的最大天数</span></span><br><span class="line">    <span class="keyword">\int_case:nnT</span> &#123; <span class="keyword">\g__dailyexam_month_int</span> &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        &#123; 1 &#125; &#123; &#125;</span><br><span class="line">        &#123; 3 &#125; &#123; &#125;</span><br><span class="line">        &#123; 5 &#125; &#123; &#125;</span><br><span class="line">        &#123; 7 &#125; &#123; &#125;</span><br><span class="line">        &#123; 8 &#125; &#123; &#125;</span><br><span class="line">        &#123; 10 &#125; &#123; &#125;</span><br><span class="line">        &#123; 12 &#125; &#123; &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">\int_set:Nn</span> <span class="keyword">\l__dailyexam_day_max_int</span> &#123; 31 &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">\int_case:nnT</span> &#123; <span class="keyword">\g__dailyexam_month_int</span> &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        &#123; 4 &#125; &#123; &#125;</span><br><span class="line">        &#123; 6 &#125; &#123; &#125;</span><br><span class="line">        &#123; 9 &#125; &#123; &#125;</span><br><span class="line">        &#123; 11 &#125; &#123; &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">\int_set:Nn</span> <span class="keyword">\l__dailyexam_day_max_int</span> &#123; 30 &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">\int_compare:nNnTF</span> &#123; <span class="keyword">\g__dailyexam_year_int</span> &#125; &lt; &#123; 1582 &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">% 如果被判断的年在 1582 年之前, 则输出报错信息</span></span><br><span class="line">        <span class="keyword">\msg_error:nn</span> &#123; dailyexam &#125; &#123; year~is~illegal &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">% 如果被判断的年在 1582 年之后, 则需要判断该年是否是闰年</span></span><br><span class="line">        <span class="comment">% 规则为: 如果年份能被 100 整除, 则它需要整除 400;</span></span><br><span class="line">        <span class="comment">%         如果年份不能被 100 整除, 则它需要整除 4;</span></span><br><span class="line">        <span class="comment">%         以上两种情况为闰年, 二月有 29 天</span></span><br><span class="line">        <span class="comment">%         否则该年为平年, 二月有 28 天</span></span><br><span class="line">        <span class="keyword">\bool_if:nTF</span> </span><br><span class="line">          &#123;</span><br><span class="line">            (</span><br><span class="line">              <span class="keyword">\int_compare_p:nNn</span> &#123; <span class="keyword">\int_mod:nn</span> &#123; <span class="keyword">\g__dailyexam_year_int</span> &#125; &#123; 100 &#125; &#125; = &#123; 0 &#125; <span class="built_in">&amp;</span><span class="built_in">&amp;</span> </span><br><span class="line">              <span class="keyword">\int_compare_p:nNn</span> &#123; <span class="keyword">\int_mod:nn</span> &#123; <span class="keyword">\g__dailyexam_year_int</span> &#125; &#123; 400 &#125; &#125; = &#123; 0 &#125;</span><br><span class="line">            ) </span><br><span class="line">            ||</span><br><span class="line">            (</span><br><span class="line">              ! <span class="keyword">\int_compare_p:nNn</span> &#123; <span class="keyword">\int_mod:nn</span> &#123; <span class="keyword">\g__dailyexam_year_int</span> &#125; &#123; 100 &#125; &#125; = &#123; 0 &#125; <span class="built_in">&amp;</span><span class="built_in">&amp;</span></span><br><span class="line">              <span class="keyword">\int_compare_p:nNn</span> &#123; <span class="keyword">\int_mod:nn</span> &#123; <span class="keyword">\g__dailyexam_year_int</span> &#125; &#123; 4 &#125; &#125; = &#123; 0 &#125;</span><br><span class="line">            )</span><br><span class="line">          &#125;</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">\int_set:Nn</span> <span class="keyword">\l__dailyexam_day_feb_max_int</span> &#123; 29 &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">\int_set:Nn</span> <span class="keyword">\l__dailyexam_day_feb_max_int</span> &#123; 28 &#125;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="comment">% 判断该月是否为二月, 如果是, 就把最大天数设置为二月最大天数</span></span><br><span class="line">    <span class="keyword">\int_compare:nNnT</span> &#123; <span class="keyword">\g__dailyexam_month_int</span> &#125; = &#123; 2 &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">\int_set_eq:NN</span> <span class="keyword">\l__dailyexam_day_max_int</span> <span class="keyword">\l__dailyexam_day_feb_max_int</span></span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>下面是关键的一个函数, 将给定的一个日期向后移动一天:</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="comment">% 将日期改为下一天, 注意这里的日期更改都需要是全局的, 否则在 \section 的参数中表现为局部变化 </span></span><br><span class="line"><span class="keyword">\cs_new:Nn</span> <span class="keyword">\__dailyexam_next_day:</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">% 判断 day 是否等于当月的 day_max</span></span><br><span class="line">    <span class="keyword">\int_compare:nNnTF</span> &#123; <span class="keyword">\g__dailyexam_day_int</span> &#125; = &#123; <span class="keyword">\l__dailyexam_day_max_int</span> &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">% 如果日期等于 day_max, 那么进入了新的一个月, 将 day 重设为 1</span></span><br><span class="line">        <span class="keyword">\int_gset:Nn</span> <span class="keyword">\g__dailyexam_day_int</span> &#123; 1 &#125;</span><br><span class="line">        <span class="keyword">\int_compare:nNnTF</span> &#123; <span class="keyword">\g__dailyexam_month_int</span> &#125; = &#123; <span class="keyword">\c__dailyexam_month_max_int</span> &#125;</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="comment">% 如果这时是十二月, 即该天为 12.31, </span></span><br><span class="line">            <span class="comment">% 那么进入了新的一年, 将 month 重设为 1, 并将 year 加 1 </span></span><br><span class="line">            <span class="keyword">\int_gset:Nn</span> <span class="keyword">\g__dailyexam_month_int</span> &#123; 1 &#125;</span><br><span class="line">            <span class="keyword">\int_gincr:N</span> <span class="keyword">\g__dailyexam_year_int</span></span><br><span class="line">          &#125;</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="comment">% 如果不是十二月, 那么只需要将 month 加 1</span></span><br><span class="line">            <span class="keyword">\int_gincr:N</span> <span class="keyword">\g__dailyexam_month_int</span></span><br><span class="line">          &#125;</span><br><span class="line">        <span class="comment">% 只要进入了新的一个月, 就需要重新设置 day_max</span></span><br><span class="line">        <span class="keyword">\__dailyexam_set_max_day:</span> </span><br><span class="line">      &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">% 如果 day 不等于 day_max, 那么只需要将 day 加 1</span></span><br><span class="line">        <span class="keyword">\int_gincr:N</span> <span class="keyword">\g__dailyexam_day_int</span></span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>由于我们要使用 <code>\setdate</code> 来设置起始日期, 那么就需要防止用户输入不合法的日期, 如 13 月 32 日:</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="comment">% 判断 \setdate 所接受的日期是否合法</span></span><br><span class="line"><span class="keyword">\cs_new:Nn</span> <span class="keyword">\__dailyexam_if_legal:</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">% 首先是对 year 的判断, 同上</span></span><br><span class="line">    <span class="keyword">\int_compare:nNnT</span> &#123; <span class="keyword">\g__dailyexam_year_int</span> &#125; &lt; &#123; 1582 &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">\msg_error:nn</span> &#123; dailyexam &#125; &#123; year~is~illegal &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="comment">% 判断 month 是否是在 1 -- 12 之间</span></span><br><span class="line">    <span class="keyword">\int_compare:nTF</span></span><br><span class="line">      &#123;</span><br><span class="line">        0 &lt; <span class="keyword">\g__dailyexam_month_int</span> &lt;= <span class="keyword">\c__dailyexam_month_max_int</span></span><br><span class="line">      &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">% 如果 month 合法, 那么就可以设置当月的 day_max, 用来对 day 进行判断</span></span><br><span class="line">        <span class="keyword">\__dailyexam_set_max_day:</span></span><br><span class="line">      &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">% 如果 month 不合法, 输出报错信息</span></span><br><span class="line">        <span class="keyword">\msg_error:nn</span> &#123; dailyexam &#125; &#123; month~is~illegal &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="comment">% 判断 day 是否在 1 -- day_max 之间</span></span><br><span class="line">    <span class="keyword">\int_compare:nF</span></span><br><span class="line">      &#123;</span><br><span class="line">        0 &lt; <span class="keyword">\g__dailyexam_day_int</span> &lt;= <span class="keyword">\l__dailyexam_day_max_int</span></span><br><span class="line">      &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">% 如果 day 不合法, 输出报错信息, 报错信息的示例在 \mas_new 部分</span></span><br><span class="line">        <span class="keyword">\exp_args:NNx</span> <span class="keyword">\prop_get:NnN</span> <span class="keyword">\c__dailyexam_month_prop</span> </span><br><span class="line">          &#123; <span class="keyword">\int_use:N</span> <span class="keyword">\g__dailyexam_month_int</span> &#125; </span><br><span class="line">          <span class="keyword">\l_tmpb_tl</span></span><br><span class="line">        <span class="keyword">\msg_error:nnxxx</span> &#123; dailyexam &#125; &#123; day~is~illegal &#125; </span><br><span class="line">          &#123; <span class="keyword">\tl_use:N</span> <span class="keyword">\l_tmpb_tl</span> &#125; </span><br><span class="line">          &#123; <span class="keyword">\int_use:N</span> <span class="keyword">\g__dailyexam_year_int</span> &#125; </span><br><span class="line">          &#123; <span class="keyword">\int_use:N</span> <span class="keyword">\l__dailyexam_day_max_int</span> &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>下面来进行 <code>\setdate</code> 的内部函数的编写:</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="comment">% 这里设置另一个重要的函数, 设置起始日期</span></span><br><span class="line"><span class="comment">% 我们规定输入的参数为一个逗号分隔列表 clist</span></span><br><span class="line"><span class="keyword">\cs_new:Npn</span> <span class="keyword">\__dailyexam_setdate:n</span> <span class="params">#1</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">% 将参数传入 clist, 参数是否合法在赋值后判断</span></span><br><span class="line">    <span class="keyword">\clist_set:Nn</span> <span class="keyword">\l__dailyexam_date_clist</span> &#123; <span class="params">#1</span> &#125;</span><br><span class="line">    <span class="keyword">\int_case:nnTF</span> &#123; <span class="keyword">\clist_count:N</span> <span class="keyword">\l__dailyexam_date_clist</span> &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">% 如果参数列表里有三项, 也就是对应着 year, month, day,</span></span><br><span class="line">        <span class="comment">% 那么将第一项设置为 year, 再将第一项 pop 到一个不再使用的临时变量中,</span></span><br><span class="line">        <span class="comment">% 来保证现在的 clist 中剩余 month 和 day</span></span><br><span class="line">        <span class="comment">% 注意, 这里我们不能直接用 \l_tmpa_tl 来对 year 赋值, 因为数据类型不同</span></span><br><span class="line">        &#123; 3 &#125; </span><br><span class="line">        &#123; </span><br><span class="line">          <span class="keyword">\exp_args:NNx</span> <span class="keyword">\int_gset:Nn</span> <span class="keyword">\g__dailyexam_year_int</span> </span><br><span class="line">            &#123; <span class="keyword">\clist_item:Nn</span> <span class="keyword">\l__dailyexam_date_clist</span> &#123; 1 &#125; &#125;</span><br><span class="line">          <span class="keyword">\clist_pop:NN</span> <span class="keyword">\l__dailyexam_date_clist</span> <span class="keyword">\l_tmpa_tl</span> </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">% 如果参数列表中有两项, 对应着 month, day,</span></span><br><span class="line">        <span class="comment">% 这时候将 year 设置为编译时的系统年份</span></span><br><span class="line">        &#123; 2 &#125; &#123; <span class="keyword">\int_gset_eq:NN</span> <span class="keyword">\g__dailyexam_year_int</span> <span class="keyword">\c_sys_year_int</span> &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">% 经过上两步的筛选, 可以保证此时 clist 中只有两项: month 和 day</span></span><br><span class="line">        <span class="comment">% 再将它们赋值到 month 和 day</span></span><br><span class="line">        <span class="keyword">\exp_args:NNx</span> <span class="keyword">\int_gset:Nn</span> <span class="keyword">\g__dailyexam_month_int</span> </span><br><span class="line">          &#123; <span class="keyword">\clist_item:Nn</span> <span class="keyword">\l__dailyexam_date_clist</span> &#123; 1 &#125; &#125;</span><br><span class="line">        <span class="keyword">\exp_args:NNx</span> <span class="keyword">\int_gset:Nn</span> <span class="keyword">\g__dailyexam_day_int</span> </span><br><span class="line">          &#123; <span class="keyword">\clist_item:Nn</span> <span class="keyword">\l__dailyexam_date_clist</span> &#123; 2 &#125; &#125;</span><br><span class="line">        <span class="comment">% 至此 year, month 和 day 都已经赋值完毕, 进行合法性检验</span></span><br><span class="line">        <span class="keyword">\__dailyexam_if_legal:</span></span><br><span class="line">      &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">% 如果参数数量不是 2 或 3 个, 那么视为输入格式错误</span></span><br><span class="line">        <span class="keyword">\msg_new:nnn</span> &#123; dailyexam &#125; &#123; date~type~error &#125; </span><br><span class="line">          &#123; You~must~input~&quot;year,month,day&quot;~or~&quot;month,day&quot;~type~argument. &#125;</span><br><span class="line">        <span class="keyword">\msg_error:nn</span> &#123; dailyexam &#125; &#123; date~type~error &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>下面是输出当前日期的函数:</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="comment">% 用来显示当前的日期, 并用 year 参数来决定是否输出 year, 格式为 year.month.day</span></span><br><span class="line"><span class="keyword">\cs_set:Npn</span> <span class="keyword">\__dailyexam_current_date:n</span> <span class="params">#1</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">\str_if_eq:nnT</span> &#123; <span class="params">#1</span> &#125; &#123; year &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">\int_use:N</span> <span class="keyword">\g__dailyexam_year_int</span> .</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="keyword">\int_use:N</span> <span class="keyword">\g__dailyexam_month_int</span> .</span><br><span class="line">    <span class="keyword">\int_use:N</span> <span class="keyword">\g__dailyexam_day_int</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>接下来是用户层的命令:</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="comment">% 输出当前日期的函数 \currentdate</span></span><br><span class="line"><span class="keyword">\NewDocumentCommand</span> &#123; <span class="keyword">\currentdate</span> &#125; &#123; o &#125; &#123; <span class="keyword">\__dailyexam_current_date:n</span> &#123; <span class="params">#1</span> &#125; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">% 设置起始日期的函数 \setdate, 以编译时的系统年月日作为默认值</span></span><br><span class="line"><span class="keyword">\NewDocumentCommand</span> &#123; <span class="keyword">\setdate</span> &#125; &#123; O&#123; <span class="keyword">\int_use:N</span> <span class="keyword">\c_sys_year_int</span>, <span class="keyword">\int_use:N</span> <span class="keyword">\c_sys_month_int</span>, <span class="keyword">\int_use:N</span> <span class="keyword">\c_sys_day_int</span> &#125; &#125;</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">\__dailyexam_setdate:n</span> &#123; <span class="params">#1</span> &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">% 日期加 1 的函数 \nextdate</span></span><br><span class="line"><span class="keyword">\NewDocumentCommand</span> &#123; <span class="keyword">\nextdate</span> &#125; &#123; &#125;</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">\__dailyexam_next_day:</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>由于我们还有页眉的要求, 并需要控制展开的顺序, 所以先将 <code>\fancyhead</code> 与 <code>\section*</code> 设置为 LaTeX3 格式的函数, 同时给 <code>\section*</code> 加入了目录</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="comment">% 将 \fancyhead, \section* 设置为 l3 格式的函数</span></span><br><span class="line"><span class="keyword">\cs_new:Npn</span> <span class="keyword">\fancyhdr_fancyhead:nn</span> <span class="params">#1</span><span class="params">#2</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">\fancyhead</span>[<span class="params">#1</span>]&#123;<span class="params">#2</span>&#125;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">\cs_new:Npn</span> <span class="keyword">\section_star:n</span> <span class="params">#1</span> </span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">\section</span>*&#123; <span class="params">#1</span> &#125;</span><br><span class="line">    <span class="keyword">\addcontentsline</span>&#123;toc&#125;&#123;section&#125;&#123;<span class="params">#1</span>&#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>最后是目标中的两个函数 <code>\examsection</code> 和 <code>\answersection</code>:</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="comment">% 用来输出题目的节标题, 不带节序号, 带星号的版本会输出 year</span></span><br><span class="line"><span class="comment">% \answersection 同理</span></span><br><span class="line"><span class="keyword">\NewDocumentCommand</span> &#123; <span class="keyword">\examsection</span> &#125; &#123; s &#125; </span><br><span class="line">  &#123; </span><br><span class="line">    <span class="keyword">\clearpage</span> </span><br><span class="line">    <span class="comment">% 将由星号控制的日期格式存入临时 tl 变量</span></span><br><span class="line">    <span class="keyword">\tl_set:Nn</span> <span class="keyword">\l_tmpa_tl</span> </span><br><span class="line">      &#123; </span><br><span class="line">        <span class="keyword">\IfBooleanTF</span> &#123; <span class="params">#1</span> &#125; </span><br><span class="line">          &#123; <span class="keyword">\__dailyexam_current_date:n</span> &#123; year &#125; &#125; </span><br><span class="line">          &#123; <span class="keyword">\__dailyexam_current_date:n</span> &#123; &#125; &#125; </span><br><span class="line">      &#125;</span><br><span class="line">    <span class="comment">% 控制宏展开来输出节标题与设置页眉</span></span><br><span class="line">    <span class="keyword">\exp_args:Nx</span> <span class="keyword">\section_star:n</span> &#123; Exercise~of~<span class="keyword">\tl_use:N</span> <span class="keyword">\l_tmpa_tl</span> &#125; </span><br><span class="line">    <span class="keyword">\exp_args:Nnx</span> <span class="keyword">\fancyhdr_fancyhead:nn</span> &#123; L &#125; &#123; Exercise~of~<span class="keyword">\tl_use:N</span> <span class="keyword">\l_tmpa_tl</span> &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\NewDocumentCommand</span> &#123; <span class="keyword">\answersection</span> &#125; &#123; s &#125; </span><br><span class="line">  &#123; </span><br><span class="line">    <span class="keyword">\clearpage</span> </span><br><span class="line">    <span class="keyword">\tl_set:Nn</span> <span class="keyword">\l_tmpa_tl</span> </span><br><span class="line">    &#123; <span class="keyword">\IfBooleanTF</span> &#123; <span class="params">#1</span> &#125; </span><br><span class="line">        &#123; <span class="keyword">\__dailyexam_current_date:n</span> &#123; year &#125; &#125; </span><br><span class="line">        &#123; <span class="keyword">\__dailyexam_current_date:n</span> &#123; &#125; &#125; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">\exp_args:Nx</span> <span class="keyword">\section_star:n</span> &#123; Answer~of~<span class="keyword">\tl_use:N</span> <span class="keyword">\l_tmpa_tl</span> &#125; </span><br><span class="line">    <span class="comment">% 这里是要控制宏展开的关键, 页眉会在函数结束后再输出, </span></span><br><span class="line">    <span class="comment">% 由于 \__dailyexam_next_date: 的作用, 在输出页眉的时候日期已经到达下一天</span></span><br><span class="line">    <span class="comment">% 所以要提前展开 \l_tmpa_tl</span></span><br><span class="line">    <span class="keyword">\exp_args:Nnx</span> <span class="keyword">\fancyhdr_fancyhead:nn</span> &#123; L &#125; &#123; Answer~of~<span class="keyword">\tl_use:N</span> <span class="keyword">\l_tmpa_tl</span> &#125;</span><br><span class="line">    <span class="comment">% 一天的答案写完后将日期推进一天, 来为下一次的 \examsection 做准备</span></span><br><span class="line">    <span class="keyword">\__dailyexam_next_date:</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h2 id="完整代码"><a href="#完整代码" class="headerlink" title="完整代码"></a>完整代码</h2><p>读者可自行更改 <code>\setdate</code> 的参数来查看 <code>\msg_error</code> 的效果. 为了节约空间, 输出省略了大片的空白</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;article&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;fancyhdr&#125;</span><br><span class="line"><span class="keyword">\pagestyle</span>&#123;fancy&#125;</span><br><span class="line"><span class="keyword">\fancyhf</span>&#123;&#125;</span><br><span class="line"><span class="keyword">\fancyhead</span>[R]&#123;<span class="keyword">\thepage</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\ExplSyntaxOn</span></span><br><span class="line"><span class="comment">% 将 \fancyhead, \section* 设置为 l3 格式的函数</span></span><br><span class="line"><span class="keyword">\cs_new:Npn</span> <span class="keyword">\fancyhdr_fancyhead:nn</span> <span class="params">#1</span><span class="params">#2</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">\fancyhead</span>[<span class="params">#1</span>]&#123;<span class="params">#2</span>&#125;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">\cs_new:Npn</span> <span class="keyword">\section_star:n</span> <span class="params">#1</span> </span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">\section</span>*&#123; <span class="params">#1</span> &#125;</span><br><span class="line">    <span class="keyword">\addcontentsline</span>&#123;toc&#125;&#123;section&#125;&#123;<span class="params">#1</span>&#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">% 定义年, 月, 日, 后文注释中用 year, month, day 来指代</span></span><br><span class="line"><span class="keyword">\int_new:N</span> <span class="keyword">\g__dailyexam_year_int</span></span><br><span class="line"><span class="keyword">\int_new:N</span> <span class="keyword">\g__dailyexam_month_int</span></span><br><span class="line"><span class="keyword">\int_new:N</span> <span class="keyword">\g__dailyexam_day_int</span></span><br><span class="line"><span class="comment">% 定义最大的月数, 每月的最大天数, 以及特殊的二月的天数</span></span><br><span class="line"><span class="keyword">\int_new:N</span> <span class="keyword">\c__dailyexam_month_max_int</span></span><br><span class="line"><span class="keyword">\int_set:Nn</span> <span class="keyword">\c__dailyexam_month_max_int</span> &#123; 12 &#125;</span><br><span class="line"><span class="keyword">\int_new:N</span> <span class="keyword">\l__dailyexam_day_max_int</span></span><br><span class="line"><span class="keyword">\int_new:N</span> <span class="keyword">\l__dailyexam_day_feb_max_int</span></span><br><span class="line"><span class="comment">% 定义用来接受 \setdate 的参数的 clist</span></span><br><span class="line"><span class="keyword">\clist_new:N</span> <span class="keyword">\l__dailyexam_date_clist</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">\prop_const_from_keyval:Nn</span> <span class="keyword">\c__dailyexam_month_prop</span></span><br><span class="line">  &#123;</span><br><span class="line">    &#123; 1 &#125; = &#123; January &#125;,</span><br><span class="line">    &#123; 2 &#125; = &#123; February &#125;,</span><br><span class="line">    &#123; 3 &#125; = &#123; March &#125;, </span><br><span class="line">    &#123; 4 &#125; = &#123; April &#125;, </span><br><span class="line">    &#123; 5 &#125; = &#123; May &#125;, </span><br><span class="line">    &#123; 6 &#125; = &#123; June &#125;, </span><br><span class="line">    &#123; 7 &#125; = &#123; July &#125;,</span><br><span class="line">    &#123; 8 &#125; = &#123; August &#125;,</span><br><span class="line">    &#123; 9 &#125; = &#123; September &#125;,</span><br><span class="line">    &#123; 10 &#125; = &#123; October &#125;, </span><br><span class="line">    &#123; 11 &#125; = &#123; November &#125;, </span><br><span class="line">    &#123; 12 &#125; = &#123; December&#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\msg_new:nnn</span> &#123; dailyexam &#125; &#123; year~is~illegal &#125; &#123; &quot;year&quot;~must~later~than~1582 &#125;</span><br><span class="line"><span class="keyword">\msg_new:nnn</span> &#123; dailyexam &#125; &#123; month~is~illegal &#125; &#123; &quot;month&quot;~must~be~integer~among~1,~2,~3,...,~12 &#125;</span><br><span class="line"><span class="keyword">\msg_new:nnn</span> &#123; dailyexam &#125; &#123; day~is~illegal &#125; &#123; <span class="params">#1</span>~of~<span class="params">#2</span>~has~only~<span class="params">#3</span>~days, <span class="keyword">\\</span></span><br><span class="line">                                                &quot;day&quot;~must~be~integer~among~1,~2,~3,...,~<span class="params">#3</span> &#125;</span><br><span class="line"><span class="comment">% 示例输出为</span></span><br><span class="line"><span class="comment">% ! Package dailyexam Error: February of 2022 has only 28 days,</span></span><br><span class="line"><span class="comment">% (dailyexam)                &quot;day&quot; must be integer among 1, 2, 3,..., 28</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% 设置 month 月份下最大的天数 day_max,</span></span><br><span class="line"><span class="keyword">\cs_new:Nn</span> <span class="keyword">\__dailyexam_set_max_day:</span> </span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">% 首先根据大小月规则来设置除二月外的 day_max</span></span><br><span class="line">    <span class="keyword">\int_case:nnT</span> &#123; <span class="keyword">\g__dailyexam_month_int</span> &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        &#123; 1 &#125; &#123; &#125;</span><br><span class="line">        &#123; 3 &#125; &#123; &#125;</span><br><span class="line">        &#123; 5 &#125; &#123; &#125;</span><br><span class="line">        &#123; 7 &#125; &#123; &#125;</span><br><span class="line">        &#123; 8 &#125; &#123; &#125;</span><br><span class="line">        &#123; 10 &#125; &#123; &#125;</span><br><span class="line">        &#123; 12 &#125; &#123; &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">\int_set:Nn</span> <span class="keyword">\l__dailyexam_day_max_int</span> &#123; 31 &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">\int_case:nnT</span> &#123; <span class="keyword">\g__dailyexam_month_int</span> &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        &#123; 4 &#125; &#123; &#125;</span><br><span class="line">        &#123; 6 &#125; &#123; &#125;</span><br><span class="line">        &#123; 9 &#125; &#123; &#125;</span><br><span class="line">        &#123; 11 &#125; &#123; &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">\int_set:Nn</span> <span class="keyword">\l__dailyexam_day_max_int</span> &#123; 30 &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">\int_compare:nNnTF</span> &#123; <span class="keyword">\g__dailyexam_year_int</span> &#125; &lt; &#123; 1582 &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">% 如果被判断的年在 1582 年之前, 则输出报错信息</span></span><br><span class="line">        <span class="keyword">\msg_error:nn</span> &#123; dailyexam &#125; &#123; year~is~illegal &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">% 如果被判断的年在 1582 年之后, 则需要判断该年是否是闰年</span></span><br><span class="line">        <span class="comment">% 规则为: 如果年份能被 100 整除, 则它需要整除 400;</span></span><br><span class="line">        <span class="comment">%         如果年份不能被 100 整除, 则它需要整除 4;</span></span><br><span class="line">        <span class="comment">%         以上两种情况为闰年, 二月有 29 天</span></span><br><span class="line">        <span class="comment">%         否则该年为平年, 二月有 28 天</span></span><br><span class="line">        <span class="keyword">\bool_if:nTF</span> </span><br><span class="line">          &#123;</span><br><span class="line">            (</span><br><span class="line">              <span class="keyword">\int_compare_p:nNn</span> &#123; <span class="keyword">\int_mod:nn</span> &#123; <span class="keyword">\g__dailyexam_year_int</span> &#125; &#123; 100 &#125; &#125; = &#123; 0 &#125; <span class="built_in">&amp;</span><span class="built_in">&amp;</span> </span><br><span class="line">              <span class="keyword">\int_compare_p:nNn</span> &#123; <span class="keyword">\int_mod:nn</span> &#123; <span class="keyword">\g__dailyexam_year_int</span> &#125; &#123; 400 &#125; &#125; = &#123; 0 &#125;</span><br><span class="line">            ) </span><br><span class="line">            ||</span><br><span class="line">            (</span><br><span class="line">              ! <span class="keyword">\int_compare_p:nNn</span> &#123; <span class="keyword">\int_mod:nn</span> &#123; <span class="keyword">\g__dailyexam_year_int</span> &#125; &#123; 100 &#125; &#125; = &#123; 0 &#125; <span class="built_in">&amp;</span><span class="built_in">&amp;</span></span><br><span class="line">              <span class="keyword">\int_compare_p:nNn</span> &#123; <span class="keyword">\int_mod:nn</span> &#123; <span class="keyword">\g__dailyexam_year_int</span> &#125; &#123; 4 &#125; &#125; = &#123; 0 &#125;</span><br><span class="line">            )</span><br><span class="line">          &#125;</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">\int_set:Nn</span> <span class="keyword">\l__dailyexam_day_feb_max_int</span> &#123; 29 &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">\int_set:Nn</span> <span class="keyword">\l__dailyexam_day_feb_max_int</span> &#123; 28 &#125;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="comment">% 判断该月是否为二月, 如果是, 就把 day_max设置为二月 day_max</span></span><br><span class="line">    <span class="keyword">\int_compare:nNnT</span> &#123; <span class="keyword">\g__dailyexam_month_int</span> &#125; = &#123; 2 &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">\int_set_eq:NN</span> <span class="keyword">\l__dailyexam_day_max_int</span> <span class="keyword">\l__dailyexam_day_feb_max_int</span></span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">% 将日期改为下一天, 注意这里的日期更改都需要是全局的, 否则在 \section 的参数中表现为局部变化 </span></span><br><span class="line"><span class="keyword">\cs_new:Nn</span> <span class="keyword">\__dailyexam_next_date:</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">% 判断 day 是否等于当月的 day_max</span></span><br><span class="line">    <span class="keyword">\int_compare:nNnTF</span> &#123; <span class="keyword">\g__dailyexam_day_int</span> &#125; = &#123; <span class="keyword">\l__dailyexam_day_max_int</span> &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">% 如果日期等于 day_max, 那么进入了新的一个月, 将 day 重设为 1</span></span><br><span class="line">        <span class="keyword">\int_gset:Nn</span> <span class="keyword">\g__dailyexam_day_int</span> &#123; 1 &#125;</span><br><span class="line">        <span class="keyword">\int_compare:nNnTF</span> &#123; <span class="keyword">\g__dailyexam_month_int</span> &#125; = &#123; <span class="keyword">\c__dailyexam_month_max_int</span> &#125;</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="comment">% 如果这时是十二月, 即该天为 12.31, </span></span><br><span class="line">            <span class="comment">% 那么进入了新的一年, 将 month 重设为 1, 并将 year 加 1 </span></span><br><span class="line">            <span class="keyword">\int_gset:Nn</span> <span class="keyword">\g__dailyexam_month_int</span> &#123; 1 &#125;</span><br><span class="line">            <span class="keyword">\int_gincr:N</span> <span class="keyword">\g__dailyexam_year_int</span></span><br><span class="line">          &#125;</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="comment">% 如果不是十二月, 那么只需要将 month 加 1</span></span><br><span class="line">            <span class="keyword">\int_gincr:N</span> <span class="keyword">\g__dailyexam_month_int</span></span><br><span class="line">          &#125;</span><br><span class="line">        <span class="comment">% 只要进入了新的一个月, 就需要重新设置 day_max</span></span><br><span class="line">        <span class="keyword">\__dailyexam_set_max_day:</span> </span><br><span class="line">      &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">% 如果 day 不等于 day_max, 那么只需要将 day 加 1</span></span><br><span class="line">        <span class="keyword">\int_gincr:N</span> <span class="keyword">\g__dailyexam_day_int</span></span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">% 判断 \setdate 所接受的日期是否合法</span></span><br><span class="line"><span class="keyword">\cs_new:Nn</span> <span class="keyword">\__dailyexam_if_legal:</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">% 首先是对 year 的判断, 同上</span></span><br><span class="line">    <span class="keyword">\int_compare:nNnT</span> &#123; <span class="keyword">\g__dailyexam_year_int</span> &#125; &lt; &#123; 1582 &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">\msg_error:nn</span> &#123; dailyexam &#125; &#123; year~is~illegal &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="comment">% 判断 month 是否是在 1 -- 12 之间</span></span><br><span class="line">    <span class="keyword">\int_compare:nTF</span></span><br><span class="line">      &#123;</span><br><span class="line">        0 &lt; <span class="keyword">\g__dailyexam_month_int</span> &lt;= <span class="keyword">\c__dailyexam_month_max_int</span></span><br><span class="line">      &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">% 如果 month 合法, 那么就可以设置当月的 day_max, 用来对 day 进行判断</span></span><br><span class="line">        <span class="keyword">\__dailyexam_set_max_day:</span></span><br><span class="line">      &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">% 如果 month 不合法, 输出报错信息</span></span><br><span class="line">        <span class="keyword">\msg_error:nn</span> &#123; dailyexam &#125; &#123; month~is~illegal &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="comment">% 判断 day 是否在 1 -- day_max 之间</span></span><br><span class="line">    <span class="keyword">\int_compare:nF</span></span><br><span class="line">      &#123;</span><br><span class="line">        0 &lt; <span class="keyword">\g__dailyexam_day_int</span> &lt;= <span class="keyword">\l__dailyexam_day_max_int</span></span><br><span class="line">      &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">% 如果 day 不合法, 输出报错信息, 报错信息的示例在 \mas_new 部分</span></span><br><span class="line">        <span class="keyword">\exp_args:NNx</span> <span class="keyword">\prop_get:NnN</span> <span class="keyword">\c__dailyexam_month_prop</span> </span><br><span class="line">          &#123; <span class="keyword">\int_use:N</span> <span class="keyword">\g__dailyexam_month_int</span> &#125; </span><br><span class="line">          <span class="keyword">\l_tmpb_tl</span></span><br><span class="line">        <span class="keyword">\msg_error:nnxxx</span> &#123; dailyexam &#125; &#123; day~is~illegal &#125; </span><br><span class="line">          &#123; <span class="keyword">\tl_use:N</span> <span class="keyword">\l_tmpb_tl</span> &#125; </span><br><span class="line">          &#123; <span class="keyword">\int_use:N</span> <span class="keyword">\g__dailyexam_year_int</span> &#125; </span><br><span class="line">          &#123; <span class="keyword">\int_use:N</span> <span class="keyword">\l__dailyexam_day_max_int</span> &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">% 这里设置另一个重要的函数, 设置起始日期</span></span><br><span class="line"><span class="comment">% 我们规定输入的参数为一个逗号分隔列表 clist</span></span><br><span class="line"><span class="keyword">\cs_new:Npn</span> <span class="keyword">\__dailyexam_setdate:n</span> <span class="params">#1</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">% 将参数传入 clist, 参数是否合法在赋值后判断</span></span><br><span class="line">    <span class="keyword">\clist_set:Nn</span> <span class="keyword">\l__dailyexam_date_clist</span> &#123; <span class="params">#1</span> &#125;</span><br><span class="line">    <span class="keyword">\int_case:nnTF</span> &#123; <span class="keyword">\clist_count:N</span> <span class="keyword">\l__dailyexam_date_clist</span> &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">% 如果参数列表里有三项, 也就是对应着 year, month, day,</span></span><br><span class="line">        <span class="comment">% 那么将第一项设置为 year, 再将第一项 pop 到一个不再使用的临时变量中,</span></span><br><span class="line">        <span class="comment">% 来保证现在的 clist 中剩余 month 和 day</span></span><br><span class="line">        <span class="comment">% 注意, 这里我们不能直接用 \l_tmpa_tl 来对 year 赋值, 因为数据类型不同</span></span><br><span class="line">        &#123; 3 &#125; </span><br><span class="line">        &#123; </span><br><span class="line">          <span class="keyword">\exp_args:NNx</span> <span class="keyword">\int_gset:Nn</span> <span class="keyword">\g__dailyexam_year_int</span> </span><br><span class="line">            &#123; <span class="keyword">\clist_item:Nn</span> <span class="keyword">\l__dailyexam_date_clist</span> &#123; 1 &#125; &#125;</span><br><span class="line">          <span class="keyword">\clist_pop:NN</span> <span class="keyword">\l__dailyexam_date_clist</span> <span class="keyword">\l_tmpa_tl</span> </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">% 如果参数列表中有两项, 对应着 month, day,</span></span><br><span class="line">        <span class="comment">% 这时候将 year 设置为编译时的系统年份</span></span><br><span class="line">        &#123; 2 &#125; &#123; <span class="keyword">\int_gset_eq:NN</span> <span class="keyword">\g__dailyexam_year_int</span> <span class="keyword">\c_sys_year_int</span> &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">% 经过上两步的筛选, 可以保证此时 clist 中只有两项: month 和 day</span></span><br><span class="line">        <span class="comment">% 再将它们赋值到 month 和 day</span></span><br><span class="line">        <span class="keyword">\exp_args:NNx</span> <span class="keyword">\int_gset:Nn</span> <span class="keyword">\g__dailyexam_month_int</span> </span><br><span class="line">          &#123; <span class="keyword">\clist_item:Nn</span> <span class="keyword">\l__dailyexam_date_clist</span> &#123; 1 &#125; &#125;</span><br><span class="line">        <span class="keyword">\exp_args:NNx</span> <span class="keyword">\int_gset:Nn</span> <span class="keyword">\g__dailyexam_day_int</span> </span><br><span class="line">          &#123; <span class="keyword">\clist_item:Nn</span> <span class="keyword">\l__dailyexam_date_clist</span> &#123; 2 &#125; &#125;</span><br><span class="line">        <span class="comment">% 至此 year, month 和 day 都已经赋值完毕, 进行合法性检验</span></span><br><span class="line">        <span class="keyword">\__dailyexam_if_legal:</span></span><br><span class="line">      &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">% 如果参数数量不是 2 或 3 个, 那么视为输入格式错误</span></span><br><span class="line">        <span class="keyword">\msg_new:nnn</span> &#123; dailyexam &#125; &#123; date~type~error &#125; </span><br><span class="line">          &#123; You~must~input~&quot;year,month,day&quot;~or~&quot;month,day&quot;~type~argument. &#125;</span><br><span class="line">        <span class="keyword">\msg_error:nn</span> &#123; dailyexam &#125; &#123; date~type~error &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">% 用来显示当前的日期, 并用 year 参数来决定是否输出 year, 格式为 year.month.day</span></span><br><span class="line"><span class="keyword">\cs_set:Npn</span> <span class="keyword">\__dailyexam_current_date:n</span> <span class="params">#1</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">\str_if_eq:nnT</span> &#123; <span class="params">#1</span> &#125; &#123; year &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">\int_use:N</span> <span class="keyword">\g__dailyexam_year_int</span> .</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="keyword">\int_use:N</span> <span class="keyword">\g__dailyexam_month_int</span> .</span><br><span class="line">    <span class="keyword">\int_use:N</span> <span class="keyword">\g__dailyexam_day_int</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">%%% 以下是用户层命令</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% 输出当前日期的函数 \currentdate</span></span><br><span class="line"><span class="keyword">\NewDocumentCommand</span> &#123; <span class="keyword">\currentdate</span> &#125; &#123; o &#125; &#123; <span class="keyword">\__dailyexam_current_date:n</span> &#123; <span class="params">#1</span> &#125; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">% 设置起始日期的函数 \setdate, 以编译时的系统年月日作为默认值</span></span><br><span class="line"><span class="keyword">\NewDocumentCommand</span> &#123; <span class="keyword">\setdate</span> &#125; &#123; O&#123; <span class="keyword">\int_use:N</span> <span class="keyword">\c_sys_year_int</span>, <span class="keyword">\int_use:N</span> <span class="keyword">\c_sys_month_int</span>, <span class="keyword">\int_use:N</span> <span class="keyword">\c_sys_day_int</span> &#125; &#125;</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">\__dailyexam_setdate:n</span> &#123; <span class="params">#1</span> &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">% 日期加 1 的函数 \nextdate</span></span><br><span class="line"><span class="keyword">\NewDocumentCommand</span> &#123; <span class="keyword">\nextdate</span> &#125; &#123; &#125;</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">\__dailyexam_next_date:</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">% 用来输出题目的节标题, 不带节序号, 带星号的版本会输出 year</span></span><br><span class="line"><span class="comment">% \answersection 同理</span></span><br><span class="line"><span class="keyword">\NewDocumentCommand</span> &#123; <span class="keyword">\examsection</span> &#125; &#123; s &#125; </span><br><span class="line">  &#123; </span><br><span class="line">    <span class="keyword">\clearpage</span> </span><br><span class="line">    <span class="comment">% 将由星号控制的日期格式存入临时 tl 变量</span></span><br><span class="line">    <span class="keyword">\tl_set:Nn</span> <span class="keyword">\l_tmpa_tl</span> </span><br><span class="line">      &#123; </span><br><span class="line">        <span class="keyword">\IfBooleanTF</span> &#123; <span class="params">#1</span> &#125; </span><br><span class="line">          &#123; <span class="keyword">\__dailyexam_current_date:n</span> &#123; year &#125; &#125; </span><br><span class="line">          &#123; <span class="keyword">\__dailyexam_current_date:n</span> &#123; &#125; &#125; </span><br><span class="line">      &#125;</span><br><span class="line">    <span class="comment">% 控制宏展开来输出节标题与设置页眉</span></span><br><span class="line">    <span class="keyword">\exp_args:Nx</span> <span class="keyword">\section_star:n</span> &#123; Exercise~of~<span class="keyword">\tl_use:N</span> <span class="keyword">\l_tmpa_tl</span> &#125; </span><br><span class="line">    <span class="keyword">\exp_args:Nnx</span> <span class="keyword">\fancyhdr_fancyhead:nn</span> &#123; L &#125; &#123; Exercise~of~<span class="keyword">\tl_use:N</span> <span class="keyword">\l_tmpa_tl</span> &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\NewDocumentCommand</span> &#123; <span class="keyword">\answersection</span> &#125; &#123; s &#125; </span><br><span class="line">  &#123; </span><br><span class="line">    <span class="keyword">\clearpage</span> </span><br><span class="line">    <span class="keyword">\tl_set:Nn</span> <span class="keyword">\l_tmpa_tl</span> </span><br><span class="line">    &#123; <span class="keyword">\IfBooleanTF</span> &#123; <span class="params">#1</span> &#125; </span><br><span class="line">        &#123; <span class="keyword">\__dailyexam_current_date:n</span> &#123; year &#125; &#125; </span><br><span class="line">        &#123; <span class="keyword">\__dailyexam_current_date:n</span> &#123; &#125; &#125; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">\exp_args:Nx</span> <span class="keyword">\section_star:n</span> &#123; Answer~of~<span class="keyword">\tl_use:N</span> <span class="keyword">\l_tmpa_tl</span> &#125; </span><br><span class="line">    <span class="comment">% 这里是要控制宏展开的关键, 页眉会在函数结束后再输出, </span></span><br><span class="line">    <span class="comment">% 由于 \__dailyexam_next_date: 的作用, 在输出页眉的时候日期已经到达下一天</span></span><br><span class="line">    <span class="comment">% 所以要提前展开 \l_tmpa_tl</span></span><br><span class="line">    <span class="keyword">\exp_args:Nnx</span> <span class="keyword">\fancyhdr_fancyhead:nn</span> &#123; L &#125; &#123; Answer~of~<span class="keyword">\tl_use:N</span> <span class="keyword">\l_tmpa_tl</span> &#125;</span><br><span class="line">    <span class="comment">% 一天的答案写完后将日期推进一天, 来为下一次的 \examsection 做准备</span></span><br><span class="line">    <span class="keyword">\__dailyexam_next_date:</span></span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">\ExplSyntaxOff</span></span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"><span class="keyword">\tableofcontents</span></span><br><span class="line"><span class="keyword">\setdate</span>[2022, 2, 28]</span><br><span class="line"><span class="keyword">\examsection</span></span><br><span class="line"><span class="keyword">\answersection</span></span><br><span class="line"><span class="keyword">\examsection</span>*</span><br><span class="line"><span class="keyword">\answersection</span>*</span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/date-function-with-l3/finish.png" alt="成品"></p>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>这是我第一次使用 LaTeX3 做一个稍微像样的东西, 感觉到了比 LaTeX2e 更方便的宏展开, 以及各种规范定义带来的时间上的便利, 最后非常感谢 <a href="https://xkwxdyy.github.io/">夏大鱼羊</a> 在我学习 LaTeX3 的过程中给我提供的帮助.</p>
]]></content>
      <categories>
        <category>LaTeX</category>
        <category>LaTeX3</category>
      </categories>
      <tags>
        <tag>LaTeX</tag>
        <tag>示例</tag>
        <tag>LaTeX3</tag>
      </tags>
  </entry>
  <entry>
    <title>滚动升级 TeXLive</title>
    <url>/2022-04-04-texlive-rolling-update/</url>
    <content><![CDATA[<p>这里说一下如何滚动升级 TeXLive, 而不卸载安装. 由于我也是第一次这么做, 不知道有没有什么可能产生的后果. </p>
<span id="more"></span>
<p>首先, 愿意看官方文档的小伙伴可以直接看<a href="https://www.tug.org/texlive/upgrade.html">官网</a></p>
<h2 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h2><ol>
<li><p>首先我们如果直接使用 <code>tlmgr update -self -all</code> 会得到</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tlmgr.pl: Local TeX Live (2021) is older than remote repository (2022).</span><br><span class="line">Cross release updates are only supported with</span><br><span class="line">  update-tlmgr-latest(.sh/.exe) --update</span><br><span class="line">See https://tug.org/texlive/upgrade.html <span class="keyword">for</span> details.</span><br></pre></td></tr></table></figure>
<p>它说让去 <a href="https://tug.org/texlive/upgrade.html">https://tug.org/texlive/upgrade.html</a> 查看详细信息, 但是 Windows 只给了一句</p>
<blockquote>
<p>There is no comparable upgrade procedure for Windows. Doing a new installation is necessary.</p>
</blockquote>
<p>甚至没有给提供 <code>update-tlmgr-latest.exe</code>, 那我们去 <a href="https://www.tug.org/texlive/tlmgr.html"><code>tlmgr</code> 的官网</a> 看一下有没有, 果然发现了 </p>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/texlive-rolling-update/tlmgr-latest.png" alt="`tlmgr` 官网"></p>
</li>
<li><p>先别急, 我们在 TeXLive 的安装目录里复制复制一份 <code>2021</code> 文件夹, 命名为 <code>2022</code>, 当然也可以直接改名, 但是如果这样做, 一旦 TeXLive 2022 有问题, 那么我们将没有办法回到之前可行的工作环境. 如果觉得文件夹很大, 可以选择不复制 <code>/tlpkg/backups/</code> 文件夹. </p>
</li>
<li><p>将环境变量中的 <code>texlive/2021</code> 改为 <code>texlive/2022</code>.</p>
</li>
<li><p>然后下载 <code>update-tlmgr-latest.exe</code>, 安装, 等到 “Close” 亮起, 点击 “Close” 来关闭安装窗口, 重启命令行. 这时我们再使用 <code>tlmgr update -list</code>, 可以看到</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tlmgr.pl: package repository https://mirrors.tuna.tsinghua.edu.cn/CTAN/systems/texlive/tlnet (not verified: gpg unavailable)</span><br><span class="line">===============================================================================</span><br><span class="line">tlmgr itself needs to be updated.</span><br><span class="line">Please <span class="keyword">do</span> this via either</span><br><span class="line">  tlmgr update --self</span><br><span class="line">or by getting the latest updater <span class="keyword">for</span> Unix-ish systems:</span><br><span class="line">  https://mirror.ctan.org/systems/texlive/tlnet/update-tlmgr-latest.sh</span><br><span class="line">and/or Windows systems:</span><br><span class="line">  https://mirror.ctan.org/systems/texlive/tlnet/update-tlmgr-latest.exe</span><br><span class="line">Then <span class="built_in">continue</span> with other updates as usual.</span><br><span class="line">===============================================================================</span><br><span class="line">tlmgr.pl: would save backups to C:/texlive/2021/tlpkg/backups</span><br><span class="line">keep:     academicons              : <span class="built_in">local</span>:    62623, <span class="built_in">source</span>:    62622</span><br><span class="line">keep:     altsubsup                : <span class="built_in">local</span>:    62739, <span class="built_in">source</span>:    62738</span><br><span class="line">keep:     arara                    : <span class="built_in">local</span>:    62339, <span class="built_in">source</span>:    62298</span><br><span class="line">keep:     asmeconf                 : <span class="built_in">local</span>:    62716, <span class="built_in">source</span>:    62713</span><br><span class="line">keep:     babel                    : <span class="built_in">local</span>:    62203, <span class="built_in">source</span>:    62202</span><br><span class="line">keep:     babel-polish             : <span class="built_in">local</span>:    62681, <span class="built_in">source</span>:    62680</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>这样的输出</p>
<ol>
<li>这时再使用 <code>tlmgr update -self -all</code> 即可完成升级</li>
</ol>
<p><strong>注意</strong> 由于新版的 <code>newtx</code> 宏包的问题依然没有修复, 升级的时候可以选择使用 <code>tlmgr update -self -all -exclude newtx</code> 来忽略它的升级. </p>
<p>  如果出现了问题, 可以读一下 Linux 的部分</p>
<p>  升级后使用 <code>tex -v</code> 来测试版本</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">TeX 3.141592653 (TeX Live 2022)</span><br><span class="line">kpathsea version 6.3.4</span><br><span class="line">Copyright 2022 D.E. Knuth.</span><br><span class="line">There is NO warranty.  Redistribution of this software is</span><br><span class="line">covered by the terms of both the TeX copyright and</span><br><span class="line">the Lesser GNU General Public License.</span><br><span class="line">For more information about these matters, see the file</span><br><span class="line">named COPYING and the TeX source.</span><br><span class="line">Primary author of TeX: D.E. Knuth.</span><br></pre></td></tr></table></figure>
<ol>
<li><p>完成宏包更新之后, 终端运行 </p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">luaotfload-tool -fu</span><br></pre></td></tr></table></figure>
<p> 来完成 <code>lualatex</code> 的字体配置 (或者叫刷新? 我几乎没用过 <code>lualatex</code>, 对它也不了解)</p>
</li>
</ol>
<h2 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h2><ol>
<li><p>首先终端进入 <code>/texlive</code> 文件夹, 运行 <code>cp -a ./2021/ ./2022/</code>, 这里同样可以重新命名, 但是不推荐, 理由同上.</p>
</li>
<li><p>然后在 <code>~/.bashrc</code> 或 <code>~/.zshrc</code> 中将 TeXLive 相关的环境变量中的 <code>2021</code> 改为 <code>2022</code>. </p>
</li>
<li>下载 <code>tlmgr-update-latest.sh</code>, 不是必须放入 <code>texlive</code> 文件夹. (这里我是将 TeXLive 安装在了 <code>~</code> 目录下, 我不知道如果安装在 <code>/usr/local/texlive</code> 是不是也可行, 欢迎反馈.)<br><strong>注意</strong> <a href="https://www.tug.org/texlive/upgrade.html">https://www.tug.org/texlive/upgrade.html</a> 提供的 <code>tlmgr-update-latest.sh</code> 是过时的, 需要在 <a href="https://www.tug.org/texlive/tlmgr.html"><code>tlmgr</code>官网</a> 或者直接去<a href="https://mirrors.tuna.tsinghua.edu.cn/CTAN/systems/texlive/tlnet/">清华的镜像</a> 进行下载. (话说这个过时的问题在 2019 年就有人提过, 见 <a href="https://latex.org/forum/viewtopic.php?t=32463">latex.org</a>, 莫非是现在又不更新了?)</li>
<li><p>重启终端, 进入 <code>texlive/2022/</code> 文件夹, 运行</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sh update-tlmgr-latest.sh -- --upgrade</span><br></pre></td></tr></table></figure>
<p> 如果显示了 <code>sing --upgrade doesn&#39;t make sense; terminating.</code>, 说明下载的 <code>.sh</code> 文件不是最新的</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">    Verifying archive integrity... All good.</span><br><span class="line">Uncompressing TeX Live Manager Updater  100%  </span><br><span class="line">./runme.sh: updating <span class="keyword">in</span> /home/syvshclily/texlive/2022...</span><br><span class="line">./runme.sh: tlmgr version says this is TeX Live 2022,</span><br><span class="line">./runme.sh: and this updater script created: Tue Mar  1 02:52:57 CET 2022.</span><br><span class="line">./runme.sh: have TL 2021, new version also 2021;</span><br><span class="line">./runme.sh: using --upgrade doesn<span class="string">&#x27;t make sense; terminating.</span></span><br><span class="line"><span class="string">(./runme.sh: makeself creation date = Tue Mar  1 02:52:57 CET 2022.)</span></span><br></pre></td></tr></table></figure>
<p> 如果有如下的输出, 则说明运行正常:</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Verifying archive integrity... All good.</span><br><span class="line">Uncompressing TeX Live Manager Updater  100%  </span><br><span class="line">./runme.sh: updating <span class="keyword">in</span> /home/syvshclily/texlive/2022...</span><br><span class="line">./runme.sh: tlmgr version says this is TeX Live 2021,</span><br><span class="line">./runme.sh: and this updater script created: Tue Mar  1 02:52:57 CET 2022.</span><br><span class="line">./runme.sh: ok, doing full release upgrade  from 2021 to 2022.</span><br><span class="line">./runme.sh: updating /home/syvshclily/texlive/2022/bin/x86_64-linux ...</span><br><span class="line">./runme.sh: /home/syvshclily/texlive/2022/bin/x86_64-linux/tlmgr including objects: master/tlpkg/tlpobj/texlive.infra.tlpobj master/tlpkg/tlpobj/texlive.infra.x86_64-linux.tlpobj</span><br><span class="line">D:appending to package <span class="built_in">log</span> file: /home/syvshclily/texlive/2022/texmf-var/web2c/tlmgr.log</span><br><span class="line">D:appending to <span class="built_in">command</span> <span class="built_in">log</span> file: /home/syvshclily/texlive/2022/texmf-var/web2c/tlmgr-commands.log</span><br><span class="line">D:tlmgr:main: ::tldownload_server <span class="built_in">hash</span>:: &#123;enabled:1,errorcount:0,initcount:1,ua:LWP::UserAgent=HASH(0x561de626d708)&#125;</span><br><span class="line">D:setup_programs: preferring system versions</span><br><span class="line">D:program curl found <span class="keyword">in</span> path</span><br><span class="line">D:program wget found <span class="keyword">in</span> path</span><br><span class="line">D:TLUtils::setup_programs: checking <span class="keyword">for</span> ssl enabled wget</span><br><span class="line">D:TLUtils::setup_programs: wget has ssl, final wget args: --no-check-certificate --user-agent=texlive/wget --tries=4 --timeout=30 -q -O</span><br><span class="line">D:program lz4 found <span class="keyword">in</span> path</span><br><span class="line">D:program gzip found <span class="keyword">in</span> path</span><br><span class="line">D:program xz found <span class="keyword">in</span> path</span><br><span class="line">./runme.sh: <span class="keyword">done</span>.</span><br></pre></td></tr></table></figure>
</li>
<li><p>因为运行完 <code>.sh</code> 程序后, <code>tlmgr</code> 会自动将源修改为 <code>mirrors.ctan.org</code> 终端运行 <code>tlmgr update -list</code>, 如果有正确输出 (见 Windows 部分), 表示可以更新, 可以在终端运行</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tlmgr update -self -all</span><br></pre></td></tr></table></figure>
<p> 来更新全部宏包, 同样由于 <code>newtx</code> 宏包的问题, 可以使用</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tlmgr update -self -all -exclude newtx</span><br></pre></td></tr></table></figure>
<p> 来忽略该宏包的更新.</p>
<p> 在更新宏包的过程中, 如果网络有波动, 有可能出现 </p>
 <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tlmgr: An error has occurred. See above messages. Exiting.</span><br></pre></td></tr></table></figure>
<p> 这时候可以向上翻一下命令行输出, 我这里是如下的错误</p>
 <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[187/258, 06:36/08:31] update: texlive-common [599k] (62149 -&gt; 62748) ... TLPDB::_install_data: downloading did not succeed (download_file failed) for https://mirrors.tuna.tsinghua.edu.cn/CTAN/systems/texlive/tlnet/archive/texlive-common.tar.xz</span><br><span class="line">tlmgr: Installation of new version of texlive-common failed, trying to unwind.</span><br><span class="line">tlmgr: Restoring old package state succeeded.</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
<p> 即某些宏包下载失败, 可以再运行</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tlmgr update -all -reinstall-forcibly-removed</span><br></pre></td></tr></table></figure>
<p> 来完成更新, 同样可以加上 <code>-exclude newtx</code> 参数来忽略 <code>newtx</code> 的更新.</p>
</li>
<li><p>完成宏包更新之后, 终端运行 </p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">luaotfload-tool -fu</span><br></pre></td></tr></table></figure>
<p> 来完成 <code>lualatex</code> 的字体配置 (或者叫刷新? 我几乎没用过 <code>lualatex</code>, 对它也不了解)</p>
</li>
<li><p>然后将安装的时候的字体文件内容进行改动, 如果是在用户文件夹中, 路径可能为 <code>~/.fonts.conf/09-texlive.conf</code>; 如果在系统文件夹, 路径可能为 <code>/etc/fonts/conf.d/09-texlive.conf</code>. 将其中的 <code>texlive/2021/</code> 修改为 <code>texlive/2022</code>. 或者直接将 <code>texlive/2022/texmf-var/fonts/conf/texlive-fontconfig.conf</code> 复制到上述文件夹, 命名为 <code>09-texlive.conf</code>, 其操作与安装 TeXLive 时是相同的. 然后在终端执行</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo fc-cache -fsv</span><br></pre></td></tr></table></figure>
<p> 来刷新字体缓存. </p>
</li>
</ol>
]]></content>
      <categories>
        <category>帮助文档</category>
        <category>LaTeX</category>
      </categories>
      <tags>
        <tag>帮助文档</tag>
        <tag>LaTeX</tag>
        <tag>tlmgr</tag>
      </tags>
  </entry>
  <entry>
    <title>在终端中编译 LaTeX</title>
    <url>/2022-03-06-latex-terminal-compiling/</url>
    <content><![CDATA[<p>在交流使用 LaTeX 出现的问题的时候, 通常会听到”命令行编译”或”终端编译”, 在这里简单的介绍一下. 如果有相应的命令行基础, 可以直接跳转到<a href="#compile-latex">使用命令行编译 LaTeX 文件</a></p>
<span id="more"></span>
<h2 id="什么是命令行-终端"><a href="#什么是命令行-终端" class="headerlink" title="什么是命令行/终端"></a>什么是命令行/终端</h2><p>这里直接引用<a href="https://zh.wikipedia.org/wiki/%E7%B5%82%E7%AB%AF">Wiki</a>, 这里不详细区分”终端”, “Shell” 与”命令行界面” <sup><a href="#fn_shell-and-terminal" id="reffn_shell-and-terminal">shell-and-terminal</a></sup>. Windows 下有”命令提示符”, “powershell” (这两个严格来说不算是终端, Windows Terminal 才是); Linux 下有 “GNOME-terminal”, “Konsole”, macOS有……终端. </p>
<blockquote id="fn_shell-and-terminal">
<sup>shell-and-terminal</sup>. <a href="https://www.zhihu.com/question/26860370">Windows 的 PowerShell 和 Linux 的 terminal 有啥区别？ - 知乎</a><a href="#reffn_shell-and-terminal" title="Jump back to footnote [shell-and-terminal] in the text."> &#8617;</a>
</blockquote>
<h2 id="如何打开命令行-终端"><a href="#如何打开命令行-终端" class="headerlink" title="如何打开命令行/终端"></a>如何打开命令行/终端</h2><h3 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h3><p>Linux 通常可以通过 <code>ctrl</code>+<code>alt</code>+<code>T</code> 的快捷键组合打开终端.</p>
<h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h3><ol>
<li><p>Windows10/11 可以点击状态栏中的”搜索”或快捷键<code>win</code>+<code>S</code>, 并在搜索栏里搜索 “cmd” 或 “powershell”, 可以选择直接左键点击打开, 也可以选择右键<code>以管理员身份运行</code>, 以管理员身份运行的命令行的权限更高.<sup><a href="#fn_permission" id="reffn_permission">permission</a></sup></p>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/latex-terminal-compiling/cmd-on-win%2Bs.gif" alt="win+S"></p>
</li>
<li><p>可以在”文件资源管理器”的地址栏中直接输入 “cmd” 或 “powershell” 并回车, 就可以在当前文件夹中打开命令行. </p>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/latex-terminal-compiling/click.gif" alt="点击文件资源管理器"></p>
</li>
<li><p>可以在”文件资源管理器”的空白处按住<code>shift</code>再点击右键, 选择选项”在此处打开 PowerShell 窗口”, 就可以在当前文件夹中打开 powershell. 当然 Windows11 用户或者安装了 Windows Terminal 的用户也可以通过右键后选择”在 Windows 终端中打开”. </p>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/latex-terminal-compiling/shift-right-click.gif" alt="shift+右键"></p>
</li>
</ol>
<h3 id="mac"><a href="#mac" class="headerlink" title="mac"></a>mac</h3><p>同时按下 <code>command</code> 和空格, 在弹出的输入栏里输入 <code>terminal</code> 即可打开, 或见苹果的<a href="https://support.apple.com/zh-cn/guide/terminal/apd5265185d-f365-44cb-8b09-71a064a42125/mac">官方说明</a></p>
<h2 id="使用命令行-终端"><a href="#使用命令行-终端" class="headerlink" title="使用命令行/终端"></a>使用命令行/终端</h2><h4 id="Linux-1"><a href="#Linux-1" class="headerlink" title="Linux"></a>Linux</h4><p>(我认为 Linux 用户不熟悉基础的终端操作是不合格的, 这里还是贴一个 <a href="https://archlinuxstudio.github.io/ArchLinuxTutorial/#/advanced/beAdmin?id=%e5%bf%85%e9%a1%bb%e6%8e%8c%e6%8f%a1%e7%9a%84-linux-%e7%9f%a5%e8%af%86">archlinuxstudio 的链接</a>)</p>
<h3 id="Windows-1"><a href="#Windows-1" class="headerlink" title="Windows"></a>Windows</h3><p>打开命令控制符 (powershell 类似), 可以看到一些文字, 如:</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line"><span class="function">C:\<span class="title">Users</span>\<span class="title">Admin</span>&gt; </span></span><br></pre></td></tr></table></figure>
<p>我们需要在 <code>&gt;</code> 后面输入命令, 并按回车 <code>&lt;enter&gt;</code> 来执行命令. </p>
<p>设我们所在的文件夹的结构如下 </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">D</span><br><span class="line">└──folder</span><br><span class="line">    ├── file.txt</span><br><span class="line">    └── subfolder</span><br><span class="line">        └── subfile.txt</span><br></pre></td></tr></table></figure>
<p>我们在 D 盘的 <code>folder</code> 文件夹下,这个文件夹下有一个文件 <code>file.txt</code>, 一个文件夹 <code>subfolder</code>, <code>subfolder</code> 文件夹下还有一个文件为 <code>subfile.txt</code>, 下面的命令都可以点击跳转到微软的官方文档, 那里有更详细的解释和参数列表. </p>
<ul>
<li><p><span id="cd"> <a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/cd"><code>cd</code></a> </span> (<strong>c</strong>hange <strong>d</strong>irctory): 我们可以在命令行中运行 </p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line"><span class="function">D:\<span class="title">folder</span>&gt; <span class="title">cd</span> <span class="title">subfolder</span></span></span><br></pre></td></tr></table></figure>
<p>注意我们输入的是 <code>cd subfolder</code>, 而不是前面的一串, 那些是在提示我们当前所处的文件夹, 按下回车后, 提示符变成了</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line"><span class="function">D:\<span class="title">folder</span>\<span class="title">subfolder</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>由于 Windows 有不同的盘符, 如 C 盘, D 盘, 当我们要切换到另一个盘的时候, 可以输入</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line"><span class="function">D:\<span class="title">folder</span>\<span class="title">subfolder</span>&gt; <span class="title">C</span>:</span></span><br></pre></td></tr></table></figure>
<p>按下回车就可以切换到 C 盘的根目录. 如果要输入有空格的路径, 需要用引号包裹, 如</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line"><span class="function">C:\&gt; <span class="title">cd</span> &quot;<span class="title">Program</span> <span class="title">Files</span>&quot;</span></span><br></pre></td></tr></table></figure>
<p>如果要返回上一级目录, 可以用 <code>..</code> 来代替, 比如我们处在 D 盘的 <code>subfile</code> 文件夹内, 运行</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line"><span class="function">D:\<span class="title">folder</span>\<span class="title">subfolder</span>&gt; <span class="title">cd</span> ..</span></span><br></pre></td></tr></table></figure>
<p>按下回车就可以回到 <code>folder</code> 文件夹下, 只需要将 <code>..</code> 视做一个指向上一层目录的路径, 那么如下的内容就容易理解了: 在 <code>subfolder</code> 文件夹下就可以使用 <code>cd ../..</code> 回到 D 盘的根目录; 使用 <code>cd ../../&quot;Program Files&quot;</code> 就可以进入 D 盘根目录下的 <code>Program Files</code> 文件夹.</p>
</li>
<li><p><a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/dir"><code>dir</code></a> (<strong>dir</strong>ctory): 列出当前文件夹内的文件夹和文件:<br>TODO</p>
</li>
<li><p><a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/mkdir"><code>mkdir</code></a> (<strong>m</strong>a<strong>k</strong>e <strong>dir</strong>ctory): 建立新文件夹. 在 <code>folder</code> 文件夹下运行 </p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line"><span class="function">D:\<span class="title">folder</span>&gt; <span class="title">mkdir</span> <span class="title">anothersubfolder</span></span></span><br></pre></td></tr></table></figure>
<p>就可以建立一个名为 <code>anothersubfolder</code> 的文件夹</p>
</li>
<li><p><a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/del"><code>del</code></a> (<strong>del</strong>ete): 删除文件. 比如我们可以在 <code>folder</code> 文件夹下运行 </p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line"><span class="function">D:\<span class="title">folder</span>&gt; <span class="title">del</span> <span class="title">file.txt</span></span></span><br></pre></td></tr></table></figure>
<p>就可以删除 <code>file.txt</code> 文件, 如果想删除 <code>anothersubfolder</code> 文件夹及里面的所有文件, 可以运行</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line"><span class="function">D:\<span class="title">folder</span>&gt; <span class="title">del</span> ./<span class="title">anothersubfolder</span></span></span><br></pre></td></tr></table></figure>
</li>
<li><p><a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/del"><code>copy</code></a> 复制文件. 我们可以在 <code>subfolder</code> 文件夹下使用</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line"><span class="function">D:\<span class="title">folder</span>\<span class="title">subfolder</span>&gt; <span class="title">copy</span> <span class="title">subfile.txt</span> ../<span class="title">file.txt</span></span></span><br></pre></td></tr></table></figure>
<p>将 <code>subfile.txt</code> 文件复制到上一层目录 <code>..</code>, 也就是 <code>folder</code> 文件夹, 命名为 <code>file.txt</code></p>
</li>
<li><p><a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/move"><code>move</code></a> 移动文件. 我们可以在 <code>folder</code> 文件夹下使用</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line"><span class="function">D:\<span class="title">folder</span>&gt; <span class="title">mv</span> <span class="title">file.txt</span> ./<span class="title">subfolder</span>/<span class="title">anothersubfile.txt</span></span></span><br></pre></td></tr></table></figure>
<p>将 <code>file.txt</code> 移动到 <code>subfolder</code> 文件夹, 名为 <code>anothersubfile.txt</code>, 其中 <code>.</code> 的意思是当前文件夹, 也就是 <code>folder</code> 文件夹. </p>
</li>
</ul>
<h3 id="mac-1"><a href="#mac-1" class="headerlink" title="mac"></a>mac</h3><p>我没用过.</p>
<h2 id="compile-latex">使用命令行编译 LaTeX 文件</h2>

<p>LaTeX 在命令行下的程序有 <code>latex</code>, <code>pdflatex</code>, <code>xelatex</code>, <code>lualatex</code>, <code>latexmk</code> 等等, 下面我们以 <code>pdflatex</code> 为例来介绍一些编译的参数. </p>
<h3 id="第一次编译"><a href="#第一次编译" class="headerlink" title="第一次编译"></a>第一次编译</h3><p>这是一个 LaTeX 文件, 位于 <code>/home</code> 目录下的 <code>folder</code> 文件夹, 名为 <code>main.tex</code> <sup><a href="#fn_linux" id="reffn_linux">linux</a></sup></p>
<blockquote id="fn_linux">
<sup>linux</sup>. 由于写这部分的时候我在 ArchLinux 下, 就以 Linux 的文件目录为例了, 原理几乎相同. <a href="#reffn_linux" title="Jump back to footnote [linux] in the text."> &#8617;</a>
</blockquote>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="comment">% main.tex</span></span><br><span class="line"><span class="keyword">\documentclass</span>&#123;article&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line">  Hello <span class="keyword">\LaTeX</span>!</span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<p>我们使用命令行的 <a href="#cd"><code>cd</code></a> 命令来进入 <code>folder</code> 文件夹, 运行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ pdflatex main.tex</span><br></pre></td></tr></table></figure>
<p>其中 <code>$</code> 为 bash 的命令引导符, 不需要手动输入. 不出意外, 可以看到类似如下的输出</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">This is pdfTeX, Version 3.141592653-2.6-1.40.24 (TeX Live 2022) (preloaded format=pdflatex)</span><br><span class="line"> restricted \write18 enabled.</span><br><span class="line">entering extended mode</span><br><span class="line">(./main.tex</span><br><span class="line">LaTeX2e &lt;2021-11-15&gt; patch level 1</span><br><span class="line">L3 programming layer &lt;2022-02-24&gt;</span><br><span class="line">(/home/syvshclily/texlive/2022/texmf-dist/tex/latex/base/article.cls</span><br><span class="line">Document Class: article 2021/10/04 v1.4n Standard LaTeX document class</span><br><span class="line">(/home/syvshclily/texlive/2022/texmf-dist/tex/latex/base/size10.clo))</span><br><span class="line">(/home/syvshclily/texlive/2022/texmf-dist/tex/latex/l3backend/l3backend-pdftex.</span><br><span class="line">def) (./main.aux) [1&#123;/home/syvshclily/texlive/2022/texmf-var/fonts/map/pdftex/u</span><br><span class="line">pdmap/pdftex.map&#125;] (./main.aux) )&lt;/home/syvshclily/texlive/2022/texmf-dist/font</span><br><span class="line">s/type1/public/amsfonts/cm/cmr10.pfb&gt;</span><br><span class="line">Output written on main.pdf (1 page, 12962 bytes).</span><br><span class="line">Transcript written on main.log.</span><br></pre></td></tr></table></figure>
<p>同时查看 <code>folder</code> 文件夹, 可以发现多了几个文件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">folder</span><br><span class="line">  ├── main.aux</span><br><span class="line">  ├── main.log</span><br><span class="line">  ├── main.pdf</span><br><span class="line">  └── main.tex</span><br></pre></td></tr></table></figure>
<p>其中 </p>
<ul>
<li><code>main.aux</code> 为辅助文件, 其中会存一些与交叉引用相关的内容, 以及在多次编译中需要用到的变量. </li>
<li><code>main.log</code> 为日志文件, 其中存储这次编译用到的引擎, 宏包, 字体信息, 也包含了各种宏包输出的 message, 以及编译过程中的警告 (warning) 与错误 (error). </li>
<li><code>main.pdf</code> 为本次编译输出的 PDF 文件, 如果没有使用 <code>-jobname</code> 等参数, 它的文件名默认与我们编译的文件 (<code>main.tex</code>) 同名. </li>
</ul>
<p>然后我们可以使用 PDF 阅读器打开 <code>main.pdf</code> 来查看我们编译生成的内容</p>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/latex-terminal-compiling/first-compiling.png" alt="`main.pdf`"></p>
<h3 id="遇到错误"><a href="#遇到错误" class="headerlink" title="遇到错误"></a>遇到错误</h3><p>我们将上面的 <code>main.tex</code> 文件改一下:</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="comment">% main.tex</span></span><br><span class="line"><span class="keyword">\documentclass</span>&#123;article&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line">  Hello <span class="keyword">\Latex</span>!</span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<p>再使用命令行执行 <code>pdflatex main</code>, 可以发现并没有出现 <code>Output written...</code> 之类的语句, 而是停了下来, 显示</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">This is pdfTeX, Version 3.141592653-2.6-1.40.24 (TeX Live 2022) (preloaded format=pdflatex)</span><br><span class="line"> restricted \write18 enabled.</span><br><span class="line">entering extended mode</span><br><span class="line">(./main.tex</span><br><span class="line">LaTeX2e &lt;2021-11-15&gt; patch level 1</span><br><span class="line">L3 programming layer &lt;2022-02-24&gt;</span><br><span class="line">(/home/syvshclily/texlive/2022/texmf-dist/tex/latex/base/article.cls</span><br><span class="line">Document Class: article 2021/10/04 v1.4n Standard LaTeX document class</span><br><span class="line">(/home/syvshclily/texlive/2022/texmf-dist/tex/latex/base/size10.clo))</span><br><span class="line">(/home/syvshclily/texlive/2022/texmf-dist/tex/latex/l3backend/l3backend-pdftex.</span><br><span class="line">def) (./main.aux)</span><br><span class="line">! Undefined control sequence.</span><br><span class="line">l.3   Hello \Latex</span><br><span class="line">                  !</span><br><span class="line">? </span><br></pre></td></tr></table></figure>
<p>出现了一个问号, 这时候我们可以按回车来让 <code>pdflatex</code> 跳过这个问题, 但是这显然是一个不好的做法, 因为我们并没有解决问题. 来仔细读一下后面一部分:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">! Undefined control sequence.</span><br><span class="line">l.3   Hello \Latex</span><br><span class="line">                  !</span><br><span class="line">? </span><br></pre></td></tr></table></figure>
<p>提示说 “未定义的控制序列”<sup><a href="#fn_undef-cs" id="reffn_undef-cs">undef-cs</a></sup>. 如果下面显示的是我们 <code>.tex</code> 文件中的内容, 那说明我们拼写错误, 或者没有引用宏包就使用了命令等等, 总之是我们使用了一个没有定义的命令. 检查一下可以发现我们将 <code>\LaTeX</code> 错误地写成了 <code>\Latex</code>, 导致了错误. 这时我们可以输入 <code>X&lt;enter&gt;</code><sup><a href="#fn_enter" id="reffn_enter">enter</a></sup>, 结束这次编译, 修改源文件为 <code>\LaTeX</code>, 再进行编译, 便可以编译通过. </p>
<p>当然在 <code>?</code> 出现的时候, 我们还可以输入 <code>H&lt;enter&gt;</code> 获得一些所谓的”帮助”, 这些帮助……我感觉没有产生过太大的作用, 比如刚才如果我们输入 <code>H&lt;enter&gt;</code>, 可以获得</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">This is pdfTeX, Version 3.141592653-2.6-1.40.24 (TeX Live 2022) (preloaded format=pdflatex)</span><br><span class="line"> restricted \write18 enabled.</span><br><span class="line">entering extended mode</span><br><span class="line">(./main.tex</span><br><span class="line">LaTeX2e &lt;2021-11-15&gt; patch level 1</span><br><span class="line">L3 programming layer &lt;2022-02-24&gt;</span><br><span class="line">(/home/syvshclily/texlive/2022/texmf-dist/tex/latex/base/article.cls</span><br><span class="line">Document Class: article 2021/10/04 v1.4n Standard LaTeX document class</span><br><span class="line">(/home/syvshclily/texlive/2022/texmf-dist/tex/latex/base/size10.clo))</span><br><span class="line">(/home/syvshclily/texlive/2022/texmf-dist/tex/latex/l3backend/l3backend-pdftex.</span><br><span class="line">def) (./main.aux)</span><br><span class="line">! Undefined control sequence.</span><br><span class="line">l.3   Hello \Latex</span><br><span class="line">                  !</span><br><span class="line">? H</span><br><span class="line">The control sequence at the end of the top line</span><br><span class="line">of your error message was never \def&#x27;ed. If you have</span><br><span class="line">misspelled it (e.g., `\hobx&#x27;), type `I&#x27; and the correct</span><br><span class="line">spelling (e.g., `I\hbox&#x27;). Otherwise just continue,</span><br><span class="line">and I&#x27;ll forget about whatever was undefined.</span><br><span class="line"></span><br><span class="line">? </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这时候我们也可以输入 <code>I\LaTeX&lt;enter&gt;</code> 来输入正确的命令, 让程序继续编译, 注意, 我们输入 <code>I</code> 来更改的命令不会在源文件中也被改掉, 我们依然需要手动改掉 <code>main.tex</code> 中的错误. </p>
<p>在遇到错误, 并使用 <code>X&lt;enter&gt;</code> 退出的时候, 遇到的错误会被写到 <code>main.log</code> 中, 在其中搜索 <code>error</code> 一般就可以看到错误. </p>
<h4 id="处理错误的选项"><a href="#处理错误的选项" class="headerlink" title="处理错误的选项"></a>处理错误的选项</h4><p>当出现 <code>?</code> 时, 我们可以输入的内容有<sup><a href="#fn_error-input" id="reffn_error-input">error-input</a></sup></p>
<blockquote id="fn_error-input">
<sup>error-input</sup>. 这些输入不区分大小写. <a href="#reffn_error-input" title="Jump back to footnote [error-input] in the text."> &#8617;</a>
</blockquote>
<ul>
<li><code>&lt;enter&gt;</code> 对于轻微错误, 系统将尽可能修复或跳过错误, 继续编译 (不建议使用).</li>
<li><code>S&lt;enter&gt;</code> 除非有找不到的文件, 否则在本次编译将不再停顿, 所有的错误都按输入了 <code>&lt;enter&gt;</code> 处理, 所有的错误信息都将在命令行中显示并记录到 <code>.log</code> 文件.</li>
<li><code>R&lt;enter&gt;</code> 比 <code>S</code> 更强, 即使找不到文件也不停顿.</li>
<li><code>Q&lt;enter&gt;</code> 比 <code>R</code> 更强, 它不会再显示后续的编译信息, 只是将这些内容写入 <code>.log</code> 文件, 这是一种不计后果的错误处理方式.</li>
<li><code>I&lt;cs&gt;&lt;enter&gt;</code> 其中 <code>&lt;cs&gt;</code> 为要在断点后插入的控制序列 (control sequence), 按下回车后编译器将读入 <code>&lt;cs&gt;</code> 来替换出错的命令, 再读入断点后的内容继续编译. 如果输入 <code>I\stop&lt;enter&gt;</code>, 则停止编译, 仅显示断点之前的排版结果.</li>
<li><code>X&lt;enter&gt;</code> 退出, 系统将断点前的编译过程写入 <code>.log</code> 文件并将已经编译的页面输出, 然后退出编译, 断点后的文件内容不再处理. </li>
<li><code>E&lt;enter&gt;</code> 类似 <code>X</code>, 它会在默认编辑器(从输出来看, 这个默认编辑器应该是 emacs)中高亮显示错误出现的位置. </li>
<li><code>1-9&lt;enter&gt;</code> 可以输入一个小于 100 的正整数, 系统将在断点之后删除相同数量的半角字符, 然后等待下一步回应, 其中一个汉字等于两个半角字符, 一个 LaTeX 命令无论长短都算一个半角字符. </li>
<li><code>H&lt;enter&gt;</code> 寻求帮助, 系统将给出更详细的错误说明, 并提出改正建议, 一些包的作者会额外书写输入 <code>H&lt;enter&gt;</code> 后的错误输出, 此时 <code>H</code> 就有了一些用处. </li>
</ul>
<p>在 <a href="#common-error">常见的报错命令</a> 处列出了一些可能见到的错误, 如果有需要可以查阅.</p>
<h3 id="编译选项"><a href="#编译选项" class="headerlink" title="编译选项"></a>编译选项</h3><p>我们不只可以使用 <code>pdflatex main</code> 来编译, 也可以添加一些选项, 来达到额外的编译效果, 使用方法为</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ pdflatex -&lt;option1&gt; -&lt;option2&gt;=&lt;string&gt; main</span><br></pre></td></tr></table></figure>
<p>其中 <code>&lt;option1&gt;, &lt;option2&gt;</code> 为选项的名字, <code>&lt;string&gt;</code> 对应了一些需要参数的选项, 下面介绍一些选项, 注意要在下面的每个选项之前加上 <code>-</code>. 更详细的可用选项可以在命令行运行 <code>pdflatex --help</code></p>
<ul>
<li><p><code>halt-on-error</code> 会在第一个错误停下, 不使用 <code>?</code> 等待用户输入, 输出内容如:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ pdflatex -halt-on-error main          </span><br><span class="line">...not important output...</span><br><span class="line">! Undefined control sequence.</span><br><span class="line">l.3   Hello \Latex</span><br><span class="line">                  !</span><br><span class="line">!  ==&gt; Fatal error occurred, no output PDF file produced!</span><br><span class="line">Transcript written on main.log.</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>interaction=&lt;string&gt;</code> 其中 <code>&lt;string&gt;</code> 的值为<sup><a href="#fn_interaction" id="reffn_interaction">interaction</a></sup></p>
<ul>
<li><code>errorstopmode</code> 这是默认值, 在遇到错误的时候停止编译并等待用户输入. </li>
<li><code>scrollmode</code> 在屏幕上输出编译信息, 会跳过错误, 但是会在找不到文件时停止编译并等待用户输入, 与上文的 <code>S</code> 类似. (比如找不到 <code>\input</code> 的文件的时候)</li>
<li><code>batchmode</code> 不在命令行中输出任何有关编译的内容, 也不在任何时候停下等待用户输入. </li>
<li><code>nonstopmode</code> 不在任何时候停下, 直到最后显示出来错误的位置与内容. </li>
</ul>
</li>
<li><p><code>synctex=1</code> 在需要正反向搜索的时候, 需要启用这个选项来生成 <code>&lt;filename&gt;.synctex.gz</code> 文件. </p>
</li>
</ul>
<blockquote id="fn_interaction">
<sup>interaction</sup>. 见 <code>latex2e.pdf sec 28.1</code> 或 <a href="http://latexref.xyz/Command-line-options.html">latexref</a><a href="#reffn_interaction" title="Jump back to footnote [interaction] in the text."> &#8617;</a>
</blockquote>
<ul>
<li><p><code>jobname=&lt;string&gt;</code> 设置输出文件的文件名, 如果使用</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ pdflatex -jobname=<span class="built_in">test</span> main.tex</span><br></pre></td></tr></table></figure>
<p>那么输出的文件将为</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">folder</span><br><span class="line">  ├── main.tex</span><br><span class="line">  ├── test.aux</span><br><span class="line">  ├── test.log</span><br><span class="line">  └── test.pdf</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>output-directory=&lt;string&gt;</code> 将所有输出文件都输出到 <code>&lt;string&gt;</code> 文件夹内, 注意输出文件夹必须已经存在. 如果使用</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ pdflatex -output-directory=subfolder main.tex</span><br></pre></td></tr></table></figure>
<p>那么输出文件将为</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">folder</span><br><span class="line">  ├── main.tex</span><br><span class="line">  └── subfolder</span><br><span class="line">      ├── main.aux</span><br><span class="line">      ├── main.log</span><br><span class="line">      └── main.pdf</span><br></pre></td></tr></table></figure>
<p>并且二次编译的时候会检测到输出文件夹, 并且使用输出文件夹中的辅助文件进行二次编译. </p>
</li>
<li><p><code>shell-escape</code> <code>enable-write18</code> 让编译器可以调用外部程序进行编译, 如使用 <code>minted</code>, <code>tkz-fct</code> 等需要调用外部程序的宏包时, 需要启用, 其中 <code>-shell-escape</code> 是 TeX Live 的命令, <code>-enable-write18</code> 是 MikTeX 的命令. 事实上, 如果我们使用 <code>pdflatex main.tex</code> 来编译以下文件:</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="comment">% main.tex</span></span><br><span class="line"><span class="keyword">\documentclass</span>&#123;article&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;minted&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line">  Hello <span class="keyword">\LaTeX</span>!</span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<p>可以得到错误:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">! Package minted Error: You must invoke LaTeX with the -shell-escape flag.</span><br><span class="line"></span><br><span class="line">See the minted package documentation for explanation.</span><br><span class="line">Type  H &lt;return&gt;  for immediate help.</span><br><span class="line">...                                              </span><br><span class="line">                                                  </span><br><span class="line">l.3 \begin</span><br><span class="line">          &#123;document&#125;</span><br><span class="line">? H   </span><br><span class="line">Pass the -shell-escape flag to LaTeX. Refer to the minted.sty documentation for</span><br><span class="line">more information.</span><br></pre></td></tr></table></figure>
<p>根据提示我们应该使用 </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pdflatex -shell-escape main.tex</span><br></pre></td></tr></table></figure>
<p>来进行编译</p>
</li>
<li><code>no-shell-escape</code> <code>disable-write18</code> 与上面的选项相反, 强制不能使用外部程序. </li>
</ul>
<h3 id="多次编译"><a href="#多次编译" class="headerlink" title="多次编译"></a>多次编译</h3><h4 id="目录与交叉引用"><a href="#目录与交叉引用" class="headerlink" title="目录与交叉引用"></a>目录与交叉引用</h4><p>通常含有交叉引用或者目录的文件需要编译两次, 我们使用以下的 <code>main.tex</code>:</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="comment">% main.tex</span></span><br><span class="line"><span class="keyword">\documentclass</span>&#123;article&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"><span class="keyword">\tableofcontents</span></span><br><span class="line"><span class="keyword">\section</span>&#123;One&#125;<span class="keyword">\label</span>&#123;sec:one&#125;</span><br><span class="line">  We are in section <span class="keyword">\ref</span>&#123;sec:one&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<p>这里有一个目录和一个交叉引用, 让我们用 <code>pdflatex main</code> 编译一次, 然后来查看 <code>main.pdf</code></p>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/latex-terminal-compiling/cross-ref.png" alt="cross-ref"></p>
<p>我们发现既没有目录, 也没有引用, 只有 <code>??</code>, 让我们来看一下 <code>main.aux</code> 与 <code>main.toc</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">% main.aux</span><br><span class="line">\relax </span><br><span class="line">\@writefile&#123;toc&#125;&#123;\contentsline &#123;section&#125;&#123;\numberline &#123;1&#125;One&#125;&#123;1&#125;&#123;&#125;\protected@file@percent &#125;</span><br><span class="line">\newlabel&#123;sec:one&#125;&#123;&#123;1&#125;&#123;1&#125;&#125;</span><br><span class="line">\gdef \@abspage@last&#123;1&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">% main.toc</span><br><span class="line">\contentsline &#123;section&#125;&#123;\numberline &#123;1&#125;One&#125;&#123;1&#125;&#123;&#125;%</span><br></pre></td></tr></table></figure>
<p>这两个文件中的内容将会为下一次的编译提供更多的命令, 比如 <code>\contentsline</code> 以及一个定义好的 <code>\newlabel</code>, 第二次编译中 <code>\tableofcontents</code> 会用到前者来输出目录, <code>\ref</code> 会用后者来输出引用的值. </p>
<p>那我们再使用 <code>pdflatex main.tex</code> 来编译一次, 可以得到正确的输出:</p>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/latex-terminal-compiling/cross-ref-right.png" alt="right-cross-ref"></p>
<h4 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h4><p>我们使用以下的 <code>main.tex</code>:</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="comment">% main.tex</span></span><br><span class="line"><span class="keyword">\documentclass</span>&#123;article&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line">  text<span class="keyword">\cite</span>&#123;article-full&#125;</span><br><span class="line">  <span class="keyword">\bibliographystyle</span>&#123;plain&#125;</span><br><span class="line">  <span class="keyword">\bibliography</span>&#123;xampl.bib&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<p>当遇到参考文献的时候我们需要编译 4 次, 以常用的 <code>bibtex</code> 为例, 需要使用</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pdflatex main.tex</span><br><span class="line">bibtex main.aux</span><br><span class="line">pdflatex main.tex</span><br><span class="line">pdflatex main.tex</span><br></pre></td></tr></table></figure>
<p>编译结果如下</p>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/latex-terminal-compiling/bib-ref.png" alt="参考文献"></p>
<p>有了上面的铺垫, 来说一下每一次编译都做了什么</p>
<ol>
<li>第一次 <code>pdflatex</code> 将 <code>\cite</code> 的的参数 (也就是用到的 <code>.bib</code> 文件中的 <code>key</code>) 信息写入了 <code>main.aux</code> 文件.</li>
<li><code>bibtex</code> 程序读取哪些 <code>key</code> 被用到了, 然后根据这些 <code>key</code> 生成 <code>main.bbl</code> 文件.</li>
<li>第二次 <code>pdflatex</code> 读取 <code>main.bbl</code> 文件, 将 <code>\cite</code> 引用的正确的序号写进 <code>main.aux</code>.</li>
<li>第三次 <code>pdflatex</code> 读取 <code>main.aux</code> 文件, 输出正确的 <code>\cite</code> 编号. </li>
</ol>
<p>注意: 如果使用了 <code>backend=biber</code> 参数的 <code>biblatex</code> 宏包 (这个参数是默认选项), 那么就需要在第二步使用 <code>biber main.bcf</code>. </p>
<p>当然我们也可以都不写扩展名, 直接使用 <code>bibtex main</code> 或 <code>biber main</code>, 程序会自动识别出它们应该带的扩展名.</p>
<p>如果在没有 <code>\cite</code> 的情况下强行使用 <code>bibtex main</code>, 会得到报错:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">This is BibTeX, Version 0.99d (TeX Live 2022)</span><br><span class="line">The top-level auxiliary file: main.aux</span><br><span class="line">I found no \citation commands---while reading file main.aux</span><br><span class="line">I found no \bibdata command---while reading file main.aux</span><br><span class="line">I found no \bibstyle command---while reading file main.aux</span><br><span class="line">(There were 3 error messages)</span><br></pre></td></tr></table></figure>
<p>如果强行使用 <code>biber main</code> 会得到:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">INFO - This is Biber 2.17</span><br><span class="line">INFO - Logfile is <span class="string">&#x27;main.blg&#x27;</span></span><br><span class="line">ERROR - Cannot find <span class="string">&#x27;main.bcf&#x27;</span>!</span><br><span class="line">INFO - ERRORS: 1</span><br></pre></td></tr></table></figure>
<p>这也是一些有自动编译功能的软件会直接甩出来的错误 (说的就是你 TeXstudio)</p>
<h3 id="更强大的工具-latexmk"><a href="#更强大的工具-latexmk" class="headerlink" title="更强大的工具 latexmk"></a>更强大的工具 <code>latexmk</code></h3><p><code>latexmk</code> 是一个自动化的编译程序, 通常情况下它可以识别出编译后有哪些文件进行了更改, 并自动运行下一步, 比如我们使用如下的 <code>main.tex</code>, 注意清空除了 <code>main.tex</code> 以外的文件来查看更好的效果.<sup><a href="#fn_xampl" id="reffn_xampl">xampl</a></sup></p>
<blockquote id="fn_xampl">
<sup>xampl</sup>. 其中 <code>xampl.bib</code> 是 <code>mwe</code> 宏包自带的一个示例的 <code>.bib</code> 文件, 可以在命令行运行 <code>texdoc mwe</code> 来查找可用的键值. <a href="#reffn_xampl" title="Jump back to footnote [xampl] in the text."> &#8617;</a>
</blockquote>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="comment">% main.tex</span></span><br><span class="line"><span class="keyword">\documentclass</span>&#123;article&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"><span class="keyword">\tableofcontents</span></span><br><span class="line"><span class="keyword">\section</span>&#123;One&#125;<span class="keyword">\label</span>&#123;sec:one&#125;</span><br><span class="line">  We are in section <span class="keyword">\ref</span>&#123;sec:one&#125;, </span><br><span class="line">  and we have a cite <span class="keyword">\cite</span>&#123;article-full&#125;</span><br><span class="line">  <span class="keyword">\bibliographystyle</span>&#123;plain&#125;</span><br><span class="line">  <span class="keyword">\bibliography</span>&#123;xampl.bib&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<p>我们在命令行运行 (这里也可以省略扩展名 <code>.tex</code>)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ latexmk -pdf main.tex</span><br></pre></td></tr></table></figure>
<p>稍微注意一下可以看到编译的过程出现了</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Latexmk: applying rule <span class="string">&#x27;pdflatex&#x27;</span>...</span><br><span class="line">Rule <span class="string">&#x27;pdflatex&#x27;</span>: File changes, etc:</span><br><span class="line">   Changed files, or newly <span class="keyword">in</span> use since previous run(s):</span><br><span class="line">      <span class="string">&#x27;main.tex&#x27;</span></span><br><span class="line">------------</span><br><span class="line">Run number 1 of rule <span class="string">&#x27;pdflatex&#x27;</span></span><br><span class="line">------------</span><br><span class="line">------------</span><br><span class="line">Running <span class="string">&#x27;pdflatex  -recorder  &quot;main.tex&quot;&#x27;</span></span><br><span class="line">------------</span><br><span class="line">...</span><br><span class="line">Latexmk: applying rule <span class="string">&#x27;bibtex main&#x27;</span>...</span><br><span class="line">Rule <span class="string">&#x27;bibtex main&#x27;</span>: File changes, etc:</span><br><span class="line">   Changed files, or newly <span class="keyword">in</span> use since previous run(s):</span><br><span class="line">      <span class="string">&#x27;main.aux&#x27;</span></span><br><span class="line">------------</span><br><span class="line">Run number 1 of rule <span class="string">&#x27;bibtex main&#x27;</span></span><br><span class="line">------------</span><br><span class="line">------------</span><br><span class="line">Running <span class="string">&#x27;bibtex  &quot;main.aux&quot;&#x27;</span></span><br><span class="line">------------</span><br><span class="line">...</span><br><span class="line">Latexmk: applying rule <span class="string">&#x27;pdflatex&#x27;</span>...</span><br><span class="line">Rule <span class="string">&#x27;pdflatex&#x27;</span>: File changes, etc:</span><br><span class="line">   Changed files, or newly <span class="keyword">in</span> use since previous run(s):</span><br><span class="line">      <span class="string">&#x27;main.aux&#x27;</span></span><br><span class="line">      <span class="string">&#x27;main.bbl&#x27;</span></span><br><span class="line">      <span class="string">&#x27;main.toc&#x27;</span></span><br><span class="line">------------</span><br><span class="line">Run number 2 of rule <span class="string">&#x27;pdflatex&#x27;</span></span><br><span class="line">------------</span><br><span class="line">------------</span><br><span class="line">Running <span class="string">&#x27;pdflatex  -recorder  &quot;main.tex&quot;&#x27;</span></span><br><span class="line">------------</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>整个过程不需要我们动手, 同时 <code>latexmk</code> 也可以使用类似 <code>Makefile</code> 的 <code>latexmkrc</code> 文件来进行提前配置, 也可以像 <code>pdflatex</code> 一样为 <code>latexmk</code> 添加编译选项来增加功能. 详细的信息可以命令行运行 <code>texdoc latexmk</code> 来查看它的文档. 我也翻译了一部分文档, 但是后面鸽了, 见 <a href="/2021-03-04-learn-latexmk/" title="latexmk 的学习">latexmk 的学习</a>.</p>
<h2 id="其他的内容"><a href="#其他的内容" class="headerlink" title="其他的内容"></a>其他的内容</h2><h3 id="常见的报错命令"><a href="#常见的报错命令" class="headerlink" title="常见的报错命令"></a><a id="common-error"></a>常见的报错命令</h3><ul>
<li><p><code>Argument of \cs has an extra &#125;.</code> 通常是某个带参数的命令只带了一个右括号, 如 <code>\section&#125;</code>, <code>\cline 1-2&#125;</code>. 输入 <code>H&lt;enter&gt;</code> 可以得到提示:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">I&#x27;ve run across a `&#125;&#x27; that doesn&#x27;t seem to match anything.</span><br><span class="line">For example, `\def\a#1&#123;...&#125;&#x27; and `\a&#125;&#x27; would produce</span><br><span class="line">this error. If you simply proceed now, the `\par&#x27; that</span><br><span class="line">I&#x27;ve just inserted will cause me to report a runaway</span><br><span class="line">argument that might be the root of the problem. But if</span><br><span class="line">your `&#125;&#x27; was spurious, just type `2&#x27; and it will go away.</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>Bad math environment delimiter.</code> 通常是在数学模式中使用了 <code>\[</code> 或 <code>\(</code> 或在文本模式中时候了 <code>\]</code> 或 <code>\)</code>. 这都属于错误的数学定界符.<sup><a href="#fn_wrong-dollar" id="reffn_wrong-dollar">wrong-dollar</a></sup></p>
</li>
</ul>
<blockquote id="fn_wrong-dollar">
<sup>wrong-dollar</sup>. 如果在数学模式输入了额外的 <code>$</code>, 那么报错会是 <code>! You can’t use \spacefactor in math mode.</code><a href="#reffn_wrong-dollar" title="Jump back to footnote [wrong-dollar] in the text."> &#8617;</a>
</blockquote>
<ul>
<li><code>\begin&#123;env1&#125; on input line .. ended by \end&#123;env2&#125;</code> 通常是环境 <code>env1</code> 没有写 <code>\end&#123;env1&#125;</code>, 或者 <code>\end&#123;env1&#125;</code> 写错了. 不过现在编辑器的配对功能很成熟, 一般不会见到了. </li>
<li><code>Can be used only in preamble</code> 在源文件中的正文部分使用了只能在导言区 (preamble) 才能使用的命令, 如 <code>\usepackage&#123;&#125;</code>.</li>
<li><code>\caption outside float</code> 在浮动体环境外使用了 <code>\caption</code> 命令, 如果不想使用浮动体环境还想加标题, 可以使用 <code>caption</code> 宏包的 <code>\captionof&#123;&#125;&#123;&#125;</code> 命令, 具体的可以查看文档. </li>
<li><code>Command \cs is alredy defined</code> 通常是用 <code>\newcommand</code> 等新建命令的命令定义了一个已经存在的命令. </li>
<li><code>Command \cs invalid in math mode</code> 表示命令 <code>\cs</code> 不能在数学模式中使用. </li>
<li><code>Double subscript</code> <code>Double superscipt</code> 在数学模式中不能连用两个下标或者上标, 需要用大括号来定界, 如 <script type="math/tex">a_b_c</script> 会报 <code>Double subscript</code> 的错误, 需要使用 <script type="math/tex">a_{b_c}</script> 或 <script type="math/tex">{a_b}_c</script>. </li>
<li><code>Environment env undefined</code> 环境 <code>env</code> 没有定义就使用了.</li>
<li><code>Extra alignment tab has been changed to \cr</code> 通常是在 <code>array</code> 或 <code>tabular</code> 一类需要分列的环境中, <code>&amp;</code> 的数量比预设的列数 - 1 要多, 通常是忘了用 <code>\\</code> 换行 .</li>
<li><code>Extra &#125;, or forgotten \right.</code> 在一个数学式中只有 <code>\left</code> 没有对应的 <code>\right</code>, 这一对命令必须成对使用, 且不能被 <code>&amp;</code> 或 <code>\\</code> 分隔或者处于不同的组合. </li>
<li><code>File `file’ not found</code> 没找到需要的文件, 需要检查路径或文件名是否正确.</li>
<li><code>Runaway argument ... File ended while scanning use of \cs</code> 参数溢出, 通常情况下是忘了右侧的 <code>&#125;</code>, 如 <code>\section&#123;text</code>.</li>
<li><code>I can’t write on file file.</code> 无法写入 <code>file</code> 文件, 如果无法写入 PDF 文件, 检查一下该 PDF 是否被一些阅读器锁定, 比如 PDF 文件在 Acrobat Reader 中打开了.</li>
<li><code>Illegal parameter number in definition of \cs</code> 在定义命令 <code>\cs</code> 的时候, 使用的参数数量超过了设定的参数数量.</li>
<li><code>Illegal unit of measure (pt inserted)</code> 设置了错误的长度单位, 可能是写错或忘写了单位, 注意, 设置长度为 0 的时候也需要写单位, 如 <code>0pt</code>. </li>
<li><code>\include cannot be nested</code> <code>\include</code> 命令不能嵌套, 即不能在 <code>\include</code> 的文件中再使用 <code>\include</code>.</li>
<li><code>Misplaced alignment tab character &amp;</code> 在表格或者 <code>array</code> 环境外使用了 <code>&amp;</code>, 如果正文中没有使用, 可以检查参考文件中有没有出现单独的 <code>&amp;</code>, 需要改为 <code>\&amp;</code>.</li>
<li><code>Misplaced \noalign</code> 通常出现在 <code>\hline</code> 没有跟在 <code>\\</code> 后面, 也可能是在表格外用了 <code>\hline</code> 之类的命令.</li>
<li><code>Missing \begin&#123;document&#125;</code> 这是报错的重灾区, 因为通常不会有人真的不写 <code>\begin&#123;document&#125;</code>, 这条错误通常来自于在导言区输入了排版语言, 如一个文字, 或者一个有输出的命令, 关于这个错误的讨论详见 <a href="https://github.com/latex3/latex2e/issues/185">Github</a></li>
<li><code>Missing \endcsname inserted</code> 通常是错误地将命令名作为了环境名或计数器名, 如 <code>\setcounter&#123;\section&#125;&#123;2&#125;</code>, 或 <code>\begin&#123;\equation&#125;</code> </li>
<li><code>Missing $ inserted</code> 可能是数学命令没有用在数学模式中, 或者是没有使用 <code>\$</code> 来输出 <code>$</code>. </li>
<li><code>Missing number, treated as zero</code> 没有给出或者给出了错误的参数, 比如 <code>\parbox</code> 命令的宽度被置空或者遗漏. 再比如如果要输出当前页码, 应该用 <code>\thepage</code> 而不是 <code>\value&#123;page&#125;</code>, 后者只能作为其他命令的参数. </li>
<li><code>No \title given</code> 没有写 <code>\title</code> 但是写了 <code>\maketitle</code>. </li>
<li><code>Option Clash for package ...</code> 通常发生在一个宏包被调用了多次, 而这几次调用中使用了冲突的参数. 并且有一些宏包 <code>pkg</code> 会自动调用带参数的其他宏包 <code>subpkg</code>, 要向这些 <code>subpkg</code> 宏包传递参数的时候, 可以使用 <code>\PassOptionsToPackage&#123;option&#125;&#123;subpkg&#125;</code>.</li>
<li><code>Someing&#39;s wrong--perhaps a missing \item</code> 列表环境或者参考文件都必须以 <code>\item</code> 或者 <code>\bibitem</code> 作为前导, 否则将会产生该错误.</li>
<li><code>There&#39;s no line here to end</code> 在两个段落之间无意义地时候换行命令, 比如连用两个 <code>\\</code>, 如果要在段落中产生空白, 应该使用 <code>\vspace</code> 命令, 更进一步, 如果要添加的空白属于通常的”段落间隔”, 那么应该在导言区进行格式设置, 如设置 <code>\parskip</code> 的值等等.</li>
<li><code>This file needs format version1 but this is version2</code> 所用的文档类或宏包与档版本的 LaTeX 系统不兼容, 通常所需的版本 <code>version1</code> 要高于当前版本 <code>version2</code>. </li>
<li><code>Too deeply nested</code> 列表环境嵌套太多, 通常不应超过 4 层, 否则可以使用 <code>enumitem</code> 宏包来进一步设置. </li>
<li><code>Too many &#125;&#39;s</code> 正文里有过多的 <code>&#125;</code>, 如 <code>\section&#123;text&#125;&#125;</code>.</li>
<li><code>\cs undefined</code> 使用 <code>\renewcommand</code> 定义的命令并没有定义过. </li>
<li><code>Undefined control sequence</code> 所使用的命令没有定义, 需要检查是否没有加载宏包或命令拼写是否正确.</li>
<li><code>Unknown option opt for pkg</code> 在 <code>\usepackage</code> 中使用了并没有在 <code>pkg</code> 宏包中定义的选项 <code>opt</code>. </li>
<li><code>\verb illegal in command argument</code> 不能在其他命令的参数中使用 <code>\verb</code>. </li>
<li><code>! Package fontspec Error: The font &quot;fontname&quot; cannot be found.</code> 表示没有找到名字为 “fontname” 的字体, 请检查是否安装了该字体, 是否输入了正确的字体文件名/字族名. <sup><a href="#fn_macfont" id="reffn_macfont">macfont</a></sup></li>
</ul>
<blockquote id="fn_permission">
<sup>permission</sup>. 如果在更新宏包等时候出现了 <code>Permission denied</code> 等字样, 就需要考虑使用管理员权限打开 cmd<a href="#reffn_permission" title="Jump back to footnote [permission] in the text."> &#8617;</a>
</blockquote>
<blockquote id="fn_undef-cs">
<sup>undef-cs</sup>. 其中 “控制序列” 可以理解为 LaTeX 中的命令, 即以 <code>\</code> 开头的一串字符.<a href="#reffn_undef-cs" title="Jump back to footnote [undef-cs] in the text."> &#8617;</a>
</blockquote>
<blockquote id="fn_enter">
<sup>enter</sup>. 这里的 <code>&lt;enter&gt;</code> 为按下回车, 而不是依次输入这几个字符. <a href="#reffn_enter" title="Jump back to footnote [enter] in the text."> &#8617;</a>
</blockquote>
<blockquote id="fn_macfont">
<sup>macfont</sup>. 注意在 MacOS 系统上不经过特殊操作只能使用字体文件名来调用发行版字体, 如想设置正文为 Fandol 宋体, 在 Windows 与 Linux 下均可以使用: <code>\setCJKmainfont&#123;FandolSong&#125;</code> 与 <code>\setCJKmainfont&#123;FandolSong-Regular.otf&#125;</code>, 但是 MacOS 下只能使用后者. 如果想折腾或者想获得更多信息, 可以看<a href="https://zhuanlan.zhihu.com/p/59774395">慕子的知乎专栏</a><a href="#reffn_macfont" title="Jump back to footnote [macfont] in the text."> &#8617;</a>
</blockquote>
]]></content>
      <categories>
        <category>帮助文档</category>
        <category>LaTeX</category>
      </categories>
      <tags>
        <tag>帮助文档</tag>
        <tag>LaTeX</tag>
      </tags>
  </entry>
  <entry>
    <title>latex-tutorial</title>
    <url>/2022-04-20-latex-tutorial/</url>
    <content><![CDATA[<p>应 ElegantLaTeX 的邀请, 来做一次与 LaTeX 相关的知识分享, 主要内容包括 LaTeX 软件包的安装, 更新和回滚; 如何用命令行编译 LaTeX 文件; 如何使用和配置 VSCode. </p>
<span id="more"></span>
<p>在其他的环节开始之前</p>
<h2 id="下载并安装-VSCode"><a href="#下载并安装-VSCode" class="headerlink" title="下载并安装 VSCode."></a>下载并安装 VSCode.</h2><h3 id="Windows-用户"><a href="#Windows-用户" class="headerlink" title="Windows 用户"></a>Windows 用户</h3><ol>
<li>在 VSCode 的官网: <a href="https://code.visualstudio.com/">https://code.visualstudio.com/</a> 选择 <code>stable</code> 版本进行下载. </li>
<li><p>安装的时候注意勾选”添加到PATH”</p>
<p> <img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/latex-tutorial/install-vs.png" alt="安装选项"></p>
</li>
</ol>
<h3 id="macOS-用户"><a href="#macOS-用户" class="headerlink" title="macOS 用户"></a>macOS 用户</h3><p>同 Windows, 只需要下载 macOS 版本的安装文件安装即可.</p>
<h3 id="Linux-用户"><a href="#Linux-用户" class="headerlink" title="Linux 用户"></a>Linux 用户</h3><p>在各发行版的软件源中下载即可.</p>
<hr>
<p>在等待下载安装的时候, 我们来看一些其他的东西</p>
<h2 id="打开终端-命令行"><a href="#打开终端-命令行" class="headerlink" title="打开终端/命令行"></a>打开终端/命令行</h2><h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h3><ol>
<li>Windows10/11 可以点击状态栏中的”搜索”或快捷键<code>win</code>+<code>S</code>, 并在搜索栏里搜索 “cmd” 或 “powershell”, 可以选择直接左键点击打开, 也可以选择右键<code>以管理员身份运行</code>, 以管理员身份运行的命令行的权限更高.<sup><a href="#fn_permission" id="reffn_permission">permission</a></sup><br><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/latex-terminal-compiling/cmd-on-win%2Bs.gif" alt="win+S"></li>
<li>可以在”文件资源管理器”的地址栏中直接输入 “cmd” 或 “powershell” 并回车, 就可以在当前文件夹中打开命令行.<br><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/latex-terminal-compiling/click.gif" alt="点击文件资源管理器"></li>
<li>可以在”文件资源管理器”的空白处按住<code>shift</code>再点击右键, 选择选项”在此处打开 PowerShell 窗口”, 就可以在当前文件夹中打开 powershell. 当然 Windows11 用户或者安装了 Windows Terminal 的用户也可以通过右键后选择”在 Windows 终端中打开”.<br><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/latex-terminal-compiling/shift-right-click.gif" alt="shift+右键"></li>
</ol>
<blockquote id="fn_permission">
<sup>permission</sup>. 如果在更新宏包等时候出现了 <code>Permission denied</code> 等字样, 就需要考虑使用管理员权限打开 cmd<a href="#reffn_permission" title="Jump back to footnote [permission] in the text."> &#8617;</a>
</blockquote>
<h3 id="macOS"><a href="#macOS" class="headerlink" title="macOS"></a>macOS</h3><p>同时按下 <code>command</code> 和空格, 在弹出的输入栏里输入 <code>terminal</code> 即可打开, 或见苹果的<a href="https://support.apple.com/zh-cn/guide/terminal/apd5265185d-f365-44cb-8b09-71a064a42125/mac">官方说明</a></p>
<h2 id="tlmgr-的使用"><a href="#tlmgr-的使用" class="headerlink" title="tlmgr 的使用"></a><code>tlmgr</code> 的使用</h2><p>按照啸行编写的 <a href="http://mirrors.ctan.org/info/install-latex-guide-zh-cn/install-latex-guide-zh-cn.pdf">install-latex-guide-zh-cn</a> 安装好 TeXLive 2022 后, 可以使用 <code>tlmgr</code> 来对软件包进行版本处理, 其中 <code>tlmgr</code> 是 <strong>T</strong>eX<strong>L</strong>ive <strong>M</strong>ana<strong>g</strong>e<strong>r</strong> 的意思. </p>
<p><strong>注意</strong>: 这里提到的软件包不只是用在 <code>\usepackage</code> 的宏包, 而是所有 TeXLive 包含的, 可以使用 <code>tlmgr</code> 管理的内容, 比如平常所说的宏包, 如 <code>amsmath.sty</code>, 一些说明文档, 如 <code>lshort-zh-cn</code>, 一些可执行文件, 如 <code>xetex.exe</code> 等等.</p>
<p>可以在命令行运行 <code>tlmgr version</code> 来查看 <code>tlmgr</code> 的版本, 正常情况下会有类似的输出:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tlmgr revision 63033 (2022-04-15 07:19:42 +0200)</span><br><span class="line">tlmgr using installation: C:/texlive/2022</span><br><span class="line">TeX Live (https://tug.org/texlive) version 2022</span><br></pre></td></tr></table></figure>
<p>首先说明, <code>tlmgr</code> 的命令格式为</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tlmgr [global options] &lt;action&gt; [action-specific options] [operand]</span><br></pre></td></tr></table></figure>
<p>其中</p>
<ol>
<li><strong>选项(option)</strong> 分为 <strong>全局选项(global option)</strong> 和 <strong>操作特有选项(action-specific option)</strong>. 它们以 <code>-</code> 或 <code>--</code> 开头, 但是所有的选项都可以放在 <code>tlmgr</code> 后的任何位置, 按任意顺序调用, 其中第一个不以 <code>-</code> 或 <code>--</code> 开头的参数将被视做<strong>操作(action)</strong>.</li>
<li>所有的选项中 <code>-option</code> 与 <code>--option</code> 都是相同的. </li>
<li>几乎所有的操作都有 <code>-dry-run</code> 这个参数, 它用来假装进行操作, 来让用户看一下可能会发生什么.</li>
</ol>
<p>那么我们就可以使用 <code>tlmgr</code> 来进行下面的练习了. </p>
<h3 id="更新软件包"><a href="#更新软件包" class="headerlink" title="更新软件包"></a>更新软件包</h3><p>操作: <code>update</code></p>
<h4 id="查看有哪些软件包可以更新"><a href="#查看有哪些软件包可以更新" class="headerlink" title="查看有哪些软件包可以更新"></a>查看有哪些软件包可以更新</h4><p>通常来说 <a href="https://ctan.org">CTAN</a> 上的软件包每天都会有更新, 可以在命令行运行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tlmgr update -list</span><br></pre></td></tr></table></figure>
<p>来查看是否有可以更新的软件包, 这里的 <code>update</code> 是操作, <code>-list</code> 是这个操作的特有选项. 通常情况下会有类似的输出</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tlmgr.pl: package repository https://mirrors.tuna.tsinghua.edu.cn/CTAN/systems/texlive/tlnet (not verified: gpg unavailable)</span><br><span class="line">tlmgr.pl: would save backups to C:/texlive/2022/tlpkg/backups</span><br><span class="line">tlmgr.pl: skipping forcibly removed package: collection-texworks</span><br><span class="line">update:   adjmulticol        [316k]: <span class="built_in">local</span>:    62935, <span class="built_in">source</span>:    63073</span><br><span class="line">update:   hitex             [2565k]: <span class="built_in">local</span>:    62529, <span class="built_in">source</span>:    63073</span><br><span class="line">update:   texlive-fr        [1394k]: <span class="built_in">local</span>:    62853, <span class="built_in">source</span>:    63071</span><br><span class="line">update:   texlive-msg-translations [144k]: <span class="built_in">local</span>:    63010, <span class="built_in">source</span>:    63072</span><br><span class="line">update:   texlive-scripts.win32 [36k]: <span class="built_in">local</span>:    62199, <span class="built_in">source</span>:    63068</span><br><span class="line">update:   texlive-scripts    [504k]: <span class="built_in">local</span>:    63049, <span class="built_in">source</span>:    63068</span><br><span class="line">update:   utfsym            [4766k]: <span class="built_in">local</span>:    56729, <span class="built_in">source</span>:    63076</span><br><span class="line">update:   xduts              [871k]: <span class="built_in">local</span>:    63013, <span class="built_in">source</span>:    63075</span><br><span class="line">update:   zwpagelayout       [641k]: <span class="built_in">local</span>:    53965, <span class="built_in">source</span>:    63074</span><br></pre></td></tr></table></figure>
<p><strong>第一行</strong>会提示我们选择的软件包源, 这里我选择的是清华的源; </p>
<p><strong>第二行</strong>会提示我们备份的地址, 默认情况下会保留在 <code>/texlive/2022/tlpkg/backups</code>, 默认情况下会保留每个被更新的软件包的 local 版本的一个备份, 如果有更旧版本的备份, 则会用较新的 local 版本来替换这个旧的备份;</p>
<p><strong>第三行</strong>会提示我们将会被跳过的软件包, 包括手动使用 <code>-exclude</code> 选项排除的软件包以及被认为是 <code>forcibly-removed (强制删除)</code> 的软件包. 比如这里我曾经强制删除了 <code>collection-texworks</code> 软件包, 那么它在更新的时候将会跳过这个软件包.<br>然后会列出需要更新/安装/移除的软件包, 前缀分别为 <code>update</code>, <code>autoinst</code> 与 <code>auto-remove</code>. 后面跟着的数字为 <strong>revision</strong> 这是一个记录在 TeXLive 中的版本号, 即使软件包的作者可以随意更改他们的 cat-version (见后文), 但是 revision 总是在不断增加, 不可以随意改动. 并且可以利用 revision 来判断一个软件包是否更“新”.</p>
<h4 id="更新全部软件包"><a href="#更新全部软件包" class="headerlink" title="更新全部软件包"></a>更新全部软件包</h4><p><strong>注意</strong>: 这里所谓的更新, 是包括了自动删除, 自动安装, 更新操作的“更新”, 而非只将旧版本软件包升级.</p>
<p>通常情况下我们会直接选择更新全部软件包, 即运行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tlmgr update -self -all</span><br></pre></td></tr></table></figure>
<p>这里 <code>update</code> 是操作, <code>-self</code> 和 <code>-all</code> 均为 <code>update</code> 操作的特有选项, 其中 <code>-self</code> 是更新 <code>tlmgr</code> 本身以及相关软件, <code>-all</code> 是更新全部可更新的软件包.</p>
<h4 id="更新某些软件包"><a href="#更新某些软件包" class="headerlink" title="更新某些软件包"></a>更新某些软件包</h4><p>在可更新列表里如果发现了某些想更新的软件包, 比如 pkg1, pkg2, 那么就可以运行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tlmgr update pkg1 pkg2</span><br></pre></td></tr></table></figure>
<p>来更新这两个软件包, </p>
<h4 id="排除不想更新的软件包"><a href="#排除不想更新的软件包" class="headerlink" title="排除不想更新的软件包"></a>排除不想更新的软件包</h4><p>如果我们在更新全部软件包时不想更新软件包 pkg1, 那么可以运行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tlmgr update -self -all -exclude pkg1</span><br></pre></td></tr></table></figure>
<p>如果有多个不想更新的软件包 pkg1, pkg2, 那么可以多次使用 <code>-exclude</code> 命令</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tlmgr update -self -all -exclude pkg1 -exclude pkg2</span><br></pre></td></tr></table></figure>
<h4 id="更新过程被中断"><a href="#更新过程被中断" class="headerlink" title="更新过程被中断"></a>更新过程被中断</h4><p>如果软件包的更新由于网络原因中断, 或者由人为因素中断, 那么正在更新的软件包将会被视为<strong>用户强制删除(forcibly-removed)</strong>. 这时再更新就需要“重新安装”它们, 使用命令</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tlmgr update -self -all -reinstall-forcibly-removed</span><br></pre></td></tr></table></figure>
<p>当然, 更新过程中的 <code>-self</code> 不一定需要, 如果 <code>tlmgr</code> 没有需要更新的内容, 可以不写 <code>-self</code>.</p>
<h3 id="查看软件包的信息"><a href="#查看软件包的信息" class="headerlink" title="查看软件包的信息"></a>查看软件包的信息</h3><p>操作: <code>info</code></p>
<h4 id="查看某个软件包的基本信息"><a href="#查看某个软件包的基本信息" class="headerlink" title="查看某个软件包的基本信息"></a>查看某个软件包的基本信息</h4><p>如果我们想查看几个软件包 pkg1, pkg2 在 TeXLive 中的信息, 比如介绍, 版本号等等, 我们可以运行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tlmgr info pkg1 pkg2</span><br></pre></td></tr></table></figure>
<p>来获得信息, 我们用 <code>tlmgr info ctex</code> 来说明一下:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">package:     ctex</span><br><span class="line">category:    Package</span><br><span class="line">shortdesc:   LaTeX classes and packages for Chinese typesetting</span><br><span class="line">longdesc:    ctex is a collection of macro packages and document classes for LaTeX Chinese typesetting.</span><br><span class="line">installed:   Yes</span><br><span class="line">revision:    61285</span><br><span class="line">sizes:       src: 481k, doc: 1137k, run: 1753k</span><br><span class="line">relocatable: No</span><br><span class="line">cat-version: 2.5.8</span><br><span class="line">cat-license: lppl1.3c</span><br><span class="line">cat-topics:  chinese book-pub class</span><br><span class="line">cat-contact-bugs: https://github.com/CTeX-org/ctex-kit/issues</span><br><span class="line">cat-contact-support: https://github.com/CTeX-org/ctex-kit/issues</span><br><span class="line">cat-contact-repository: https://github.com/CTeX-org/ctex-kit</span><br><span class="line">cat-contact-home: http://www.ctex.org/HomePage</span><br><span class="line">collection:  collection-langchinese</span><br></pre></td></tr></table></figure>
<ol>
<li><code>package:</code> 这个软件包的名字</li>
<li><code>category:</code> 这个软件包所属的分类, 有 <code>Package</code>, <code>Collection</code>, <code>Scheme</code>. 注意这里的 <code>Package</code> 和 1. 中的 <code>package</code> 不是一样的.</li>
<li><code>shortdesc:</code> 这个软件包的短介绍(short description), 是软件包作者在推送到 CTAN 上时需要提交的.</li>
<li><code>longdesc:</code> 这个软件包的长介绍(long description), 是软件包作者在推送到 CTAN 上时需要提交的. </li>
<li><code>installed:</code> 这个软件包是否安装在了本地.</li>
<li><code>revision:</code> 修订版号(我不知道它应该翻译成什么, 因为我想用“版本号”来翻译<code>cat-version</code>), 随着软件包作者的推送, 它会越来越大, 并且 <code>tlmgr</code> 使用这个数字来判断软件包是否需要更新.</li>
<li><code>doc</code>, <code>run</code>, <code>src</code> 分别代表了这个软件包在 <code>/texlive/2022/texmf-dist</code> 文件夹下的 <code>doc</code>, <code>tex</code>, <code>source</code> 中的文件大小</li>
<li><code>relocatable:</code> 这个软件包是否可以重置, 这个内容在 <code>user-mode</code> 中比较重要, 一般用户不用管</li>
<li><code>cat-*:</code> 这个软件包在 CTAN 上分类 (category) 中的信息, 均是由软件包作者提供:<ol>
<li><code>version:</code> 软件包的版本号, 由软件包的作者给定, 它不需要遵循递增的规律.</li>
<li><code>licence:</code> 软件包使用的开源协议.</li>
<li><code>topics:</code> 这个软件包在 CTAN 上归属于哪个主题.</li>
<li><code>contact-bugs/support/repository/home:</code> 分别指这个软件包的上报 bug 的地址, 提供支持的地址, 软件包所在的仓库, 软件包的主页. </li>
</ol>
</li>
<li><code>collection:</code> 这个软件包属于哪个集合. TeXLive 上的软件包都被分为格式 (scheme), 集合 (collection) 和软件包 (package), 他们是依次包含的关系. </li>
</ol>
<h4 id="列出某个软件包的更详细的信息"><a href="#列出某个软件包的更详细的信息" class="headerlink" title="列出某个软件包的更详细的信息"></a>列出某个软件包的更详细的信息</h4><p>如果想查看某几个软件包 pkg1 pkg2 中都包含了什么文件, 有哪些平台特定的依赖, 可以使用</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tlmgr info -list pkg1 pkg2</span><br></pre></td></tr></table></figure>
<p>其中 <code>-list</code> 是 <code>info</code> 操作的特有选项, 我们 <code>tlmgr info -list tabularray</code> 为例</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 省略 tlmgr info tabularray 的内容 #</span><br><span class="line">Included files, by type:</span><br><span class="line">run files:</span><br><span class="line">  texmf-dist/tex/latex/tabularray/tabularray-2021.sty</span><br><span class="line">  texmf-dist/tex/latex/tabularray/tabularray.sty</span><br><span class="line">doc files:</span><br><span class="line">  texmf-dist/doc/latex/tabularray/README.txt details=&quot;Readme&quot;</span><br><span class="line">  texmf-dist/doc/latex/tabularray/tabularray.pdf details=&quot;Package documentation&quot;</span><br><span class="line">  texmf-dist/doc/latex/tabularray/tabularray.tex</span><br></pre></td></tr></table></figure>
<p>可以看到 <code>run files</code> 和 <code>doc files</code> 分别的位置.</p>
<h3 id="回滚软件包的版本"><a href="#回滚软件包的版本" class="headerlink" title="回滚软件包的版本"></a>回滚软件包的版本</h3><p>操作: <code>restore</code></p>
<h4 id="查看某个软件包的备份"><a href="#查看某个软件包的备份" class="headerlink" title="查看某个软件包的备份"></a>查看某个软件包的备份</h4><p>如果想查看某个软件包 pkg 在备份中的 revision, 可以使用</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tlmgr restore pkg</span><br></pre></td></tr></table></figure>
<p>如果存在备份, 那么就会返回一个 revision 的值, 我们以 <code>tlmgr restore functional</code> 为例, 会得到一个如下的输出</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Available backups for functional: 62926 (2022-04-17 11:15)</span><br></pre></td></tr></table></figure>
<p>可以看到存在一个 revision 为 62926 的备份. </p>
<h4 id="将某个软件包回滚为备份"><a href="#将某个软件包回滚为备份" class="headerlink" title="将某个软件包回滚为备份"></a>将某个软件包回滚为备份</h4><p>如果我们获得了某个软件包 pkg 在备份中的 revision, 就可以使用</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tlmgr restore pkg revision</span><br></pre></td></tr></table></figure>
<p>来将 pkg 回滚. 比如这时候我们可以使用 </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tlmgr restore functional 62926</span><br></pre></td></tr></table></figure>
<p>来将 functional 软件包回滚为 revision 62926.<br>这个方法在某个软件包更新后出现了不兼容的时候很好用. </p>
<h3 id="修改-tlmgr-的设置"><a href="#修改-tlmgr-的设置" class="headerlink" title="修改 tlmgr 的设置"></a>修改 <code>tlmgr</code> 的设置</h3><p>操作: <code>option</code></p>
<p>这里只列出一个常用的命令</p>
<h4 id="设置软件包的更新源"><a href="#设置软件包的更新源" class="headerlink" title="设置软件包的更新源"></a>设置软件包的更新源</h4><p>如果要将软件包的更新源设置为 <code>&lt;mirror&gt;</code>, 那么可以使用</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tlmgr option repository &lt;mirror&gt;</span><br></pre></td></tr></table></figure>
<p>来进行更改, 其中 <code>repository</code> 可以简化为 <code>repo</code>. 默认设置下的源为 <code>ctan</code>, 它告诉 <code>tlmgr</code> 它可以从一个附近的 CTAN 镜像去获取最近的更新, 这条命令还可以写成</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tlmgr option repository http://mirror.ctan.org/systems/texlive/tlnet</span><br></pre></td></tr></table></figure>
<p>其中 <code>ctan</code> 是 <code>http://mirror.ctan.org/systems/texlive/tlnet</code> 的别名. </p>
<p><strong>注意</strong> mirror.ctan.org 会被解析为多个不同的域名, 它们并不是完全同步的, 我们建议 (它们) 最多每天更新一次<sup><a href="#fn_update" id="reffn_update">update</a></sup>. 如果出现了问题, 我们建议您选择一个特定的镜像站. 全部的镜像站以及它们的状态会列在 <a href="https://ctan.org/mirrors/mirmon">镜像站列表</a><sup><a href="#fn_mainland" id="reffn_mainland">mainland</a></sup>. </p>
<blockquote id="fn_update">
<sup>update</sup>. mirror.ctan.org resolves to many different hosts, and they are not perfectly synchronized; we recommend updating only daily (at most), and not more often. <a href="#reffn_update" title="Jump back to footnote [update] in the text."> &#8617;</a>
</blockquote>
<blockquote id="fn_mainland">
<sup>mainland</sup>. 这个表格来自 <a href="https://github.com/OsbertWang/install-latex-guide-zh-cn">install-latex-guide-zh-cn</a>. <a href="#reffn_mainland" title="Jump back to footnote [mainland] in the text."> &#8617;</a>
</blockquote>
<h4 id="大陆地区镜像"><a href="#大陆地区镜像" class="headerlink" title="大陆地区镜像"></a>大陆地区镜像</h4><p>大陆用户可以将源指定为国内的镜像站, 在 CTAN 上可以找到 <a href="https://ctan.org/mirrors#Asia">亚洲镜像列表</a> . 下面列举出截止至 2022-04-20 可用的镜像站: </p>
<div class="table-container">
<table>
<thead>
<tr>
<th>镜像名</th>
<th>镜像地址</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://developer.aliyun.com/mirror/">阿里云</a></td>
<td><a href="https://mirrors.aliyun.com/CTAN/systems/texlive/">https://mirrors.aliyun.com/CTAN/systems/texlive/</a></td>
</tr>
<tr>
<td><a href="https://mirror.bjtu.edu.cn/">北京交通大学</a></td>
<td><a href="https://mirror.bjtu.edu.cn/ctan/systems/texlive/">https://mirror.bjtu.edu.cn/ctan/systems/texlive/</a></td>
</tr>
<tr>
<td><a href="https://mirrors.bit.edu.cn/web/">北京理工大学</a></td>
<td><a href="https://mirrors.bit.edu.cn/CTAN/systems/texlive/">https://mirrors.bit.edu.cn/CTAN/systems/texlive/</a></td>
</tr>
<tr>
<td><a href="https://mirrors.bfsu.edu.cn/">北京外国语大学</a></td>
<td><a href="https://mirrors.bfsu.edu.cn/CTAN/systems/texlive/">https://mirrors.bfsu.edu.cn/CTAN/systems/texlive/</a></td>
</tr>
<tr>
<td><a href="https://mirrors.cqu.edu.cn/">重庆大学</a></td>
<td><a href="https://mirrors.cqu.edu.cn/CTAN/systems/texlive/">https://mirrors.cqu.edu.cn/CTAN/systems/texlive/</a></td>
</tr>
<tr>
<td><a href="https://mirrors.dgut.edu.cn/">东莞理工学院</a></td>
<td><a href="https://mirrors.dgut.edu.cn/CTAN/systems/texlive/">https://mirrors.dgut.edu.cn/CTAN/systems/texlive/</a></td>
</tr>
<tr>
<td><a href="https://mirrors.hit.edu.cn/">哈尔滨工业大学</a></td>
<td><a href="https://mirrors.hit.edu.cn/CTAN/systems/texlive/">https://mirrors.hit.edu.cn/CTAN/systems/texlive/</a></td>
</tr>
<tr>
<td><a href="https://mirrors.huaweicloud.com/">华为云</a></td>
<td><a href="https://mirrors.huaweicloud.com/CTAN/systems/texlive/">https://mirrors.huaweicloud.com/CTAN/systems/texlive/</a></td>
</tr>
<tr>
<td><a href="http://mirrors.hust.edu.cn/">华中科技大学</a></td>
<td><a href="http://mirrors.hust.edu.cn/CTAN/systems/texlive/">http://mirrors.hust.edu.cn/CTAN/systems/texlive/</a></td>
</tr>
<tr>
<td><a href="https://mirror.lzu.edu.cn/">兰州大学</a></td>
<td><a href="https://mirror.lzu.edu.cn/CTAN/systems/texlive/">https://mirror.lzu.edu.cn/CTAN/systems/texlive/</a></td>
</tr>
<tr>
<td><a href="https://mirrors.nju.edu.cn/">南京大学</a></td>
<td><a href="https://mirrors.nju.edu.cn/CTAN/systems/texlive/">https://mirrors.nju.edu.cn/CTAN/systems/texlive/</a></td>
</tr>
<tr>
<td><a href="https://mirrors.tuna.tsinghua.edu.cn/">清华大学</a></td>
<td><a href="https://mirrors.tuna.tsinghua.edu.cn/CTAN/systems/texlive/">https://mirrors.tuna.tsinghua.edu.cn/CTAN/systems/texlive/</a></td>
</tr>
<tr>
<td><a href="https://mirrors.sjtug.sjtu.edu.cn/">上海交通大学</a></td>
<td><a href="https://mirrors.sjtug.sjtu.edu.cn/ctan/systems/texlive/">https://mirrors.sjtug.sjtu.edu.cn/ctan/systems/texlive/</a></td>
</tr>
<tr>
<td><a href="https://mirrors.geekpie.club/">上海科技大学</a></td>
<td><a href="https://mirrors.geekpie.club/CTAN/systems/texlive/">https://mirrors.geekpie.club/CTAN/systems/texlive/</a></td>
</tr>
<tr>
<td><a href="https://mirrors.cloud.tencent.com/">腾讯云</a></td>
<td><a href="https://mirrors.cloud.tencent.com/CTAN/systems/texlive/">https://mirrors.cloud.tencent.com/CTAN/systems/texlive/</a></td>
</tr>
<tr>
<td><a href="https://mirrors.ustc.edu.cn/">中国科学技术大学</a></td>
<td><a href="https://mirrors.ustc.edu.cn/CTAN/systems/texlive/">https://mirrors.ustc.edu.cn/CTAN/systems/texlive/</a></td>
</tr>
</tbody>
</table>
</div>
<p>并用 <code>tlmgr option repository &lt;site&gt;/tlnet</code> 的方式进行设置. </p>
<h3 id="更多内容"><a href="#更多内容" class="headerlink" title="更多内容"></a>更多内容</h3><p>如果想了解更多关于 <code>tlmgr</code> 的信息, 欢迎阅读我翻译的 <a href="http://mirrors.ctan.org/info/tlmgr-intro-zh-cn/tlmgr-intro-zh-cn.pdf">tlmgr-intro-zh-cn</a> 以及 <a href="https://www.tug.org/texlive/doc/tlmgr.html"><code>tlmgr</code> 的官方文档</a></p>
<h2 id="我们的-VSCode-安装好了"><a href="#我们的-VSCode-安装好了" class="headerlink" title="我们的 VSCode 安装好了"></a>我们的 VSCode 安装好了</h2><p>我们来简单的配置一下 VSCode</p>
<ol>
<li><p>刚打开的 VSCode 会提示我们切换界面语言:</p>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/latex-tutorial/change-lang.png" alt="更改语言"></p>
<p>如果没来得及点，发现提示消失了，点击右下角的铃铛即可出现</p>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/latex-tutorial/bell.png" alt="铃铛"></p>
</li>
</ol>
<p>点击之后<strong>什么也不用做</strong>，即使它页面有变化，等待它自己安装完成重启即可，出现下图的效果说明语言设置成功：</p>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/latex-tutorial/chinese.png" alt="更改语言成功"></p>
<ol>
<li>然后我们安装一下 LaTeX 相关的插件 <code>LaTeX-workshop</code>. 点击左侧工具栏的最下方的“扩展”</li>
</ol>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/latex-tutorial/extension.png" alt="扩展"></p>
<p>输入<code>latex</code></p>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/latex-tutorial/input-latex.png" alt="输入 `latex`"></p>
<p>出来的第一个<code>LaTeX-Workshop</code>就是我们要的，点击安装</p>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/latex-tutorial/lw.png" alt="latex-workshop"></p>
<p>等待一会，当左侧的“安装”消失了或者右侧的“安装”变成了“禁用”“卸载”就说明安装成功了</p>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/latex-tutorial/inst-success.png" alt="成功安装"></p>
<ol>
<li>我们的 VSCode 暂时就配置好了, 至于那些 recipes, 后面再说. </li>
</ol>
<h2 id="命令行编译"><a href="#命令行编译" class="headerlink" title="命令行编译"></a>命令行编译</h2><p>这里我直接放一个之前写过的 <a href="/2022-03-06-latex-terminal-compiling/" title="在终端中编译 LaTeX">在终端中编译 LaTeX</a>.</p>
<h2 id="如何安装外部宏包"><a href="#如何安装外部宏包" class="headerlink" title="如何安装外部宏包"></a>如何安装外部宏包</h2><p>通常情况下我们需要的宏包都被 TeXLive 收录, 并且随 TeXLive 安装在了我们的电脑中, 如果我们想确认一个宏包 pkg 是否被安装了, 可以使用</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tlmgr info pkg</span><br></pre></td></tr></table></figure>
<p>或</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">kpsewhich pkg.sty</span><br></pre></td></tr></table></figure>
<p>如果宏包已经被安装了, 那么前者会有输出 <code>Installed: Yes</code>, 后者会输出 <code>pkg.sty</code> 的路径. </p>
<p>如果我们需要安装一个没有被 TeXLive 收录的宏包, 如 <code>mcode.sty</code>, 那么需要怎么做呢？这里我们用一个简单的文件来做示范. </p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="comment">% mypackage.sty</span></span><br><span class="line"><span class="keyword">\NeedsTeXFormat</span>&#123;LaTeX2e&#125;[2017/04/15]</span><br><span class="line"><span class="keyword">\ProvidesPackage</span>&#123;mypackage&#125;[2022/4/20 v1.0 test]</span><br><span class="line"><span class="keyword">\newcommand</span>&#123;<span class="keyword">\mycmd</span>&#125;&#123;Hello <span class="keyword">\LaTeX</span>&#125;</span><br></pre></td></tr></table></figure>
<p>将上述代码保存为 <code>mypackage.sty</code>, 这个宏包的内容非常简单, 它定义了一个命令 <code>\mycmd</code> 来输出 <code>Hello \LaTeX</code>. 现在我们把它安装到我们的电脑中, 让每一个 TeX 文档都可以通过 <code>\usepackage&#123;mypackage&#125;</code> 来使用这个宏包. </p>
<ol>
<li>在 <code>/texlive/texmf-local/tex/latex</code> 文件夹下, 新建一个文件夹, 名为 <code>mypackage</code>, 然后我们把 <code>mypackage.sty</code> 放进去.</li>
<li>在命令行运行 <code>texhash</code> 来刷新数据库, 如果得到</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">texhash: Updating C:/texlive/texmf-local/ls-R...</span><br><span class="line">texhash: Updated C:/texlive/texmf-local/ls-R.</span><br><span class="line">texhash: Updating C:/texlive/2022/texmf-config/ls-R...</span><br><span class="line">texhash: Updated C:/texlive/2022/texmf-config/ls-R.</span><br><span class="line">texhash: Updating C:/texlive/2022/texmf-var/ls-R...</span><br><span class="line">texhash: Updated C:/texlive/2022/texmf-var/ls-R.</span><br><span class="line">texhash: Updating C:/texlive/2022/texmf-dist/ls-R...</span><br><span class="line">texhash: Updated C:/texlive/2022/texmf-dist/ls-R.</span><br><span class="line">texhash: Done.</span><br></pre></td></tr></table></figure>
<p>如果得到一些 Permission denied, 那就需要用管理员权限打开命令行, 再运行 <code>texhash</code>.</p>
<ol>
<li><p>然后可以用 <code>kpsewhich mypackage.sty</code> 来测试一下能不能找到这个宏包, 如果有输出</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">c:/texlive/texmf-local/tex/latex/mypackage/mypackage.sty</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>那么说明安装成功. 我们新建一个 <code>main.tex</code> 文件, 写入</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line"><span class="comment">% main.tex</span></span><br><span class="line"><span class="keyword">\documentclass</span>&#123;article&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;mypackage&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line">  <span class="keyword">\mycmd</span></span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<p>使用 <code>pdflatex</code> 编译, 即可得到输出.</p>
<h2 id="配置-VSCode-的编译链"><a href="#配置-VSCode-的编译链" class="headerlink" title="配置 VSCode 的编译链"></a>配置 VSCode 的编译链</h2><p>在网上形形色色的 VSCode + TeXLive 教程中, 总会看到它们提供一个 <code>settings.json</code> 文件, 说把它粘贴到你的电脑里, 配置就完成了, 然而我们在做这个事情的时候, 通常都不知道自己在做什么. </p>
<p>现在我们已经了解了什么是编译命令, 什么是编译选项, 那么我们就可以写一个属于自己的配置单, 就算我们不会自己写, 也可以看懂别人在写什么了.</p>
<p>这里我贴一个 <a href="https://gitee.com/xkwxdyy/CCNUthesis/wikis/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98FAQ/%E5%A6%82%E4%BD%95%E5%AE%89%E8%A3%85%E3%80%81%E9%85%8D%E7%BD%AE%E5%92%8C%E4%BD%BF%E7%94%A8VScode">CCNUthesis.wiki 的链接</a></p>
<h2 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h2><p>这就是这次分享会我要讲的东西, 我也只是一个普通的用户, 使用的时候也需要常翻手册去找命令叫什么, 命令的参数是什么. 有能力学底层的用户可以读一下 the texbook, <code>texdoc source2e</code>, <code>texdoc texbytopic</code>, <code>texdoc classes</code>, <code>texdoc interface3</code> 等等, 有些内容了解了底层之后会更加的明了, 当然, 做一个关注于用户层的使用者也不是什么丢人的事. 希望大家可以多读手册, 多学习, 有不懂的东西可以积极向社区提问, 包括但不限于</p>
<ul>
<li><a href="https://tex.stackexchange.com/">tex.stackexchange.com</a></li>
<li><a href="https://github.com/CTeX-org/forum/issues">CTeX-org/forum</a></li>
<li><a href="https://ask.latexstudio.net/">LaTeX 工作室</a></li>
</ul>
]]></content>
      <categories>
        <category>帮助文档</category>
        <category>LaTeX</category>
      </categories>
      <tags>
        <tag>帮助文档</tag>
        <tag>LaTeX</tag>
      </tags>
  </entry>
  <entry>
    <title>PETSc 的安装与配置</title>
    <url>/2022-12-14-petsc-install/</url>
    <content><![CDATA[<p><strong>P</strong>ortable, <strong>E</strong>xtensible <strong>T</strong>oolkit <strong>S</strong>cientific <strong>C</strong>omputations.</p>
<span id="more"></span>
<h2 id="PETSc-的安装"><a href="#PETSc-的安装" class="headerlink" title="PETSc 的安装"></a>PETSc 的安装</h2><p>首先跟着<a href="https://petsc.org/release/install/download/">官网的下载教程</a>走, 如果有连接 <a href="gitlab.com">GitLab</a> 的能力, 可以直接 <code>clone</code> 最新的版本, 即</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> -b release https://gitlab.com/petsc/petsc.git petsc</span><br><span class="line">git pull</span><br></pre></td></tr></table></figure>
<p>如果没有条件, 可以直接下载压缩包并解压<sup><a href="#fn_固定版本" id="reffn_固定版本">固定版本</a></sup></p>
<blockquote id="fn_固定版本">
<sup>固定版本</sup>. 旧的版本只推荐用来运行旧程序, 建议永远使用最新的版本.<a href="#reffn_固定版本" title="Jump back to footnote [固定版本] in the text."> &#8617;</a>
</blockquote>
<h2 id="PTESc-的配置"><a href="#PTESc-的配置" class="headerlink" title="PTESc 的配置"></a>PTESc 的配置</h2><h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><p>首先安装好 “C Compiler (gcc)”, “Fortran”, “make”, “Python3”, 然后进行阅读, 其他配置可以参考<a href="https://petsc.org/release/install/install/">官网</a> 以及命令行帮助 <code>./configure --help</code>.</p>
<p>通常我们需要两个版本 <code>debug</code> (输出更多的报错信息) 与 <code>opt</code> (不带 <code>debug</code> 的版本的, 性能更好)</p>
<p>首先编辑 <code>~/.bashrc</code> 或 <code>~/.zshrc</code>:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim ~/.zshrc</span><br><span class="line"><span class="comment"># 编辑 ~/.zshrc</span></span><br><span class="line"><span class="built_in">export</span> <span class="variable">$PETSC_DIR</span>=<span class="built_in">where</span>/you/downloaded/or/cloned/petsc</span><br><span class="line"><span class="built_in">export</span> <span class="variable">$PETSC_ARCH</span>=arch-linux-c-debug</span><br><span class="line"><span class="comment"># export $PETSC_ARCH=arch-linux-c-opt</span></span><br><span class="line"><span class="comment"># 退出 vim</span></span><br><span class="line"><span class="built_in">source</span> ~/.zshrc</span><br></pre></td></tr></table></figure>
<p>之后只需要更改 <code>$PETSC_ARCH</code> 的值即可切换不同的版本<sup><a href="#fn_petscarch" id="reffn_petscarch">petscarch</a></sup>.</p>
<blockquote id="fn_petscarch">
<sup>petscarch</sup>. <code>$PETSC_ARCH</code> 可以自行定义名称, 但是不要含空格.<a href="#reffn_petscarch" title="Jump back to footnote [petscarch] in the text."> &#8617;</a>
</blockquote>
<ul>
<li>如果本地已经有了 MPI 相关的程序, 如 <a href="https://www.open-mpi.org/"><code>OpenMPI</code></a> 或 <a href="https://www.mpich.org/"><code>MPICH</code></a>, 以及有 <a href="https://www.netlib.org/lapack/lug/node11.html">BLAS/LAPACK</a> 程序, 那么直接在 <code>$PETSC_DIR</code> 目录下运行</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./configure</span><br></pre></td></tr></table></figure>
<p>即可. 运行后可以发现在 <code>$PETSC_DIR</code> 的目录下多了一个名为 <code>$PETSC_ARCH</code> 的文件夹, 这就是以默认配置生成库的文件夹. 然后跟随终端提示</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">make PETSC_DIR=/some/dir PETSC_ARCH=arch-linux-c-debug all</span><br><span class="line">make PETSC_DIR=/some/dir PETSC_ARCH=arch-linux-c-debug check</span><br></pre></td></tr></table></figure>
<ul>
<li>如果本地没有 MPI 可以选择添加选项 <code>--download-mpich</code> (官网推荐) 或 <code>--download-openmpi</code>; 如果没有 BLAS/LAPACK, 则添加选项 <code>--download-fblaslapack</code>, 即</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 啥都没有</span></span><br><span class="line">./configure --with-cc=gcc --with-cxx=g++ --with-fc=gfortran --download-mpich --download-fblaslapack</span><br></pre></td></tr></table></figure>
<p>然后跟着命令提示完整接下来的 check. </p>
<p><strong>注意</strong>: 如果本地有 MPI, 并且没有使用 <code>--with-mpi=0</code>, 则不需要添加 <code>--with-cc/cxx/fc</code> 这三个选项, MPI 会自动使用 <code>mpicc</code>, <code>mpicxx</code>, <code>mpif90</code>.</p>
<p>然后将 <code>~/.zshrc</code> 或 <code>~/.bashrc</code> 中的 <code>$PETSC_ARCH</code> 中的值修改为 <code>opt</code> 的版本, 并 <code>source</code>, 随后进行配置, 其余的配置与上文完全一致, 只需要在 <code>./configure</code> 的选项中添加 <code>--with-debugging=0</code> 即可, 随后依然按照命令行提示完成接下来的配置.</p>
<p>最后, 可以在 <code>~/.zshrc</code> 或 <code>~/.bashrc</code> 文件中添加</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> C_INCLUDE_PATH=<span class="variable">$PETSC_DIR</span>/include:<span class="variable">$PETSC_DIR</span>/<span class="variable">$PETSC_ARCH</span>/include:<span class="variable">$C_INCLUDE_PATH</span></span><br></pre></td></tr></table></figure>
<p>来将 PETSc 中的头文件路径添加到 include path 中.</p>
<h3 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h3><p>按照<a href="https://petsc.org/release/install/multibuild/#updating-or-reinstalling-petsc">官网的说明</a>, 更新了源码之后需要使用</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">make lib</span><br></pre></td></tr></table></figure>
<p>来更新库文件.</p>
]]></content>
      <categories>
        <category>配置记录</category>
        <category>PETSc</category>
      </categories>
      <tags>
        <tag>配置记录</tag>
        <tag>帮助文档</tag>
        <tag>Linux</tag>
        <tag>PETSc</tag>
        <tag>HPC</tag>
      </tags>
  </entry>
  <entry>
    <title>南京小记</title>
    <url>/2023-02-22-tour-in-nanjing/</url>
    <content><![CDATA[<p>2023 春季学期开学的前一周和小璃去南京玩了三天， 体验很好。</p>
<span id="more"></span>
<p><img src="https://raw.githubusercontent.com/syvshc/image/master/postimg/tor-in-nanjing/clubs.jpg" alt="梅花山"></p>
<p>听司机师傅说，我们来南京之前南京一直在下雨，和小璃玩的这三天一滴雨都没有。</p>
<p>开学前一周的和小璃的第二次短途旅游也落下了帷幕，三天时间浅浅逛了南京，想去的地方都去了一趟，想吃的东西都吃了一遍，甘蔗汁和现煎的锅贴真的很妙。</p>
<p>鸡鸣寺人很多，拜财神的也很多，老门东的小店很多，画手掌画的大爷手艺很好。夫子庙确实没什么好逛的，除了游船和灯会。路边的酥烧饼，臭豆腐和糖芋苗都很好吃。晚上约饭怕迟到选择了打车，但是3。3公里40分钟的车程让我们接下来的行程中完全放弃了打车。</p>
<p>南京博物院是第一次租讲解器的景点，了解了一些文物的来历，看到了一些奇怪的物件，工艺细腻的清代钟表很吸引我们。李记清真馆的牛肉锅贴和酱牛肉非常好吃，推荐的牛肉馄饨却平平无奇。</p>
<p>在科巷里吃了唯一一次鸭血粉丝汤，有本地人去的店味道确实不错。买了一些在付款之后才知道是什么的炸藕饼， 看评论才知道这个东西是用来炒菜的，还买了许阿姨的青团和马蹄糕。加了柠檬片的甘蔗汁非常好喝， 真是想见一个摊喝一杯。赶在人少的时间去了红山动物园，票价很值，看到了黑熊打闹以及各种聪明的灵长类动物。上上下下的坡走得很疲惫，到了明孝陵后发现已经关门，临时起义绕着玄武湖走了大半圈，吹着风，如果没有穿着大棉裤就更惬意了。排了一个茶颜悦色，感觉挺好喝，但是没有那么好喝。本来想去南京大排档但是要排 200 多桌，临时换了一家杭州菜馆，也非常好吃，晚上去的推拿馆的师傅手法很好，出来等车的时候看到一家锅贴馆，看到老板正在下一锅新的锅贴，还是没忍住进去吃了一顿夜宵。</p>
<p>没排上叶新小吃而随便找的一家三鲜面馆很不错，它甚至在高德上都没有名字，路边随便买的烤鸭也很好吃，师傅的菜板被切得已经凹了下去。南京大屠杀纪念馆很压抑，最后没看完就出来了。明孝陵属实没有什么意思，但是上城楼之前给免费照相挺不错的。梅花山很好看，也是生平第一次看到梅花，下了山临时起意去吃了一顿南京大排档，王府泡椒鸡很好吃，剩下的出品和在上海体验极差的那次没什么区别。去德基的高档厕所打了个卡，在新街口地铁站迷了路。两杯新地作为这次南京之行的收尾。</p>
<p>路边摊有时不比网红店差，有烟火气的小店值得一去，感受一下当地人平时下的馆子也是一种不一样的体验。</p>
<p>行程突出一个随性，除了南京博物院提前预约了以外，剩下的都是想到哪去哪，包括取消了扬州的行程，本来打算回苏州去一趟同里/甪直，但是因为太过疲倦取消了，并且推迟了回苏州的火车。到了苏州吃了一顿线下的棒约翰，又临时起意逛了一圈金鸡湖。</p>
<p>接下来要好好学习了，这也可能是我最后一个有时间且可以潇洒（也许不应该潇洒）的假期，珍惜接下来的每一次旅游以及和小璃的团聚吧。</p>
]]></content>
      <categories>
        <category>日常</category>
      </categories>
      <tags>
        <tag>日常</tag>
        <tag>游记</tag>
      </tags>
  </entry>
  <entry>
    <title>$p$ 群的正规子群</title>
    <url>/2022-09-09-p-group-normal-subgroup-of-p-m/</url>
    <content><![CDATA[<p>在 <a href="https://en.wikipedia.org/wiki/P-group">Wiki</a> 上看到了这样一个命题:</p>
<blockquote>
<p>If $p$ is prime and $G$ is a group of order $p^k$, then $G$ has a normal subgroup of order $p^m$ for every $1\leqslant m \leqslant k$.</p>
</blockquote>
<p>下面来证明这个看起来很强的结论. </p>
<span id="more"></span>
<p>首先先给一些会用到的知识:</p>
<p><strong>定义</strong> 若有限群 $G$ 的阶等于 $p^m$, 其中 $p$ 为素数, 则称 $G$ 是一个 $p$ 群.</p>
<p><strong>定理</strong> 任意 $p$ 群的中心 $C$ 含有不止一个元素. </p>
<p>这个定理可以由有限群的类方程 (class equation):</p>
<script type="math/tex; mode=display">|G| = |C| + \sum[G:C(y_i)]</script><p>来说明, 这里 $C(y_i)$ 表示 $y_i$ 在 $G$ 中的中心化子, $y_i$ 是 $G$ 中每个含不止一个元素的共轭类的代表元.</p>
<p><strong>命题</strong> $p^2$ 阶群是 Abel 群, 其中 $p$ 是素数.</p>
<p><strong>定理</strong>(Cauchy) 设  $G$ 是一个有限 Abel 群, $p$ 是素数, 若 $p\mid |G|$, 则 $G$ 有一个周期为 $p$ 的元素, 从而 $G$ 有一个 $p$ 阶的子群, 这个群是循环群. </p>
<p><strong>定理</strong>(对应定理) 设 $f: G_1 \to G_2$ 是满同态, 则映射 $H \to f(H)$ 定义了 $G_1$ 包含 $ \ker f$ 的子群集与 $G_2$ 的子群集之间的一一对应, 在这个对应下, $H\triangleleft G_1$ 当且仅当 $f(H)\triangleleft G_2$. </p>
<p><strong>注意: 这里只有当 $\ker f \subset H$, 且 $f$ 是满同态的时候有 $H\triangleleft G_1 \Longleftrightarrow f(H)\triangleleft G_2$ 的结论.</strong></p>
<p>下面来证明这个命题. </p>
<p><strong>证明</strong> 用数学归纳法, 对 $|G|$ 的阶数 $p^k$ 中的 $k$ 进行归纳. 当 $k = 2$ 时, 这时 $|G|=p^2$, 由 Cauchy 定理知 $G$ 存在一个 $p$ 阶子群 $H$, 又因为 $G$ 是 Abel 群, 那么就有 $H \triangleleft G$, 这是因为对任意的 $h \in H,\ g \in G$, 都有 $hg=gh$, 那自然就有</p>
<script type="math/tex; mode=display">Hg=gH.</script><p>假设 $|G|=p^k$ 时, 对于任意的 $1\leqslant m\leqslant k$, $G$ 都存在一个阶为 $p^m$ 的正规子群. </p>
<p>下面考虑 $|G|=p^{k+1}$ 时. 由于 $G$ 的中心 $C$ 是一个 Abel 群, 且 $C$ 中元素不止一个, 那就有 $p\mid |C|$, 由 Cauchy 定理知 $C$ 存在一个周期为 $p$ 的元素 $a$, 也就是说循环群 $H = \langle a\rangle$ 是 $C$ 的子群, 从而是 $C$ 的正规子群. 而任意的 $a^\ell$ 与 $g \in G$ 乘法都可交换, 所以 $H \triangleleft G$, 这时我们找到了一个阶为 $p$ 的正规子群. 下面找阶数更高的. 做商群 $G/H$, 于是有</p>
<script type="math/tex; mode=display">|G/H| = [G:H] = |G|/|H| = p^k,</script><p>那么由归纳假设可知对于任意的 $1\leqslant m \leqslant k$, $G/H$ 都含有一个阶为 $p^m$ 的正规子群, 设为 $N/H$, 于是</p>
<script type="math/tex; mode=display">|N|=|N/H|\cdot|H|=p^{m+1},</script><p>那么只要说明 $N\triangleleft G$ 即可. 做自然同态</p>
<script type="math/tex; mode=display">\begin{aligned}
  f : G & \to G/H \\
  g & \mapsto gH
\end{aligned},</script><p>显然这是一个满同态, 并且</p>
<script type="math/tex; mode=display">\ker f = \{g \in G: f(g)=eH\} = \{g \in G: gH=eH\} = H,</script><p>所以有 $H \subset N$, 于是由对应定理可知当 $f(N) = N/H$ 是 $G/H$ 的正规子群时, $N$ 是 $G$ 的正规子群. </p>
<p>归纳结束, 命题得证. </p>
]]></content>
      <categories>
        <category>数学</category>
        <category>代数</category>
      </categories>
      <tags>
        <tag>数学</tag>
        <tag>抽象代数</tag>
        <tag>群论</tag>
      </tags>
  </entry>
  <entry>
    <title>小璃闪击北京</title>
    <url>/2023-04-09-tour-in-beijing-in-one-day/</url>
    <content><![CDATA[<p>一念之间的想法，让我在这天见到了小璃，开心呢。</p>
<span id="more"></span>
<p>4.7 晚上小璃下了课直奔火车站，上了来北京的火车。</p>
<p>4.8 早上在北京南见到了朝思暮想的人儿，开心地一直在乐。</p>
<p>倒了地铁去了清华，感谢翔鸣赞助的酸菜鱼和黑五珍，聪明饭确实好吃，浅浅地逛了一下清华北边，在清华园和情人坡照了相，不知道近春园荷塘里的鸳鸯为什么只剩了一只。在外语系门口拜了拜，小璃的论文肯定能过。</p>
<p>出清华坐地铁去赶小火车，还是没有赶上，我对于时间的把控好像非常差，改签了北京站的火车，还好在约定时间来到了国科大。</p>
<p>小璃见到了之前只在视频中见到的人，见到了只在视频里出现的食堂，买到了只给我买过的满满家。</p>
<p>4.10 早上四点半起床，抹黑走了两公里的小路来到了学校，原来钟楼和长城的灯也会灭。跟着天文所的同学上了观景台，真害怕因为多云看不到日出啊，不过太阳还是不负众望地从云彩里钻出来了，真好看，值得起大早。</p>
<p>本来想下了观景台去图书馆转转，这个b图书馆竟然八点才开门，这就是我不愿意去图书馆的原因。带小璃吃了一次食堂的早餐，意外地不错，小璃还吃到了久违的炉箅子。</p>
<p>8点多来到了大门口，坐上了去往市里的大巴，来到了天安门广场，有很多的旅行团，抓了几个人给我和小璃照相。</p>
<p>11点进了故宫博物院，南京博物院以后感觉讲解设备还是挺有趣的，不过故宫这个智能讲解不是那么的智能，有点呆呆的。</p>
<p>前部分的故宫感觉有一些无聊，殿里什么都看不见，也没有所谓的金碧辉煌，到东西六宫附近就是小璃的主场了，刷烂甄嬛传真不是盖的，如数家珍。</p>
<p>还和小璃吃到了故宫下午茶，我俩至少有一个人味觉有问题，她觉得齁甜的我觉得没味，荔枝杨梅挺好吃，学名叫……馥香红梅妃子饮。刚才问小璃下次还吃下午茶吗，小璃的评价是：狗都不吃。吃完了接着在故宫里暴走，每到一个宫小璃都能背两句台词，真的是厉害。</p>
<p>本来以为下午两点就逛完故宫，结果逛到下午四点，来不及逛北师大了，可惜朱老师昨天帮我们预约入校了。</p>
<p>出了故宫感觉腿和脑子都不是自己的了，从来没这么累过，打算让一个观光大巴直接把我们扔在地铁站，结果下车的地方离地铁站还有700m，服气。然后地铁加打车来到了我接下来4年要呆的数学所。看完清华小璃表示湖里真惨，看完所里小璃表示湖里也还行……</p>
<p>随机抓了一个没吃过的家常菜馆打算吃晚饭，不过离小璃出发的时间挺近的了，加上我对时间多次估计不准的先例，小璃直接选择点完菜直接打包然后直奔火车站。事实证明我只能估对走路的时间，到车站已经开始检票了。本来觉得6月底还要去海南，很快还会再见面，但是检票的时候还是没绷住。</p>
<p>两天加起来没睡够9个小时，走了6万步，军训式旅游了属于是，但是逛到玩到的地方都是很快乐的。</p>
<p>好好休息，好好学习，好好想小璃。</p>
]]></content>
      <categories>
        <category>日常</category>
      </categories>
      <tags>
        <tag>日常</tag>
        <tag>游记</tag>
      </tags>
  </entry>
  <entry>
    <title>和小璃三年啦</title>
    <url>/2023-07-25-3rd-universary/</url>
    <content><![CDATA[<p style="color:rgb(247, 58, 58); font-size: 40px; text-align: center">
2020.7.27 -- 2023.7.27
</p>
<span id="more"></span>
<p>初中相识, 大学相恋, 我们的故事好长, 每一段经历都值得一讲.</p>
<p>这三年是我们人生经历中波折一段, 我们相互扶持, 相互搀扶到了如今.</p>
<p>想想上一个周年纪念日, 我们还在打着视频对着吃跷脚牛肉, 也挺有感觉的,
想半天没想起来一周年纪念日干啥了, 翻了翻微博发现可能是疫情封住了.</p>
<p>这一年看开启了我们的旅游生涯: 上海, 苏州, 南京, 北京, 扬州, 三亚,
海口, 以及即将来的长沙. 旅游的风格也逐渐变化, 从哪火奔哪变成了钻小巷子,
受本地人欢迎的餐馆丝毫不逊色于知名饭店; 开始喜欢逛博物馆,
带讲解器的那种, 看看这片地区的历史还是很有意思的.</p>
<p>想想在上海封控, 我们一起做饭, 一起生活, 共享着开心和失落.
在苏州见证解封并且感染, 但是最终挺过来,
并且突发奇想去了一次体验非常完美的迪士尼,
和小璃在一起的日子就算艰难也充满着热情.</p>
<p>海南之行非常美好, 几乎每一天都有着难忘的回忆. 南海观音,
蜈支洲岛的玻璃海和潜水, 再一次临时起意的琼海之旅,
以及海口大大小小的夜市, 与海平面相接的天空, 总感觉能再吃一碗的清补凉,
每家味道都不太一样的炸炸.
和小璃看两晚的演唱会给我的青春谱写了一个完美的篇章.
是我这一辈子都会提起来的回忆.</p>
<p>异地的路很长, 但是我们不会轻言放弃. 我们有过争吵, 但更多的是甜蜜,
我们注定是彼此的唯一. 马上这座城就要迎来一个可爱人儿,
来迎接我们的第四年.</p>
<p>我爱你, 三周年快乐💖.</p>
]]></content>
      <categories>
        <category>日常</category>
      </categories>
      <tags>
        <tag>日常</tag>
        <tag>纪念</tag>
      </tags>
  </entry>
  <entry>
    <title>vlookup 查询中出现重复值怎么办</title>
    <url>/2025-06-25-multi-vlookup/</url>
    <content><![CDATA[<p>在 Excel 中使用 VLOOKUP
函数时，如果查询的值在数据表中出现了多次，VLOOKUP
只会返回第一个匹配的值。我在实际使用中, 会出现如下的情况 <img
src="https://raw.githubusercontent.com/syvshc/image/master/postimg/multi-vlookup/problem.png"
alt="我想根据左侧依次填写右侧" /></p>
<span id="more"></span>
<p>如果我们简单的使用 VLOOKUP 函数 <figure class="highlight excel"><table><tr><td class="code"><pre><span class="line">=<span class="built_in">VLOOKUP</span>(<span class="symbol">A2</span>, $D$<span class="symbol">2:</span>$E$<span class="number">6</span>, <span class="number">2</span>, <span class="built_in">FALSE</span>)</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>帮助文档</category>
        <category>Excel</category>
      </categories>
      <tags>
        <tag>帮助文档</tag>
        <tag>Excel</tag>
      </tags>
  </entry>
</search>
